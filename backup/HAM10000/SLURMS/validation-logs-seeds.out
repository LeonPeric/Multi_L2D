Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "cuDNN"
   Try: "module spider cuDNN" to see how to load the module(s).



cuda:0
cuda:0
cuda:0
validate softmax surrogate loss method...
n is 1
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 4]), expert_predictions (1, 4096)
Evaluate...
{'coverage': '4096 out of4096', 'system_accuracy': 80.6396484375, 'expert_accuracy': 0.0, 'classifier_accuracy': 80.63964646875863, 'alone_classifier': 80.6396484375, 'validation_loss': 1.931075505912304, 'n_experts': 1, 'expert_0': 0.0}
n is 2
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 5]), expert_predictions (2, 4096)
Evaluate...
{'coverage': '4085 out of4096', 'system_accuracy': 80.46875, 'expert_accuracy': 9.090743804658098, 'classifier_accuracy': 80.66095273779797, 'alone_classifier': 80.5908203125, 'validation_loss': 3.2703517973423004, 'n_experts': 2, 'expert_0': 0.0, 'expert_1': 11.11086420301771}
n is 3
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 6]), expert_predictions (3, 4096)
Evaluate...
{'coverage': '4002 out of4096', 'system_accuracy': tensor(80.6885), 'expert_accuracy': tensor(41.4893), 'classifier_accuracy': 81.60919336308862, 'alone_classifier': 80.8837890625, 'validation_loss': 4.895932286977768, 'n_experts': 3, 'expert_0': 99.98000399920016, 'expert_1': 39.99920001599968, 'expert_2': tensor(40.9638)}
n is 4
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 7]), expert_predictions (4, 4096)
Evaluate...
{'coverage': '2133 out of4096', 'system_accuracy': 82.5439453125, 'expert_accuracy': 76.4136447871987, 'classifier_accuracy': 88.18564987409049, 'alone_classifier': 80.078125, 'validation_loss': 7.387442111968994, 'n_experts': 4, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 76.4136447871987}
n is 5
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 8]), expert_predictions (5, 4096)
Evaluate...
{'coverage': '3300 out of4096', 'system_accuracy': tensor(82.2754), 'expert_accuracy': tensor(74.3718), 'classifier_accuracy': 84.18181563085406, 'alone_classifier': 79.6630859375, 'validation_loss': 9.946325600147247, 'n_experts': 5, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': tensor(47.0583), 'expert_3': 76.91195471516458, 'expert_4': tensor(59.3022)}
n is 6
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 9]), expert_predictions (6, 4096)
Evaluate...
{'coverage': '2411 out of4096', 'system_accuracy': tensor(82.6172), 'expert_accuracy': tensor(74.8961), 'classifier_accuracy': 88.01326885054877, 'alone_classifier': 80.76171875, 'validation_loss': 12.688139140605927, 'n_experts': 6, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 74.96854402911396, 'expert_4': tensor(0.), 'expert_5': tensor(75.2687)}
n is 7
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 10]), expert_predictions (7, 4096)
Evaluate...
{'coverage': '2078 out of4096', 'system_accuracy': tensor(85.4980), 'expert_accuracy': tensor(81.7146), 'classifier_accuracy': 89.17227674820612, 'alone_classifier': 79.931640625, 'validation_loss': 15.916872441768646, 'n_experts': 7, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': tensor(39.9984), 'expert_6': 81.94029035419997}
n is 8
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 11]), expert_predictions (8, 4096)
Evaluate...
{'coverage': '1231 out of4096', 'system_accuracy': 90.3076171875, 'expert_accuracy': 90.2268697921906, 'classifier_accuracy': 90.49552473635055, 'alone_classifier': 80.2734375, 'validation_loss': 19.720966815948486, 'n_experts': 8, 'expert_0': 0.0, 'expert_1': 99.98000399920016, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 49.99500049995, 'expert_7': 90.25156602015612}
n is 9
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 12]), expert_predictions (9, 4096)
Evaluate...
{'coverage': '723 out of4096', 'system_accuracy': tensor(90.2588), 'expert_accuracy': tensor(90.3647), 'classifier_accuracy': 89.76485618743345, 'alone_classifier': 80.0048828125, 'validation_loss': 22.690789818763733, 'n_experts': 9, 'expert_0': 99.98000399920016, 'expert_1': 0.0, 'expert_2': tensor(0.), 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 66.66444451851605, 'expert_7': 90.43090101450811, 'expert_8': 0.0}
n is 10
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 13]), expert_predictions (10, 4096)
Evaluate...
{'coverage': '1161 out of4096', 'system_accuracy': 90.4296875, 'expert_accuracy': 90.69846059976419, 'classifier_accuracy': 89.75020760118798, 'alone_classifier': 79.8095703125, 'validation_loss': 26.481690168380737, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 99.98000399920016, 'expert_5': 0.0, 'expert_6': 49.99500049995, 'expert_7': 87.49781255468613, 'expert_8': 99.98000399920016, 'expert_9': 90.79081884349067}
n is 1
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 4]), expert_predictions (1, 4096)
Evaluate...
{'coverage': '4067 out of4096', 'system_accuracy': 80.9326171875, 'expert_accuracy': 27.58601664816105, 'classifier_accuracy': 81.31300513122682, 'alone_classifier': 81.103515625, 'validation_loss': 1.8798100724816322, 'n_experts': 1, 'expert_0': 27.58601664816105}
n is 2
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 5]), expert_predictions (2, 4096)
Evaluate...
{'coverage': '4075 out of4096', 'system_accuracy': 79.9072265625, 'expert_accuracy': 38.09487528690203, 'classifier_accuracy': 80.1226974203019, 'alone_classifier': 79.98046875, 'validation_loss': 3.2658044695854187, 'n_experts': 2, 'expert_0': 38.09487528690203, 'expert_1': 0.0}
n is 3
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 6]), expert_predictions (3, 4096)
Evaluate...
{'coverage': '4014 out of4096', 'system_accuracy': tensor(80.8350), 'expert_accuracy': tensor(51.2194), 'classifier_accuracy': 81.4399581106139, 'alone_classifier': 80.6640625, 'validation_loss': 4.928850889205933, 'n_experts': 3, 'expert_0': 0.0, 'expert_1': 99.98000399920016, 'expert_2': tensor(50.6172)}
n is 4
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 7]), expert_predictions (4, 4096)
Evaluate...
{'coverage': '2367 out of4096', 'system_accuracy': tensor(82.5928), 'expert_accuracy': tensor(75.7085), 'classifier_accuracy': 87.6214580641547, 'alone_classifier': 79.9072265625, 'validation_loss': 7.345150977373123, 'n_experts': 4, 'expert_0': 99.98000399920016, 'expert_1': 0.0, 'expert_2': tensor(0.), 'expert_3': 75.73826569331028}
n is 5
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 8]), expert_predictions (5, 4096)
Evaluate...
{'coverage': '2949 out of4096', 'system_accuracy': 84.0087890625, 'expert_accuracy': 74.97819093667115, 'classifier_accuracy': 87.52119065713154, 'alone_classifier': 80.6396484375, 'validation_loss': 9.812365472316742, 'n_experts': 5, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 74.89062556594479, 'expert_4': 99.99500024998748}
n is 6
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 9]), expert_predictions (6, 4096)
Evaluate...
{'coverage': '2631 out of4096', 'system_accuracy': tensor(83.6182), 'expert_accuracy': tensor(75.3584), 'classifier_accuracy': 88.2174044767235, 'alone_classifier': 80.1513671875, 'validation_loss': 12.622920632362366, 'n_experts': 6, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 75.71223992703135, 'expert_4': tensor(72.7260), 'expert_5': tensor(65.9997)}
n is 7
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 10]), expert_predictions (7, 4096)
Evaluate...
{'coverage': '1663 out of4096', 'system_accuracy': 84.47265625, 'expert_accuracy': 81.58651199453251, 'classifier_accuracy': 88.69512395098474, 'alone_classifier': 80.322265625, 'validation_loss': 15.844299077987671, 'n_experts': 7, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 81.62005907729778}
n is 8
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 11]), expert_predictions (8, 4096)
Evaluate...
{'coverage': '1012 out of4096', 'system_accuracy': 90.1611328125, 'expert_accuracy': 90.27236768661689, 'classifier_accuracy': 89.82212551164768, 'alone_classifier': 80.2001953125, 'validation_loss': 19.691155910491943, 'n_experts': 8, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 99.98000399920016, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.26921243793628}
n is 9
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 12]), expert_predictions (9, 4096)
Evaluate...
{'coverage': '1470 out of4096', 'system_accuracy': 90.185546875, 'expert_accuracy': 90.09900303891828, 'classifier_accuracy': 90.3401299088347, 'alone_classifier': 80.17578125, 'validation_loss': 22.53071427345276, 'n_experts': 9, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.09900303891828, 'expert_8': 0.0}
n is 10
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 13]), expert_predictions (10, 4096)
Evaluate...
{'coverage': '1203 out of4096', 'system_accuracy': 90.3076171875, 'expert_accuracy': 90.01036363564718, 'classifier_accuracy': 91.02243632398701, 'alone_classifier': 79.7607421875, 'validation_loss': 26.680071353912354, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 66.66222251849877, 'expert_4': 99.98000399920016, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 99.98000399920016, 'expert_8': 0.0, 'expert_9': 90.02769459642005}
n is 1
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 4]), expert_predictions (1, 4096)
Evaluate...
{'coverage': '4092 out of4096', 'system_accuracy': 80.56640625, 'expert_accuracy': 24.99875006249687, 'classifier_accuracy': 80.62072139245548, 'alone_classifier': 80.615234375, 'validation_loss': 1.903648667037487, 'n_experts': 1, 'expert_0': 24.99875006249687}
n is 2
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 5]), expert_predictions (2, 4096)
Evaluate...
{'coverage': '4086 out of4096', 'system_accuracy': 81.298828125, 'expert_accuracy': 19.99960000799984, 'classifier_accuracy': 81.44884773742419, 'alone_classifier': 81.3720703125, 'validation_loss': 3.210292726755142, 'n_experts': 2, 'expert_0': 0.0, 'expert_1': 19.99960000799984}
n is 3
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 6]), expert_predictions (3, 4096)
Evaluate...
{'coverage': '3657 out of4096', 'system_accuracy': tensor(79.3701), 'expert_accuracy': tensor(48.7471), 'classifier_accuracy': 83.04621047180173, 'alone_classifier': 80.7373046875, 'validation_loss': 4.95065838098526, 'n_experts': 3, 'expert_0': 0.0, 'expert_1': 49.99500049995, 'expert_2': tensor(48.7414)}
n is 4
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 7]), expert_predictions (4, 4096)
Evaluate...
{'coverage': '3072 out of4096', 'system_accuracy': 84.0087890625, 'expert_accuracy': 77.73435981750785, 'classifier_accuracy': 86.1002576139239, 'alone_classifier': 79.98046875, 'validation_loss': 7.39907243847847, 'n_experts': 4, 'expert_0': 49.99500049995, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 77.78863448363317}
n is 5
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 8]), expert_predictions (5, 4096)
Evaluate...
{'coverage': '2460 out of4096', 'system_accuracy': 83.69140625, 'expert_accuracy': 76.10023519557028, 'classifier_accuracy': 88.73983379106366, 'alone_classifier': 80.2490234375, 'validation_loss': 9.804548859596252, 'n_experts': 5, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 76.10023519557028, 'expert_4': 0.0}
n is 6
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 9]), expert_predictions (6, 4096)
Evaluate...
{'coverage': '2572 out of4096', 'system_accuracy': tensor(84.1064), 'expert_accuracy': tensor(76.4436), 'classifier_accuracy': 88.64696389397496, 'alone_classifier': 80.2734375, 'validation_loss': 12.702079951763153, 'n_experts': 6, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 76.58729145670748, 'expert_4': 0.0, 'expert_5': tensor(58.3324)}
n is 7
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 10]), expert_predictions (7, 4096)
Evaluate...
{'coverage': '2047 out of4096', 'system_accuracy': 85.25390625, 'expert_accuracy': 80.67349139350988, 'classifier_accuracy': 89.83878408213073, 'alone_classifier': 80.8837890625, 'validation_loss': 15.8569837808609, 'n_experts': 7, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 80.67349139350988}
n is 8
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 11]), expert_predictions (8, 4096)
Evaluate...
{'coverage': '1169 out of4096', 'system_accuracy': tensor(88.3545), 'expert_accuracy': tensor(89.1356), 'classifier_accuracy': 86.39862391799625, 'alone_classifier': 79.1259765625, 'validation_loss': 19.785555362701416, 'n_experts': 8, 'expert_0': 0.0, 'expert_1': 99.98000399920016, 'expert_2': 99.98000399920016, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': tensor(72.9031), 'expert_6': 85.40765201059914, 'expert_7': 90.49683828889287}
n is 9
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 12]), expert_predictions (9, 4096)
Evaluate...
{'coverage': '1175 out of4096', 'system_accuracy': 90.380859375, 'expert_accuracy': 90.58540975108458, 'classifier_accuracy': 89.87233277682274, 'alone_classifier': 80.517578125, 'validation_loss': 22.59764051437378, 'n_experts': 9, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.58540975108458, 'expert_8': 0.0}
n is 10
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 13]), expert_predictions (10, 4096)
Evaluate...
{'coverage': '506 out of4096', 'system_accuracy': 89.9169921875, 'expert_accuracy': 90.25069135093642, 'classifier_accuracy': 87.54938981237356, 'alone_classifier': 80.95703125, 'validation_loss': 26.50698947906494, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 99.9900009999, 'expert_7': 90.2602804220386, 'expert_8': 0.0, 'expert_9': 92.85581634548078}
n is 1
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 4]), expert_predictions (1, 4096)
Evaluate...
{'coverage': '4076 out of4096', 'system_accuracy': 80.6884765625, 'expert_accuracy': 34.999650003499966, 'classifier_accuracy': 80.91265748496915, 'alone_classifier': 80.7861328125, 'validation_loss': 1.8887162059545517, 'n_experts': 1, 'expert_0': 34.999650003499966}
n is 2
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 5]), expert_predictions (2, 4096)
Evaluate...
{'coverage': '4062 out of4096', 'system_accuracy': 80.4443359375, 'expert_accuracy': 35.293910035823316, 'classifier_accuracy': 80.82225305705926, 'alone_classifier': 80.615234375, 'validation_loss': 3.1867945790290833, 'n_experts': 2, 'expert_0': 0.0, 'expert_1': 35.293910035823316}
n is 3
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 6]), expert_predictions (3, 4096)
Evaluate...
{'coverage': '3950 out of4096', 'system_accuracy': tensor(81.0059), 'expert_accuracy': tensor(51.3698), 'classifier_accuracy': 82.1012637442718, 'alone_classifier': 80.859375, 'validation_loss': 4.9618682861328125, 'n_experts': 3, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': tensor(51.3698)}
n is 4
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 7]), expert_predictions (4, 4096)
Evaluate...
{'coverage': '2605 out of4096', 'system_accuracy': 83.10546875, 'expert_accuracy': 75.92218968179884, 'classifier_accuracy': 87.2168872469525, 'alone_classifier': 80.17578125, 'validation_loss': 7.363093703985214, 'n_experts': 4, 'expert_0': 99.98000399920016, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 75.90603007972751}
n is 5
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 8]), expert_predictions (5, 4096)
Evaluate...
{'coverage': '2337 out of4096', 'system_accuracy': 82.6416015625, 'expert_accuracy': 74.92892837647204, 'classifier_accuracy': 88.44672278790232, 'alone_classifier': 80.419921875, 'validation_loss': 9.848197758197784, 'n_experts': 5, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 74.92892837647204, 'expert_4': 0.0}
n is 6
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 9]), expert_predictions (6, 4096)
Evaluate...
{'coverage': '2219 out of4096', 'system_accuracy': tensor(82.1045), 'expert_accuracy': tensor(74.4805), 'classifier_accuracy': 88.55339844283918, 'alone_classifier': 80.95703125, 'validation_loss': 12.611627399921417, 'n_experts': 6, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 74.53041705027543, 'expert_4': tensor(24.9988), 'expert_5': tensor(74.7232)}
n is 7
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 10]), expert_predictions (7, 4096)
Evaluate...
{'coverage': '2157 out of4096', 'system_accuracy': tensor(85.3027), 'expert_accuracy': tensor(80.3507), 'classifier_accuracy': 89.75428420239757, 'alone_classifier': 80.2001953125, 'validation_loss': 15.897023499011993, 'n_experts': 7, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 84.6140828602637, 'expert_4': 0.0, 'expert_5': tensor(0.), 'expert_6': 80.36362801416853}
n is 8
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 11]), expert_predictions (8, 4096)
Evaluate...
{'coverage': '1193 out of4096', 'system_accuracy': 90.0634765625, 'expert_accuracy': 90.21701066365755, 'classifier_accuracy': 89.68984998408634, 'alone_classifier': 79.7119140625, 'validation_loss': 19.57333266735077, 'n_experts': 8, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 99.98000399920016, 'expert_7': 90.21363954420127}
n is 9
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 12]), expert_predictions (9, 4096)
Evaluate...
{'coverage': '1202 out of4096', 'system_accuracy': 90.6005859375, 'expert_accuracy': 90.3593579571971, 'classifier_accuracy': 91.18135680687547, 'alone_classifier': 80.2490234375, 'validation_loss': 22.54465353488922, 'n_experts': 9, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 99.9900009999, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 85.71306124198226, 'expert_7': 90.37525431721652, 'expert_8': 0.0}
n is 10
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 13]), expert_predictions (10, 4096)
Evaluate...
{'coverage': '1282 out of4096', 'system_accuracy': 90.4052734375, 'expert_accuracy': 90.12081804400725, 'classifier_accuracy': 91.02963408505194, 'alone_classifier': 79.78515625, 'validation_loss': 26.586830973625183, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.37579373274119, 'expert_8': 0.0, 'expert_9': 89.24047808845631}
n is 1
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 4]), expert_predictions (1, 4096)
Evaluate...
{'coverage': '4080 out of4096', 'system_accuracy': 80.0537109375, 'expert_accuracy': 12.499843751953101, 'classifier_accuracy': 80.31862548238662, 'alone_classifier': 80.17578125, 'validation_loss': 1.9114985838532448, 'n_experts': 1, 'expert_0': 12.499843751953101}
n is 2
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 5]), expert_predictions (2, 4096)
Evaluate...
{'coverage': '4059 out of4096', 'system_accuracy': 80.5419921875, 'expert_accuracy': 32.43225712293447, 'classifier_accuracy': 80.98053508301219, 'alone_classifier': 80.615234375, 'validation_loss': 3.2034734189510345, 'n_experts': 2, 'expert_0': 0.0, 'expert_1': 32.43225712293447}
n is 3
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 6]), expert_predictions (3, 4096)
Evaluate...
{'coverage': '4021 out of4096', 'system_accuracy': tensor(80.4932), 'expert_accuracy': tensor(43.9999), 'classifier_accuracy': 81.1738353351446, 'alone_classifier': 80.6396484375, 'validation_loss': 4.908498138189316, 'n_experts': 3, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': tensor(46.4787)}
n is 4
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 7]), expert_predictions (4, 4096)
Evaluate...
{'coverage': '2606 out of4096', 'system_accuracy': 83.69140625, 'expert_accuracy': 74.56374838070492, 'classifier_accuracy': 88.9102038023713, 'alone_classifier': 79.736328125, 'validation_loss': 7.3049284517765045, 'n_experts': 4, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 74.56374838070492}
n is 5
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 8]), expert_predictions (5, 4096)
Evaluate...
{'coverage': '2250 out of4096', 'system_accuracy': tensor(82.6172), 'expert_accuracy': tensor(75.5146), 'classifier_accuracy': 88.44444051358042, 'alone_classifier': 79.296875, 'validation_loss': 9.7778440117836, 'n_experts': 5, 'expert_0': 0.0, 'expert_1': 99.98000399920016, 'expert_2': tensor(0.), 'expert_3': 75.87353567681247, 'expert_4': tensor(60.9753)}
n is 6
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 9]), expert_predictions (6, 4096)
Evaluate...
{'coverage': '2138 out of4096', 'system_accuracy': tensor(82.0068), 'expert_accuracy': tensor(74.7702), 'classifier_accuracy': 88.63423345957747, 'alone_classifier': 79.8095703125, 'validation_loss': 12.710022807121277, 'n_experts': 6, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 74.85713507977817, 'expert_4': 0.0, 'expert_5': tensor(69.6965)}
n is 7
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 10]), expert_predictions (7, 4096)
Evaluate...
{'coverage': '1932 out of4096', 'system_accuracy': tensor(85.4736), 'expert_accuracy': tensor(82.2089), 'classifier_accuracy': 89.1304301692324, 'alone_classifier': 79.736328125, 'validation_loss': 15.868563890457153, 'n_experts': 7, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 99.98000399920016, 'expert_3': 73.33284444770368, 'expert_4': 0.0, 'expert_5': tensor(66.6662), 'expert_6': 82.54873204481864}
n is 8
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 11]), expert_predictions (8, 4096)
Evaluate...
{'coverage': '814 out of4096', 'system_accuracy': tensor(89.3799), 'expert_accuracy': tensor(89.8537), 'classifier_accuracy': 87.46927672367607, 'alone_classifier': 79.541015625, 'validation_loss': 19.63957440853119, 'n_experts': 8, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 33.33111125924938, 'expert_4': tensor(79.9968), 'expert_5': tensor(70.3699), 'expert_6': 84.8479706183599, 'expert_7': 90.22110929796891}
n is 9
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 12]), expert_predictions (9, 4096)
Evaluate...
{'coverage': '1389 out of4096', 'system_accuracy': tensor(88.7451), 'expert_accuracy': tensor(88.4374), 'classifier_accuracy': 89.34484597949273, 'alone_classifier': 79.345703125, 'validation_loss': 22.517715215682983, 'n_experts': 9, 'expert_0': 0.0, 'expert_1': 99.98000399920016, 'expert_2': 0.0, 'expert_3': 72.22182098988338, 'expert_4': 0.0, 'expert_5': tensor(77.0489), 'expert_6': 73.2557287724084, 'expert_7': 90.06567405043727, 'expert_8': 0.0}
n is 10
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 13]), expert_predictions (10, 4096)
Evaluate...
{'coverage': '840 out of4096', 'system_accuracy': 90.283203125, 'expert_accuracy': 90.35625980612654, 'classifier_accuracy': 89.99998928571556, 'alone_classifier': 80.1513671875, 'validation_loss': 26.60431408882141, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.4553058714802, 'expert_8': 0.0, 'expert_9': 89.34701763091572}
===Mean and Standard Error===
Mean [80.57617188 80.53222656 80.47851562 83.18847656 83.046875   82.890625
 85.20019531 89.65332031 90.03417969 90.26855469]
Standard Error [0.14435298 0.22250307 0.2896541  0.29180678 0.33799151 0.41721626
 0.187909   0.36165789 0.32985196 0.0921934 ]
validate ova surrogate loss method...
n is 1
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 4]), expert_predictions (1, 4096)
Evaluate...
{'coverage': '4095 out of4096', 'system_accuracy': 80.7373046875, 'expert_accuracy': 0.0, 'classifier_accuracy': 80.75701878493238, 'alone_classifier': 80.76171875, 'validation_loss': 2.4119260013103485, 'n_experts': 1, 'expert_0': 0.0}
n is 2
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
/home/rverma/.conda/envs/defer/lib/python3.8/site-packages/torch/nn/functional.py:1944: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 5]), expert_predictions (2, 4096)
Evaluate...
{'coverage': '4091 out of4096', 'system_accuracy': 80.6884765625, 'expert_accuracy': 39.99840006399744, 'classifier_accuracy': 80.73820384409181, 'alone_classifier': 80.6884765625, 'validation_loss': 3.435182824730873, 'n_experts': 2, 'expert_0': 0.0, 'expert_1': 39.99840006399744}
n is 3
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 6]), expert_predictions (3, 4096)
Evaluate...
{'coverage': '4064 out of4096', 'system_accuracy': tensor(81.2256), 'expert_accuracy': tensor(46.8747), 'classifier_accuracy': 81.49606098680952, 'alone_classifier': 81.201171875, 'validation_loss': 4.409833490848541, 'n_experts': 3, 'expert_0': 0.0, 'expert_1': 74.99625018749062, 'expert_2': tensor(44.4441)}
n is 4
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 7]), expert_predictions (4, 4096)
Evaluate...
{'coverage': '2778 out of4096', 'system_accuracy': 83.740234375, 'expert_accuracy': 75.0379248804363, 'classifier_accuracy': 87.86896731933162, 'alone_classifier': 80.8837890625, 'validation_loss': 5.218778371810913, 'n_experts': 4, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 75.0379248804363}
n is 5
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 8]), expert_predictions (5, 4096)
Evaluate...
{'coverage': '2900 out of4096', 'system_accuracy': 84.1552734375, 'expert_accuracy': 74.74915137974058, 'classifier_accuracy': 88.03447972294897, 'alone_classifier': 81.4208984375, 'validation_loss': 6.164352238178253, 'n_experts': 5, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 74.74915137974058, 'expert_4': 0.0}
n is 6
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 9]), expert_predictions (6, 4096)
Evaluate...
{'coverage': '2861 out of4096', 'system_accuracy': tensor(84.2041), 'expert_accuracy': tensor(75.4656), 'classifier_accuracy': 87.97622901166623, 'alone_classifier': 81.4208984375, 'validation_loss': 6.945400834083557, 'n_experts': 6, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 76.3358649133393, 'expert_4': 99.98000399920016, 'expert_5': tensor(56.3634)}
n is 7
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 10]), expert_predictions (7, 4096)
Evaluate...
{'coverage': '2063 out of4096', 'system_accuracy': 84.912109375, 'expert_accuracy': 81.11164966929172, 'classifier_accuracy': 88.65729090366985, 'alone_classifier': 80.8349609375, 'validation_loss': 7.676593363285065, 'n_experts': 7, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 99.99333377774815, 'expert_6': 81.12369826281929}
n is 8
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 11]), expert_predictions (8, 4096)
Evaluate...
{'coverage': '658 out of4096', 'system_accuracy': 90.380859375, 'expert_accuracy': 90.51773760804319, 'classifier_accuracy': 89.66563986844379, 'alone_classifier': 81.005859375, 'validation_loss': 8.116270780563354, 'n_experts': 8, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.51773760804319}
n is 9
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 12]), expert_predictions (9, 4096)
Evaluate...
{'coverage': '827 out of4096', 'system_accuracy': 90.6005859375, 'expert_accuracy': 90.24165859641123, 'classifier_accuracy': 92.01933591060026, 'alone_classifier': 80.9326171875, 'validation_loss': 9.101049184799194, 'n_experts': 9, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.24165859641123, 'expert_8': 0.0}
n is 10
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 13]), expert_predictions (10, 4096)
Evaluate...
{'coverage': '754 out of4096', 'system_accuracy': 90.4052734375, 'expert_accuracy': 90.21543445748448, 'classifier_accuracy': 91.24667224845196, 'alone_classifier': 80.95703125, 'validation_loss': 9.527695715427399, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.67981461844138, 'expert_8': 0.0, 'expert_9': 89.65743219269669}
n is 1
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 4]), expert_predictions (1, 4096)
Evaluate...
{'coverage': '4096 out of4096', 'system_accuracy': 81.982421875, 'expert_accuracy': 0.0, 'classifier_accuracy': 81.98241987347608, 'alone_classifier': 81.982421875, 'validation_loss': 2.3508428782224655, 'n_experts': 1, 'expert_0': 0.0}
n is 2
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 5]), expert_predictions (2, 4096)
Evaluate...
{'coverage': '4095 out of4096', 'system_accuracy': 81.396484375, 'expert_accuracy': 0.0, 'classifier_accuracy': 81.41635942817193, 'alone_classifier': 81.4208984375, 'validation_loss': 3.3310431241989136, 'n_experts': 2, 'expert_0': 0.0, 'expert_1': 0.0}
n is 3
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 6]), expert_predictions (3, 4096)
Evaluate...
{'coverage': '4042 out of4096', 'system_accuracy': tensor(81.1035), 'expert_accuracy': tensor(51.8517), 'classifier_accuracy': 81.49430773146196, 'alone_classifier': 81.005859375, 'validation_loss': 4.335842967033386, 'n_experts': 3, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': tensor(51.8517)}
n is 4
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 7]), expert_predictions (4, 4096)
Evaluate...
{'coverage': '2871 out of4096', 'system_accuracy': 84.47265625, 'expert_accuracy': 75.42855911370464, 'classifier_accuracy': 88.33158870318395, 'alone_classifier': 81.005859375, 'validation_loss': 5.108540117740631, 'n_experts': 4, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 75.42855911370464}
n is 5
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 8]), expert_predictions (5, 4096)
Evaluate...
{'coverage': '3110 out of4096', 'system_accuracy': 84.2529296875, 'expert_accuracy': 74.54359542726259, 'classifier_accuracy': 87.33118690253417, 'alone_classifier': 80.9814453125, 'validation_loss': 6.085702151060104, 'n_experts': 5, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 74.54359542726259, 'expert_4': 0.0}
n is 6
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 9]), expert_predictions (6, 4096)
Evaluate...
{'coverage': '3012 out of4096', 'system_accuracy': 84.4482421875, 'expert_accuracy': 74.53873163492037, 'classifier_accuracy': 88.01460531160008, 'alone_classifier': 80.859375, 'validation_loss': 6.869228482246399, 'n_experts': 6, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 74.53873163492037, 'expert_4': 0.0, 'expert_5': 0.0}
n is 7
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 10]), expert_predictions (7, 4096)
Evaluate...
{'coverage': '2469 out of4096', 'system_accuracy': 86.083984375, 'expert_accuracy': 81.31529424520046, 'classifier_accuracy': 89.22640383854176, 'alone_classifier': 81.1279296875, 'validation_loss': 7.57859542965889, 'n_experts': 7, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 81.31529424520046}
n is 8
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 11]), expert_predictions (8, 4096)
Evaluate...
{'coverage': '754 out of4096', 'system_accuracy': 89.9169921875, 'expert_accuracy': 90.00597905410059, 'classifier_accuracy': 89.52253454608295, 'alone_classifier': 81.0302734375, 'validation_loss': 8.073144972324371, 'n_experts': 8, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.00597905410059}
n is 9
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 12]), expert_predictions (9, 4096)
Evaluate...
{'coverage': '530 out of4096', 'system_accuracy': 90.6494140625, 'expert_accuracy': 90.52158774416222, 'classifier_accuracy': 91.50941669633647, 'alone_classifier': 81.2255859375, 'validation_loss': 8.993074178695679, 'n_experts': 9, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 99.98000399920016, 'expert_7': 90.51892900314564, 'expert_8': 0.0}
n is 10
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 13]), expert_predictions (10, 4096)
Evaluate...
{'coverage': '715 out of4096', 'system_accuracy': 90.576171875, 'expert_accuracy': 90.44660807769252, 'classifier_accuracy': 91.1887984351331, 'alone_classifier': 80.8837890625, 'validation_loss': 9.457019925117493, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.22463992414816, 'expert_8': 0.0, 'expert_9': 90.65742898991591}
n is 1
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 4]), expert_predictions (1, 4096)
Evaluate...
{'coverage': '4096 out of4096', 'system_accuracy': 81.15234375, 'expert_accuracy': 0.0, 'classifier_accuracy': 81.15234176874165, 'alone_classifier': 81.15234375, 'validation_loss': 2.3628329187631607, 'n_experts': 1, 'expert_0': 0.0}
n is 2
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 5]), expert_predictions (2, 4096)
Evaluate...
{'coverage': '4095 out of4096', 'system_accuracy': 81.2255859375, 'expert_accuracy': 99.98000399920016, 'classifier_accuracy': 81.22099923758243, 'alone_classifier': 81.201171875, 'validation_loss': 3.327520653605461, 'n_experts': 2, 'expert_0': 0.0, 'expert_1': 99.98000399920016}
n is 3
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 6]), expert_predictions (3, 4096)
Evaluate...
{'coverage': '4056 out of4096', 'system_accuracy': tensor(80.9814), 'expert_accuracy': tensor(52.4997), 'classifier_accuracy': 81.26232541266455, 'alone_classifier': 81.0302734375, 'validation_loss': 4.340789794921875, 'n_experts': 3, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': tensor(52.4997)}
n is 4
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 7]), expert_predictions (4, 4096)
Evaluate...
{'coverage': '3029 out of4096', 'system_accuracy': 85.009765625, 'expert_accuracy': 77.60073522010586, 'classifier_accuracy': 87.61967356818509, 'alone_classifier': 81.396484375, 'validation_loss': 5.111624479293823, 'n_experts': 4, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 77.60073522010586}
n is 5
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 8]), expert_predictions (5, 4096)
Evaluate...
{'coverage': '3065 out of4096', 'system_accuracy': 84.3994140625, 'expert_accuracy': 75.3637099197459, 'classifier_accuracy': 87.43882259579698, 'alone_classifier': 80.7373046875, 'validation_loss': 6.082390457391739, 'n_experts': 5, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 75.3637099197459, 'expert_4': 0.0}
n is 6
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 9]), expert_predictions (6, 4096)
Evaluate...
{'coverage': '2937 out of4096', 'system_accuracy': tensor(83.7891), 'expert_accuracy': tensor(74.8921), 'classifier_accuracy': 87.29996297923176, 'alone_classifier': 80.7373046875, 'validation_loss': 6.906056731939316, 'n_experts': 6, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 75.18180451239918, 'expert_4': 0.0, 'expert_5': tensor(69.4913)}
n is 7
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 10]), expert_predictions (7, 4096)
Evaluate...
{'coverage': '2502 out of4096', 'system_accuracy': 85.8154296875, 'expert_accuracy': 79.73650191511896, 'classifier_accuracy': 89.68824581581751, 'alone_classifier': 81.0302734375, 'validation_loss': 7.587989658117294, 'n_experts': 7, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 79.73650191511896}
n is 8
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 11]), expert_predictions (8, 4096)
Evaluate...
{'coverage': '698 out of4096', 'system_accuracy': 90.2587890625, 'expert_accuracy': 90.2001124072918, 'classifier_accuracy': 90.54439963547283, 'alone_classifier': 81.25, 'validation_loss': 8.068375140428543, 'n_experts': 8, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.2001124072918}
n is 9
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 12]), expert_predictions (9, 4096)
Evaluate...
{'coverage': '710 out of4096', 'system_accuracy': 90.3564453125, 'expert_accuracy': 90.16538156140687, 'classifier_accuracy': 91.2675927792123, 'alone_classifier': 81.103515625, 'validation_loss': 9.024235427379608, 'n_experts': 9, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 99.98000399920016, 'expert_7': 90.16247620901174, 'expert_8': 0.0}
n is 10
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 13]), expert_predictions (10, 4096)
Evaluate...
{'coverage': '653 out of4096', 'system_accuracy': 90.380859375, 'expert_accuracy': 90.32819690222499, 'classifier_accuracy': 90.65848535092108, 'alone_classifier': 80.37109375, 'validation_loss': 9.500503599643707, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.24224895797457, 'expert_8': 0.0, 'expert_9': 90.39345013863566}
n is 1
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 4]), expert_predictions (1, 4096)
Evaluate...
{'coverage': '4096 out of4096', 'system_accuracy': 80.56640625, 'expert_accuracy': 0.0, 'classifier_accuracy': 80.56640428304677, 'alone_classifier': 80.56640625, 'validation_loss': 2.3848496973514557, 'n_experts': 1, 'expert_0': 0.0}
n is 2
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 5]), expert_predictions (2, 4096)
Evaluate...
{'coverage': '4093 out of4096', 'system_accuracy': 80.908203125, 'expert_accuracy': 33.33111125924938, 'classifier_accuracy': 80.94307156259292, 'alone_classifier': 80.9326171875, 'validation_loss': 3.314299002289772, 'n_experts': 2, 'expert_0': 0.0, 'expert_1': 33.33111125924938}
n is 3
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 6]), expert_predictions (3, 4096)
Evaluate...
{'coverage': '4045 out of4096', 'system_accuracy': tensor(80.8594), 'expert_accuracy': tensor(52.9410), 'classifier_accuracy': 81.21137005657923, 'alone_classifier': 80.908203125, 'validation_loss': 4.357665151357651, 'n_experts': 3, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': tensor(52.9410)}
n is 4
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 7]), expert_predictions (4, 4096)
Evaluate...
{'coverage': '3047 out of4096', 'system_accuracy': 84.814453125, 'expert_accuracy': 75.40513338319668, 'classifier_accuracy': 88.0538205430318, 'alone_classifier': 80.95703125, 'validation_loss': 5.111998558044434, 'n_experts': 4, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 75.40513338319668}
n is 5
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 8]), expert_predictions (5, 4096)
Evaluate...
{'coverage': '3053 out of4096', 'system_accuracy': 84.5703125, 'expert_accuracy': 75.74303437333953, 'classifier_accuracy': 87.58597813344322, 'alone_classifier': 80.9326171875, 'validation_loss': 6.061862200498581, 'n_experts': 5, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 75.74303437333953, 'expert_4': 0.0}
n is 6
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 9]), expert_predictions (6, 4096)
Evaluate...
{'coverage': '3049 out of4096', 'system_accuracy': tensor(84.1553), 'expert_accuracy': tensor(74.4030), 'classifier_accuracy': 87.5040968348935, 'alone_classifier': 80.8837890625, 'validation_loss': 6.923109203577042, 'n_experts': 6, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 74.47417314069348, 'expert_4': 0.0, 'expert_5': tensor(0.)}
n is 7
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 10]), expert_predictions (7, 4096)
Evaluate...
{'coverage': '2418 out of4096', 'system_accuracy': 85.1318359375, 'expert_accuracy': 79.85696306829999, 'classifier_accuracy': 88.7923867331519, 'alone_classifier': 80.76171875, 'validation_loss': 7.594684422016144, 'n_experts': 7, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 99.98000399920016, 'expert_6': 79.84495171795447}
n is 8
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 11]), expert_predictions (8, 4096)
Evaluate...
{'coverage': '721 out of4096', 'system_accuracy': 90.4052734375, 'expert_accuracy': 90.22221687572048, 'classifier_accuracy': 91.26212326461537, 'alone_classifier': 80.5908203125, 'validation_loss': 8.075717210769653, 'n_experts': 8, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.22221687572048}
n is 9
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 12]), expert_predictions (9, 4096)
Evaluate...
{'coverage': '690 out of4096', 'system_accuracy': 90.625, 'expert_accuracy': 90.22313034508923, 'classifier_accuracy': 92.60868223062576, 'alone_classifier': 80.859375, 'validation_loss': 9.042056381702423, 'n_experts': 9, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 99.98000399920016, 'expert_6': 0.0, 'expert_7': 90.22025901789962, 'expert_8': 0.0}
n is 10
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 13]), expert_predictions (10, 4096)
Evaluate...
{'coverage': '737 out of4096', 'system_accuracy': 90.3076171875, 'expert_accuracy': 89.96724680159292, 'classifier_accuracy': 91.85887491738468, 'alone_classifier': 80.8349609375, 'validation_loss': 9.452548325061798, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 99.98000399920016, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 89.4444334019218, 'expert_8': 0.0, 'expert_9': 90.44878130623921}
n is 1
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 4]), expert_predictions (1, 4096)
Evaluate...
{'coverage': '4095 out of4096', 'system_accuracy': 81.201171875, 'expert_accuracy': 0.0, 'classifier_accuracy': 81.22099923758243, 'alone_classifier': 81.2255859375, 'validation_loss': 2.3759774267673492, 'n_experts': 1, 'expert_0': 0.0}
n is 2
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 5]), expert_predictions (2, 4096)
Evaluate...
{'coverage': '4096 out of4096', 'system_accuracy': 81.1279296875, 'expert_accuracy': 0.0, 'classifier_accuracy': 81.1279277068377, 'alone_classifier': 81.1279296875, 'validation_loss': 3.302369087934494, 'n_experts': 2, 'expert_0': 0.0, 'expert_1': 0.0}
n is 3
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 6]), expert_predictions (3, 4096)
Evaluate...
{'coverage': '4047 out of4096', 'system_accuracy': tensor(80.7617), 'expert_accuracy': tensor(36.7345), 'classifier_accuracy': 81.29478425266161, 'alone_classifier': 80.7861328125, 'validation_loss': 4.348601132631302, 'n_experts': 3, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': tensor(36.7345)}
n is 4
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 7]), expert_predictions (4, 4096)
Evaluate...
{'coverage': '3029 out of4096', 'system_accuracy': 84.1552734375, 'expert_accuracy': 74.50795229466686, 'classifier_accuracy': 87.55364517815632, 'alone_classifier': 80.95703125, 'validation_loss': 5.134154200553894, 'n_experts': 4, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 74.50795229466686}
n is 5
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 8]), expert_predictions (5, 4096)
Evaluate...
{'coverage': '3008 out of4096', 'system_accuracy': 84.716796875, 'expert_accuracy': 74.90807446542749, 'classifier_accuracy': 88.26462472524518, 'alone_classifier': 81.25, 'validation_loss': 6.033494561910629, 'n_experts': 5, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 74.90807446542749, 'expert_4': 0.0}
n is 6
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 9]), expert_predictions (6, 4096)
Evaluate...
{'coverage': '2980 out of4096', 'system_accuracy': tensor(84.0088), 'expert_accuracy': tensor(75.6272), 'classifier_accuracy': 87.14764808229368, 'alone_classifier': 81.005859375, 'validation_loss': 6.9106263518333435, 'n_experts': 6, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 76.09327967088831, 'expert_4': 0.0, 'expert_5': tensor(70.1148)}
n is 7
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 10]), expert_predictions (7, 4096)
Evaluate...
{'coverage': '2481 out of4096', 'system_accuracy': 86.572265625, 'expert_accuracy': 82.41485047494112, 'classifier_accuracy': 89.27851312863712, 'alone_classifier': 81.34765625, 'validation_loss': 7.559133410453796, 'n_experts': 7, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 82.46591295341847}
n is 8
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 11]), expert_predictions (8, 4096)
Evaluate...
{'coverage': '711 out of4096', 'system_accuracy': 90.6982421875, 'expert_accuracy': 90.3692708792159, 'classifier_accuracy': 92.2644033383399, 'alone_classifier': 81.201171875, 'validation_loss': 8.020863056182861, 'n_experts': 8, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.3692708792159}
n is 9
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 12]), expert_predictions (9, 4096)
Evaluate...
{'coverage': '721 out of4096', 'system_accuracy': 90.6982421875, 'expert_accuracy': 90.45925389871088, 'classifier_accuracy': 91.81690820847321, 'alone_classifier': 80.8349609375, 'validation_loss': 9.002218902111053, 'n_experts': 9, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.48606458292444, 'expert_8': 0.0}
n is 10
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 13]), expert_predictions (10, 4096)
Evaluate...
{'coverage': '651 out of4096', 'system_accuracy': 90.6005859375, 'expert_accuracy': 90.62408762704861, 'classifier_accuracy': 90.47617657816028, 'alone_classifier': 80.810546875, 'validation_loss': 9.48558759689331, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.79644946354578, 'expert_8': 0.0, 'expert_9': 90.45713251918485}
===Mean and Standard Error===
Mean [81.12792969 81.06933594 80.98632812 84.43847656 84.41894531 84.12109375
 85.703125   90.33203125 90.5859375  90.45410156]
Standard Error [0.24535829 0.12367114 0.08293598 0.22766686 0.10224801 0.10907377
 0.30538079 0.12638847 0.05960232 0.05725605]
validate Hemmer MoE baseline method...
n is 1
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 2]), expert_predictions (1, 4096)
Evaluate...
{'coverage': '4096 out of4096', 'system_accuracy': 81.640625, 'expert_accuracy': 0.0, 'classifier_accuracy': 81.64062300682072, 'alone_classifier': 81.640625, 'validation_loss': 0.5351258050650358, 'n_experts': 1, 'expert_0': 0.0}
n is 2
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 3]), expert_predictions (2, 4096)
Evaluate...
{'coverage': '4096 out of4096', 'system_accuracy': 81.298828125, 'expert_accuracy': 0.0, 'classifier_accuracy': 81.29882614016537, 'alone_classifier': 81.298828125, 'validation_loss': 0.5403981246054173, 'n_experts': 2, 'expert_0': 0.0, 'expert_1': 0.0}
n is 3
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 4]), expert_predictions (3, 4096)
Evaluate...
{'coverage': '4096 out of4096', 'system_accuracy': 81.005859375, 'expert_accuracy': 0.0, 'classifier_accuracy': 81.00585739731793, 'alone_classifier': 81.005859375, 'validation_loss': 0.5234053265303373, 'n_experts': 3, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0}
n is 4
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 5]), expert_predictions (4, 4096)
Evaluate...
{'coverage': '4030 out of4096', 'system_accuracy': 80.5419921875, 'expert_accuracy': 72.72705234226562, 'classifier_accuracy': 80.6699731843679, 'alone_classifier': 80.46875, 'validation_loss': 0.4306317735463381, 'n_experts': 4, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 72.72705234226562}
n is 5
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 6]), expert_predictions (5, 4096)
Evaluate...
{'coverage': '3425 out of4096', 'system_accuracy': 82.7392578125, 'expert_accuracy': 73.9195010672128, 'classifier_accuracy': 84.46715081847735, 'alone_classifier': 79.8583984375, 'validation_loss': 0.43969010561704636, 'n_experts': 5, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 73.9195010672128, 'expert_4': 0.0}
n is 6
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 7]), expert_predictions (6, 4096)
Evaluate...
{'coverage': '4050 out of4096', 'system_accuracy': 80.56640625, 'expert_accuracy': 73.91272211859949, 'classifier_accuracy': 80.64197331748214, 'alone_classifier': 80.4931640625, 'validation_loss': 0.38272107206285, 'n_experts': 6, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 73.91272211859949, 'expert_4': 0.0, 'expert_5': 0.0}
n is 7
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 8]), expert_predictions (7, 4096)
Evaluate...
{'coverage': '2861 out of4096', 'system_accuracy': 86.5234375, 'expert_accuracy': 82.18622150830421, 'classifier_accuracy': 88.39566276142388, 'alone_classifier': 80.4443359375, 'validation_loss': 0.36207132786512375, 'n_experts': 7, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 82.18622150830421}
n is 8
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 9]), expert_predictions (8, 4096)
Evaluate...
{'coverage': '3 out of4096', 'system_accuracy': 90.283203125, 'expert_accuracy': 90.2760767028548, 'classifier_accuracy': 99.99666677777407, 'alone_classifier': 79.98046875, 'validation_loss': 0.28585248719900846, 'n_experts': 8, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.2760767028548}
n is 9
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 10]), expert_predictions (9, 4096)
Evaluate...
{'coverage': '0 out of4096', 'system_accuracy': 90.283203125, 'expert_accuracy': 90.28319871664068, 'classifier_accuracy': 0.0, 'alone_classifier': 79.931640625, 'validation_loss': 0.2882400657981634, 'n_experts': 9, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.28319871664068, 'expert_8': 0.0}
n is 10
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 11]), expert_predictions (10, 4096)
Evaluate...
{'coverage': '1183 out of4096', 'system_accuracy': 90.283203125, 'expert_accuracy': 90.11327908594033, 'classifier_accuracy': 90.70159841913792, 'alone_classifier': 80.029296875, 'validation_loss': 0.2874564351513982, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 87.80466389106367, 'expert_8': 0.0, 'expert_9': 90.18014198656715}
n is 1
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 2]), expert_predictions (1, 4096)
Evaluate...
{'coverage': '4096 out of4096', 'system_accuracy': 81.0791015625, 'expert_accuracy': 0.0, 'classifier_accuracy': 81.07909958302979, 'alone_classifier': 81.0791015625, 'validation_loss': 0.5336485300213099, 'n_experts': 1, 'expert_0': 0.0}
n is 2
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 3]), expert_predictions (2, 4096)
Evaluate...
{'coverage': '4096 out of4096', 'system_accuracy': 81.591796875, 'expert_accuracy': 0.0, 'classifier_accuracy': 81.59179488301281, 'alone_classifier': 81.591796875, 'validation_loss': 0.533906003460288, 'n_experts': 2, 'expert_0': 0.0, 'expert_1': 0.0}
n is 3
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 4]), expert_predictions (3, 4096)
Evaluate...
{'coverage': '4095 out of4096', 'system_accuracy': 81.689453125, 'expert_accuracy': 99.98000399920016, 'classifier_accuracy': 81.68497969023248, 'alone_classifier': 81.689453125, 'validation_loss': 0.5170898698270321, 'n_experts': 3, 'expert_0': 0.0, 'expert_1': 99.98000399920016, 'expert_2': 0.0}
n is 4
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 5]), expert_predictions (4, 4096)
Evaluate...
{'coverage': '3869 out of4096', 'system_accuracy': 81.0791015625, 'expert_accuracy': 74.00874536674417, 'classifier_accuracy': 81.49392397275977, 'alone_classifier': 80.46875, 'validation_loss': 0.41954802349209785, 'n_experts': 4, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 74.00874536674417}
n is 5
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 6]), expert_predictions (5, 4096)
Evaluate...
{'coverage': '3865 out of4096', 'system_accuracy': 80.9814453125, 'expert_accuracy': 74.89171005046748, 'classifier_accuracy': 81.34540539856648, 'alone_classifier': 80.0537109375, 'validation_loss': 0.41258051060140133, 'n_experts': 5, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 74.89171005046748, 'expert_4': 0.0}
n is 6
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 7]), expert_predictions (6, 4096)
Evaluate...
{'coverage': '4001 out of4096', 'system_accuracy': 80.322265625, 'expert_accuracy': 71.57879667621752, 'classifier_accuracy': 80.52986552037326, 'alone_classifier': 80.3466796875, 'validation_loss': 0.3965703584253788, 'n_experts': 6, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 71.57879667621752, 'expert_4': 0.0, 'expert_5': 0.0}
n is 7
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 8]), expert_predictions (7, 4096)
Evaluate...
{'coverage': '3081 out of4096', 'system_accuracy': 85.9619140625, 'expert_accuracy': 80.39407282875413, 'classifier_accuracy': 87.79616722505136, 'alone_classifier': 80.3466796875, 'validation_loss': 0.35758752934634686, 'n_experts': 7, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 80.39407282875413}
n is 8
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 9]), expert_predictions (8, 4096)
Evaluate...
{'coverage': '2 out of4096', 'system_accuracy': 90.283203125, 'expert_accuracy': 90.27845186719824, 'classifier_accuracy': 99.99500024998748, 'alone_classifier': 79.8828125, 'validation_loss': 0.2857805658131838, 'n_experts': 8, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.27845186719824}
n is 9
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 10]), expert_predictions (9, 4096)
Evaluate...
{'coverage': '0 out of4096', 'system_accuracy': 90.283203125, 'expert_accuracy': 90.28319871664068, 'classifier_accuracy': 0.0, 'alone_classifier': 79.8583984375, 'validation_loss': 0.28744826931506395, 'n_experts': 9, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.28319871664068, 'expert_8': 0.0}
n is 10
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 11]), expert_predictions (10, 4096)
Evaluate...
{'coverage': '1892 out of4096', 'system_accuracy': 90.13671875, 'expert_accuracy': 89.97276860501192, 'classifier_accuracy': 90.32769078606286, 'alone_classifier': 79.8828125, 'validation_loss': 0.2866268614307046, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 89.97276860501192, 'expert_8': 0.0, 'expert_9': 0.0}
n is 1
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 2]), expert_predictions (1, 4096)
Evaluate...
{'coverage': '4096 out of4096', 'system_accuracy': 81.298828125, 'expert_accuracy': 0.0, 'classifier_accuracy': 81.29882614016537, 'alone_classifier': 81.298828125, 'validation_loss': 0.5346929598599672, 'n_experts': 1, 'expert_0': 0.0}
n is 2
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 3]), expert_predictions (2, 4096)
Evaluate...
{'coverage': '4096 out of4096', 'system_accuracy': 81.34765625, 'expert_accuracy': 0.0, 'classifier_accuracy': 81.34765426397328, 'alone_classifier': 81.34765625, 'validation_loss': 0.5321943834424019, 'n_experts': 2, 'expert_0': 0.0, 'expert_1': 0.0}
n is 3
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 4]), expert_predictions (3, 4096)
Evaluate...
{'coverage': '4096 out of4096', 'system_accuracy': 80.7373046875, 'expert_accuracy': 0.0, 'classifier_accuracy': 80.73730271637444, 'alone_classifier': 80.7373046875, 'validation_loss': 0.5260422844439745, 'n_experts': 3, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0}
n is 4
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 5]), expert_predictions (4, 4096)
Evaluate...
{'coverage': '4048 out of4096', 'system_accuracy': 79.931640625, 'expert_accuracy': 70.83303819567419, 'classifier_accuracy': 80.03952371443864, 'alone_classifier': 80.0048828125, 'validation_loss': 0.4349898286163807, 'n_experts': 4, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 70.83303819567419}
n is 5
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 6]), expert_predictions (5, 4096)
Evaluate...
{'coverage': '3635 out of4096', 'system_accuracy': 82.51953125, 'expert_accuracy': 75.05419737345017, 'classifier_accuracy': 83.46629756626416, 'alone_classifier': 80.6640625, 'validation_loss': 0.40063269063830376, 'n_experts': 5, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 75.05419737345017, 'expert_4': 0.0}
n is 6
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 7]), expert_predictions (6, 4096)
Evaluate...
{'coverage': '3851 out of4096', 'system_accuracy': 80.8349609375, 'expert_accuracy': 72.24483898380491, 'classifier_accuracy': 81.3814572479497, 'alone_classifier': 80.37109375, 'validation_loss': 0.38810549303889275, 'n_experts': 6, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 72.24483898380491, 'expert_4': 0.0, 'expert_5': 0.0}
n is 7
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 8]), expert_predictions (7, 4096)
Evaluate...
{'coverage': '3704 out of4096', 'system_accuracy': 82.32421875, 'expert_accuracy': 78.31628657332318, 'classifier_accuracy': 82.74837789556214, 'alone_classifier': 80.56640625, 'validation_loss': 0.3613700922578573, 'n_experts': 7, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 78.31628657332318}
n is 8
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 9]), expert_predictions (8, 4096)
Evaluate...
{'coverage': '1 out of4096', 'system_accuracy': 90.283203125, 'expert_accuracy': 90.28082587151033, 'classifier_accuracy': 99.9900009999, 'alone_classifier': 79.39453125, 'validation_loss': 0.2871122397482395, 'n_experts': 8, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.28082587151033}
n is 9
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 10]), expert_predictions (9, 4096)
Evaluate...
{'coverage': '0 out of4096', 'system_accuracy': 90.283203125, 'expert_accuracy': 90.28319871664068, 'classifier_accuracy': 0.0, 'alone_classifier': 79.8095703125, 'validation_loss': 0.28724272828549147, 'n_experts': 9, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.28319871664068, 'expert_8': 0.0}
n is 10
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 11]), expert_predictions (10, 4096)
Evaluate...
{'coverage': '185 out of4096', 'system_accuracy': 90.380859375, 'expert_accuracy': 90.28381026418766, 'classifier_accuracy': 92.43238246898245, 'alone_classifier': 78.857421875, 'validation_loss': 0.2898351950570941, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 90.28381026418766}
n is 1
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 2]), expert_predictions (1, 4096)
Evaluate...
{'coverage': '4096 out of4096', 'system_accuracy': 81.3720703125, 'expert_accuracy': 0.0, 'classifier_accuracy': 81.37206832587724, 'alone_classifier': 81.3720703125, 'validation_loss': 0.5329878386110067, 'n_experts': 1, 'expert_0': 0.0}
n is 2
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 3]), expert_predictions (2, 4096)
Evaluate...
{'coverage': '4096 out of4096', 'system_accuracy': 81.201171875, 'expert_accuracy': 0.0, 'classifier_accuracy': 81.20116989254956, 'alone_classifier': 81.201171875, 'validation_loss': 0.5338314194232225, 'n_experts': 2, 'expert_0': 0.0, 'expert_1': 0.0}
n is 3
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 4]), expert_predictions (3, 4096)
Evaluate...
{'coverage': '4095 out of4096', 'system_accuracy': 81.494140625, 'expert_accuracy': 99.98000399920016, 'classifier_accuracy': 81.48961949964298, 'alone_classifier': 81.494140625, 'validation_loss': 0.5185722410678864, 'n_experts': 3, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 99.98000399920016}
n is 4
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 5]), expert_predictions (4, 4096)
Evaluate...
{'coverage': '3487 out of4096', 'system_accuracy': 83.0322265625, 'expert_accuracy': 73.72739779067396, 'classifier_accuracy': 84.6572961096273, 'alone_classifier': 80.2978515625, 'validation_loss': 0.42891761660575867, 'n_experts': 4, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 73.72739779067396}
n is 5
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 6]), expert_predictions (5, 4096)
Evaluate...
{'coverage': '3962 out of4096', 'system_accuracy': 80.615234375, 'expert_accuracy': 70.14914903112084, 'classifier_accuracy': 80.96920542732948, 'alone_classifier': 80.4443359375, 'validation_loss': 0.4114911872893572, 'n_experts': 5, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 70.14914903112084, 'expert_4': 0.0}
n is 6
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 7]), expert_predictions (6, 4096)
Evaluate...
{'coverage': '4026 out of4096', 'system_accuracy': tensor(79.4189), 'expert_accuracy': tensor(74.2855), 'classifier_accuracy': 79.50819474644325, 'alone_classifier': 79.39453125, 'validation_loss': 0.39473055861890316, 'n_experts': 6, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 99.98000399920016, 'expert_4': 0.0, 'expert_5': tensor(73.9128)}
n is 7
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 8]), expert_predictions (7, 4096)
Evaluate...
{'coverage': '3396 out of4096', 'system_accuracy': 84.912109375, 'expert_accuracy': 79.42854873470037, 'classifier_accuracy': 86.04240029321554, 'alone_classifier': 80.1513671875, 'validation_loss': 0.3564179800450802, 'n_experts': 7, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 79.42854873470037}
n is 8
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 9]), expert_predictions (8, 4096)
Evaluate...
{'coverage': '0 out of4096', 'system_accuracy': 90.283203125, 'expert_accuracy': 90.28319871664068, 'classifier_accuracy': 0.0, 'alone_classifier': 80.4931640625, 'validation_loss': 0.288792010396719, 'n_experts': 8, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.28319871664068}
n is 9
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 10]), expert_predictions (9, 4096)
Evaluate...
{'coverage': '0 out of4096', 'system_accuracy': 90.283203125, 'expert_accuracy': 90.28319871664068, 'classifier_accuracy': 0.0, 'alone_classifier': 79.98046875, 'validation_loss': 0.286194184795022, 'n_experts': 9, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.28319871664068, 'expert_8': 0.0}
n is 10
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 11]), expert_predictions (10, 4096)
Evaluate...
{'coverage': '1615 out of4096', 'system_accuracy': 90.1123046875, 'expert_accuracy': 89.96371705250165, 'classifier_accuracy': 90.3405516816996, 'alone_classifier': 79.638671875, 'validation_loss': 0.28622915875166655, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 99.99894737950127, 'expert_8': 0.0, 'expert_9': 89.88626402223689}
n is 1
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 2]), expert_predictions (1, 4096)
Evaluate...
{'coverage': '4096 out of4096', 'system_accuracy': 81.2255859375, 'expert_accuracy': 0.0, 'classifier_accuracy': 81.22558395445351, 'alone_classifier': 81.2255859375, 'validation_loss': 0.5346038155257702, 'n_experts': 1, 'expert_0': 0.0}
n is 2
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 3]), expert_predictions (2, 4096)
Evaluate...
{'coverage': '4096 out of4096', 'system_accuracy': 81.1279296875, 'expert_accuracy': 0.0, 'classifier_accuracy': 81.1279277068377, 'alone_classifier': 81.1279296875, 'validation_loss': 0.5384574737399817, 'n_experts': 2, 'expert_0': 0.0, 'expert_1': 0.0}
n is 3
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 4]), expert_predictions (3, 4096)
Evaluate...
{'coverage': '4096 out of4096', 'system_accuracy': 81.7138671875, 'expert_accuracy': 0.0, 'classifier_accuracy': 81.71386519253258, 'alone_classifier': 81.7138671875, 'validation_loss': 0.5207772254943848, 'n_experts': 3, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0}
n is 4
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 5]), expert_predictions (4, 4096)
Evaluate...
{'coverage': '3710 out of4096', 'system_accuracy': 81.4697265625, 'expert_accuracy': 69.43001583937003, 'classifier_accuracy': 82.7223697379415, 'alone_classifier': 80.6640625, 'validation_loss': 0.4211380649358034, 'n_experts': 4, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 69.43001583937003}
n is 5
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 6]), expert_predictions (5, 4096)
Evaluate...
{'coverage': '3474 out of4096', 'system_accuracy': 83.2763671875, 'expert_accuracy': 74.27650344806963, 'classifier_accuracy': 84.88773503489536, 'alone_classifier': 80.7861328125, 'validation_loss': 0.41389175690710545, 'n_experts': 5, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 74.27650344806963, 'expert_4': 0.0}
n is 6
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 7]), expert_predictions (6, 4096)
Evaluate...
{'coverage': '3884 out of4096', 'system_accuracy': 80.615234375, 'expert_accuracy': 79.24520825923749, 'classifier_accuracy': 80.69000822116354, 'alone_classifier': 79.7119140625, 'validation_loss': 0.3883870095014572, 'n_experts': 6, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 79.14684441057402, 'expert_4': 0.0, 'expert_5': 99.98000399920016}
n is 7
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 8]), expert_predictions (7, 4096)
Evaluate...
{'coverage': '2824 out of4096', 'system_accuracy': 86.376953125, 'expert_accuracy': 81.83960977364626, 'classifier_accuracy': 88.42067675564175, 'alone_classifier': 79.248046875, 'validation_loss': 0.3613001350313425, 'n_experts': 7, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 81.83960977364626}
n is 8
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 9]), expert_predictions (8, 4096)
Evaluate...
{'coverage': '0 out of4096', 'system_accuracy': 90.283203125, 'expert_accuracy': 90.28319871664068, 'classifier_accuracy': 0.0, 'alone_classifier': 79.7119140625, 'validation_loss': 0.2875388078391552, 'n_experts': 8, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.28319871664068}
n is 9
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 10]), expert_predictions (9, 4096)
Evaluate...
{'coverage': '0 out of4096', 'system_accuracy': 90.283203125, 'expert_accuracy': 90.28319871664068, 'classifier_accuracy': 0.0, 'alone_classifier': 79.931640625, 'validation_loss': 0.2886446062475443, 'n_experts': 9, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.28319871664068, 'expert_8': 0.0}
n is 10
dict_keys(['X', 'Y', 'c', 'hpred', 'hloss', 'hprob'])
<class 'collections.OrderedDict'> <class 'collections.OrderedDict'>
shapes: true labels torch.Size([4096]), confidences torch.Size([4096, 11]), expert_predictions (10, 4096)
Evaluate...
{'coverage': '1547 out of4096', 'system_accuracy': 90.234375, 'expert_accuracy': 90.19222517126519, 'classifier_accuracy': 90.30380799587537, 'alone_classifier': 80.2490234375, 'validation_loss': 0.2860954934731126, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 90.19222517126519, 'expert_8': 0.0, 'expert_9': 0.0}
===Mean and Standard Error===
Mean [81.32324219 81.31347656 81.328125   81.2109375  82.02636719 80.3515625
 85.21972656 90.28320312 90.28320312 90.22949219]
Standard Error [0.09296598 0.07933631 0.19491537 0.52371436 0.5194748  0.24698055
 0.776797   0.         0.         0.04907166]
