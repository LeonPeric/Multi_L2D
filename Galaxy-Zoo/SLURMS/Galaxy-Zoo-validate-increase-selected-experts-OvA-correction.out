Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "cuDNN"
   Try: "module spider cuDNN" to see how to load the module(s).



cuda:0
run for seed 948
n is 1
selected experts ['HumanExpert']
shapes: true labels torch.Size([1792]), confidences torch.Size([1792, 3]), expert_predictions (1, 1792)
Evaluate...
{'coverage': '1503 out of1792', 'system_accuracy': 85.82589285714286, 'expert_accuracy': 70.58818644416164, 'classifier_accuracy': 88.75581578470953, 'alone_classifier': 83.70535714285714, 'validation_loss': 1.9029045786176408, 'n_experts': 1, 'expert_0': 70.58818644416164}
n is 2
selected experts ['predict_random', 'predict_prob']
/home/rverma/.conda/envs/defer/lib/python3.8/site-packages/torch/nn/functional.py:1944: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
shapes: true labels torch.Size([1792]), confidences torch.Size([1792, 4]), expert_predictions (2, 1792)
Evaluate...
{'coverage': '1261 out of1792', 'system_accuracy': 88.50446428571429, 'expert_accuracy': 83.23914002292278, 'classifier_accuracy': 90.7216422901156, 'alone_classifier': 81.30580357142857, 'validation_loss': 2.857255356652396, 'n_experts': 2, 'expert_0': 0.0, 'expert_1': 83.23914002292278}
n is 4
selected experts ['predict_prob', 'predict_random', 'HumanExpert', 'predict_prob']
shapes: true labels torch.Size([1792]), confidences torch.Size([1792, 6]), expert_predictions (4, 1792)
Evaluate...
{'coverage': '1338 out of1792', 'system_accuracy': 87.77901785714286, 'expert_accuracy': 82.1585541151744, 'classifier_accuracy': 89.68609195171211, 'alone_classifier': 83.59375, 'validation_loss': 4.369444710867746, 'n_experts': 4, 'expert_0': 82.91659756950202, 'expert_1': 0.0, 'expert_2': 88.88691362414168, 'expert_3': 80.97553075557975}
n is 6
selected experts ['predict_prob', 'FlipHuman', 'predict_random', 'FlipHuman', 'predict_prob', 'FlipHuman']
shapes: true labels torch.Size([1792]), confidences torch.Size([1792, 8]), expert_predictions (6, 1792)
Evaluate...
{'coverage': '1269 out of1792', 'system_accuracy': 88.33705357142857, 'expert_accuracy': 80.30589663254432, 'classifier_accuracy': 91.64695889306864, 'alone_classifier': 82.53348214285714, 'validation_loss': 6.488639559064593, 'n_experts': 6, 'expert_0': 80.27885247854483, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 80.95160998466682, 'expert_5': 0.0}
n is 8
selected experts ['HumanExpert', 'predict_prob', 'HumanExpert', 'FlipHuman', 'predict_random', 'predict_random', 'predict_prob', 'FlipHuman']
shapes: true labels torch.Size([1792]), confidences torch.Size([1792, 10]), expert_predictions (8, 1792)
Evaluate...
{'coverage': '1252 out of1792', 'system_accuracy': 89.0625, 'expert_accuracy': 81.29626618656809, 'classifier_accuracy': 92.41213319391908, 'alone_classifier': 83.984375, 'validation_loss': 7.890472548348563, 'n_experts': 8, 'expert_0': 99.9900009999, 'expert_1': 81.42833877617491, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 81.19654649720235, 'expert_7': 0.0}
n is 12
selected experts ['predict_prob', 'predict_random', 'predict_prob', 'predict_prob', 'predict_prob', 'predict_random', 'predict_prob', 'predict_prob', 'predict_prob', 'predict_random', 'HumanExpert', 'HumanExpert']
shapes: true labels torch.Size([1792]), confidences torch.Size([1792, 14]), expert_predictions (12, 1792)
Evaluate...
{'coverage': '1279 out of1792', 'system_accuracy': 87.66741071428571, 'expert_accuracy': 82.06624480848157, 'classifier_accuracy': 89.9139882788125, 'alone_classifier': 81.640625, 'validation_loss': 10.683065141950335, 'n_experts': 12, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 99.99833336111065, 'expert_5': 0.0, 'expert_6': 81.56309356188635, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 0.0, 'expert_10': 99.98000399920016, 'expert_11': 99.98000399920016}
n is 16
selected experts ['predict_prob', 'FlipHuman', 'HumanExpert', 'FlipHuman', 'FlipHuman', 'FlipHuman', 'predict_random', 'predict_random', 'HumanExpert', 'FlipHuman', 'HumanExpert', 'predict_prob', 'HumanExpert', 'predict_random', 'FlipHuman', 'predict_prob']
shapes: true labels torch.Size([1792]), confidences torch.Size([1792, 18]), expert_predictions (16, 1792)
Evaluate...
{'coverage': '1243 out of1792', 'system_accuracy': 88.50446428571429, 'expert_accuracy': 80.32783958912948, 'classifier_accuracy': 92.1158413422493, 'alone_classifier': 84.765625, 'validation_loss': 14.98738888331822, 'n_experts': 16, 'expert_0': 73.0763609510696, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 0.0, 'expert_10': 0.0, 'expert_11': 80.82188617538702, 'expert_12': 0.0, 'expert_13': 0.0, 'expert_14': 0.0, 'expert_15': 74.99875002083299}
run for seed 625
n is 1
selected experts ['predict_prob']
shapes: true labels torch.Size([1792]), confidences torch.Size([1792, 3]), expert_predictions (1, 1792)
Evaluate...
{'coverage': '1190 out of1792', 'system_accuracy': 89.00669642857143, 'expert_accuracy': 82.22588630369226, 'classifier_accuracy': 92.43696702210362, 'alone_classifier': 83.76116071428571, 'validation_loss': 1.7827757256371635, 'n_experts': 1, 'expert_0': 82.22588630369226}
n is 2
selected experts ['FlipHuman', 'predict_random']
shapes: true labels torch.Size([1792]), confidences torch.Size([1792, 4]), expert_predictions (2, 1792)
Evaluate...
{'coverage': '1659 out of1792', 'system_accuracy': tensor(82.9799), 'expert_accuracy': tensor(54.8871), 'classifier_accuracy': 85.23206237299202, 'alone_classifier': 83.09151785714286, 'validation_loss': 3.104719264166696, 'n_experts': 2, 'expert_0': tensor(54.8871), 'expert_1': 0.0}
n is 4
selected experts ['predict_random', 'FlipHuman', 'predict_prob', 'HumanExpert']
shapes: true labels torch.Size([1792]), confidences torch.Size([1792, 6]), expert_predictions (4, 1792)
Evaluate...
{'coverage': '1156 out of1792', 'system_accuracy': 88.83928571428571, 'expert_accuracy': 81.91821323326629, 'classifier_accuracy': 92.64705080907865, 'alone_classifier': 83.92857142857143, 'validation_loss': 4.51836279460362, 'n_experts': 4, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 81.91821323326629, 'expert_3': 0.0}
n is 6
selected experts ['predict_random', 'predict_random', 'predict_random', 'FlipHuman', 'predict_prob', 'FlipHuman']
shapes: true labels torch.Size([1792]), confidences torch.Size([1792, 8]), expert_predictions (6, 1792)
Evaluate...
{'coverage': '1057 out of1792', 'system_accuracy': 88.00223214285714, 'expert_accuracy': 79.86392384655134, 'classifier_accuracy': 93.66129672078556, 'alone_classifier': 83.76116071428571, 'validation_loss': 6.776242324284145, 'n_experts': 6, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 79.86392384655134, 'expert_5': 0.0}
n is 8
selected experts ['predict_random', 'HumanExpert', 'predict_prob', 'predict_random', 'HumanExpert', 'predict_random', 'predict_prob', 'predict_prob']
shapes: true labels torch.Size([1792]), confidences torch.Size([1792, 10]), expert_predictions (8, 1792)
Evaluate...
{'coverage': '1039 out of1792', 'system_accuracy': 90.01116071428571, 'expert_accuracy': 84.72773314004432, 'classifier_accuracy': 93.84022195955515, 'alone_classifier': 83.25892857142857, 'validation_loss': 7.74859162739345, 'n_experts': 8, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 86.12897669098278, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 83.90800739861729, 'expert_7': 74.99812504687384}
n is 12
selected experts ['predict_prob', 'FlipHuman', 'FlipHuman', 'HumanExpert', 'FlipHuman', 'FlipHuman', 'predict_prob', 'HumanExpert', 'predict_prob', 'HumanExpert', 'FlipHuman', 'HumanExpert']
shapes: true labels torch.Size([1792]), confidences torch.Size([1792, 14]), expert_predictions (12, 1792)
Evaluate...
{'coverage': '1184 out of1792', 'system_accuracy': 87.890625, 'expert_accuracy': 83.55260409453814, 'classifier_accuracy': 90.11823563190578, 'alone_classifier': 82.64508928571429, 'validation_loss': 11.194877215794154, 'n_experts': 12, 'expert_0': 84.68460839224468, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 99.9985714489793, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 84.52823809189577, 'expert_7': 99.9900009999, 'expert_8': 75.75742271227735, 'expert_9': 66.66222251849877, 'expert_10': 0.0, 'expert_11': 99.99333377774815}
n is 16
selected experts ['predict_prob', 'predict_prob', 'HumanExpert', 'FlipHuman', 'HumanExpert', 'HumanExpert', 'HumanExpert', 'predict_random', 'HumanExpert', 'predict_random', 'predict_random', 'HumanExpert', 'predict_prob', 'HumanExpert', 'HumanExpert', 'predict_random']
shapes: true labels torch.Size([1792]), confidences torch.Size([1792, 18]), expert_predictions (16, 1792)
Evaluate...
{'coverage': '1077 out of1792', 'system_accuracy': 87.66741071428571, 'expert_accuracy': 78.60137661499955, 'classifier_accuracy': 93.68615657510152, 'alone_classifier': 83.31473214285714, 'validation_loss': 14.596204893929619, 'n_experts': 16, 'expert_0': 86.04611141343528, 'expert_1': 76.6322497372854, 'expert_2': 99.98000399920016, 'expert_3': 0.0, 'expert_4': 42.85591840233136, 'expert_5': 0.0, 'expert_6': 74.99812504687384, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 0.0, 'expert_10': 0.0, 'expert_11': 99.9900009999, 'expert_12': 80.22594337517323, 'expert_13': 99.98000399920016, 'expert_14': 71.42653067055227, 'expert_15': 0.0}
run for seed 436
n is 1
selected experts ['predict_prob']
shapes: true labels torch.Size([1792]), confidences torch.Size([1792, 3]), expert_predictions (1, 1792)
Evaluate...
{'coverage': '1074 out of1792', 'system_accuracy': 87.55580357142857, 'expert_accuracy': 80.0835431522164, 'classifier_accuracy': 92.55120181087507, 'alone_classifier': 82.64508928571429, 'validation_loss': 1.82624237877982, 'n_experts': 1, 'expert_0': 80.0835431522164}
n is 2
selected experts ['FlipHuman', 'predict_random']
shapes: true labels torch.Size([1792]), confidences torch.Size([1792, 4]), expert_predictions (2, 1792)
Evaluate...
{'coverage': '1723 out of1792', 'system_accuracy': tensor(83.4821), 'expert_accuracy': tensor(60.8694), 'classifier_accuracy': 84.38769098156176, 'alone_classifier': 83.09151785714286, 'validation_loss': 3.1163691793169295, 'n_experts': 2, 'expert_0': tensor(65.3844), 'expert_1': 47.058269902707025}
n is 4
selected experts ['FlipHuman', 'predict_random', 'HumanExpert', 'predict_random']
shapes: true labels torch.Size([1792]), confidences torch.Size([1792, 6]), expert_predictions (4, 1792)
Evaluate...
{'coverage': '1562 out of1792', 'system_accuracy': 85.99330357142857, 'expert_accuracy': 68.26081020799113, 'classifier_accuracy': 88.60434772059234, 'alone_classifier': 84.375, 'validation_loss': 4.767880235399518, 'n_experts': 4, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 67.8413499195155, 'expert_3': 99.99333377774815}
n is 6
selected experts ['predict_random', 'predict_random', 'predict_prob', 'FlipHuman', 'predict_prob', 'predict_prob']
shapes: true labels torch.Size([1792]), confidences torch.Size([1792, 8]), expert_predictions (6, 1792)
Evaluate...
{'coverage': '1184 out of1792', 'system_accuracy': 86.88616071428571, 'expert_accuracy': 78.1249743009953, 'classifier_accuracy': 91.38512741679668, 'alone_classifier': 81.640625, 'validation_loss': 6.280716214861188, 'n_experts': 6, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 84.21008310482577, 'expert_3': 0.0, 'expert_4': 78.72306926353505, 'expert_5': 77.6290334114595}
n is 8
selected experts ['FlipHuman', 'HumanExpert', 'HumanExpert', 'predict_random', 'FlipHuman', 'FlipHuman', 'predict_random', 'FlipHuman']
shapes: true labels torch.Size([1792]), confidences torch.Size([1792, 10]), expert_predictions (8, 1792)
Evaluate...
{'coverage': '1381 out of1792', 'system_accuracy': 84.93303571428571, 'expert_accuracy': 67.15325199355134, 'classifier_accuracy': 90.22446848483212, 'alone_classifier': 83.48214285714286, 'validation_loss': 8.525402614048549, 'n_experts': 8, 'expert_0': 0.0, 'expert_1': 68.22423530445299, 'expert_2': 65.9897807210348, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 0.0}
n is 12
selected experts ['FlipHuman', 'FlipHuman', 'predict_prob', 'predict_random', 'FlipHuman', 'predict_prob', 'FlipHuman', 'predict_random', 'predict_prob', 'HumanExpert', 'FlipHuman', 'predict_prob']
shapes: true labels torch.Size([1792]), confidences torch.Size([1792, 14]), expert_predictions (12, 1792)
Evaluate...
{'coverage': '1053 out of1792', 'system_accuracy': 89.22991071428571, 'expert_accuracy': 81.05545844236579, 'classifier_accuracy': 94.96675261474334, 'alone_classifier': 84.59821428571429, 'validation_loss': 11.462285041809082, 'n_experts': 12, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 81.6264814378068, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 78.18153388533133, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 62.499218759765505, 'expert_9': 0.0, 'expert_10': 0.0, 'expert_11': 99.99500024998748}
n is 16
selected experts ['predict_random', 'predict_random', 'predict_random', 'HumanExpert', 'HumanExpert', 'predict_prob', 'predict_prob', 'predict_random', 'predict_prob', 'HumanExpert', 'FlipHuman', 'FlipHuman', 'predict_random', 'HumanExpert', 'HumanExpert', 'FlipHuman']
shapes: true labels torch.Size([1792]), confidences torch.Size([1792, 18]), expert_predictions (16, 1792)
Evaluate...
{'coverage': '1000 out of1792', 'system_accuracy': 89.0625, 'expert_accuracy': 82.32321153454255, 'classifier_accuracy': 94.39999056000094, 'alone_classifier': 83.03571428571429, 'validation_loss': 14.983880587986537, 'n_experts': 16, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 55.554321015088554, 'expert_4': 0.0, 'expert_5': 87.14273265323907, 'expert_6': 81.69808237808213, 'expert_7': 0.0, 'expert_8': 79.99984761933786, 'expert_9': 0.0, 'expert_10': 0.0, 'expert_11': 0.0, 'expert_12': 0.0, 'expert_13': 99.99714293877317, 'expert_14': 99.98000399920016, 'expert_15': 0.0}
===Mean and Standard Error===
Mean [87.46279762 84.98883856 87.53720238 87.74181548 88.00223214 88.26264881
 88.41145833]
Standard Error [0.91939571 1.76378158 0.83041348 0.4386096  1.55884191 0.48790465
 0.40540355]
