Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "cuDNN"
   Try: "module spider cuDNN" to see how to load the module(s).



cuda:0
cuda:0
{'batch_size': 1024, 'alpha': 1.0, 'epochs': 100, 'patience': 20, 'expert_type': 'predict', 'n_classes': 10, 'k': 5, 'n_experts': 10, 'lr': 0.1, 'weight_decay': 0.0005, 'warmup_epochs': 0, 'loss_type': 'ova', 'ckp_dir': './ova_gradual_overlap/', 'experiment_name': 'gradual_overlap'}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '7798 out of9216', 'system_accuracy': 82.69314236111111, 'expert_accuracy': 22.708036289416604, 'classifier_accuracy': 93.60092211335058, 'alone_classifier': 87.6953125, 'validation_loss': 7.964164204067654, 'n_experts': 10, 'expert_0': 23.999936000170663, 'expert_1': 22.471859613798618, 'expert_2': 17.64701730113576, 'expert_3': 23.809467120316377, 'expert_4': 23.129220232353426, 'expert_5': 25.146169419684888, 'expert_6': 21.82740008761417, 'expert_7': 21.105506426626707, 'expert_8': 25.30114385266541, 'expert_9': 25.2746697260006}
{'coverage': '7798 out of9216', 'system_accuracy': 82.69314236111111, 'expert_accuracy': 22.708036289416604, 'classifier_accuracy': 93.60092211335058, 'alone_classifier': 87.6953125, 'validation_loss': 7.964164204067654, 'n_experts': 10, 'expert_0': 23.999936000170663, 'expert_1': 22.471859613798618, 'expert_2': 17.64701730113576, 'expert_3': 23.809467120316377, 'expert_4': 23.129220232353426, 'expert_5': 25.146169419684888, 'expert_6': 21.82740008761417, 'expert_7': 21.105506426626707, 'expert_8': 25.30114385266541, 'expert_9': 25.2746697260006}
/home/rverma/.conda/envs/defer/lib/python3.8/site-packages/torch/nn/functional.py:1944: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '7445 out of9216', 'system_accuracy': 82.421875, 'expert_accuracy': 30.77357077655892, 'classifier_accuracy': 94.70785635046532, 'alone_classifier': 87.6953125, 'validation_loss': 9.152768982781303, 'n_experts': 10, 'expert_0': 30.208270399436667, 'expert_1': 31.707265516641435, 'expert_2': 27.433579763575636, 'expert_3': 28.140675235502275, 'expert_4': 27.999977600017917, 'expert_5': 28.29265532423871, 'expert_6': 33.42034808336915, 'expert_7': 33.55700193691015, 'expert_8': 28.089824517248275, 'expert_9': 35.97556588345624}
{'coverage': '7445 out of9216', 'system_accuracy': 82.421875, 'expert_accuracy': 30.77357077655892, 'classifier_accuracy': 94.70785635046532, 'alone_classifier': 87.6953125, 'validation_loss': 9.152768982781303, 'n_experts': 10, 'expert_0': 30.208270399436667, 'expert_1': 31.707265516641435, 'expert_2': 27.433579763575636, 'expert_3': 28.140675235502275, 'expert_4': 27.999977600017917, 'expert_5': 28.29265532423871, 'expert_6': 33.42034808336915, 'expert_7': 33.55700193691015, 'expert_8': 28.089824517248275, 'expert_9': 35.97556588345624}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '6784 out of9216', 'system_accuracy': 83.35503472222223, 'expert_accuracy': 47.28618032186017, 'classifier_accuracy': 96.28537593918962, 'alone_classifier': 87.34809027777777, 'validation_loss': 10.402662383185493, 'n_experts': 10, 'expert_0': 45.37807499483194, 'expert_1': 43.92519259327795, 'expert_2': 53.15310526747273, 'expert_3': 51.09481591997676, 'expert_4': 47.38289400391515, 'expert_5': 45.337591422770785, 'expert_6': 47.179462984890776, 'expert_7': 46.73536306847899, 'expert_8': 46.51155579603752, 'expert_9': 47.26558807375932}
{'coverage': '6784 out of9216', 'system_accuracy': 83.35503472222223, 'expert_accuracy': 47.28618032186017, 'classifier_accuracy': 96.28537593918962, 'alone_classifier': 87.34809027777777, 'validation_loss': 10.402662383185493, 'n_experts': 10, 'expert_0': 45.37807499483194, 'expert_1': 43.92519259327795, 'expert_2': 53.15310526747273, 'expert_3': 51.09481591997676, 'expert_4': 47.38289400391515, 'expert_5': 45.337591422770785, 'expert_6': 47.179462984890776, 'expert_7': 46.73536306847899, 'expert_8': 46.51155579603752, 'expert_9': 47.26558807375932}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '5670 out of9216', 'system_accuracy': 84.98263888888889, 'expert_accuracy': 64.89001326057455, 'classifier_accuracy': 97.54849916140213, 'alone_classifier': 87.04427083333333, 'validation_loss': 9.719808684455025, 'n_experts': 10, 'expert_0': 63.35071900448271, 'expert_1': 70.74229629493773, 'expert_2': 61.37720875616242, 'expert_3': 69.87946194420728, 'expert_4': 66.9565023314486, 'expert_5': 62.10822671895913, 'expert_6': 62.499982040235054, 'expert_7': 65.63873760408035, 'expert_8': 63.35868189514214, 'expert_9': 64.70582379563457}
{'coverage': '5670 out of9216', 'system_accuracy': 84.98263888888889, 'expert_accuracy': 64.89001326057455, 'classifier_accuracy': 97.54849916140213, 'alone_classifier': 87.04427083333333, 'validation_loss': 9.719808684455025, 'n_experts': 10, 'expert_0': 63.35071900448271, 'expert_1': 70.74229629493773, 'expert_2': 61.37720875616242, 'expert_3': 69.87946194420728, 'expert_4': 66.9565023314486, 'expert_5': 62.10822671895913, 'expert_6': 62.499982040235054, 'expert_7': 65.63873760408035, 'expert_8': 63.35868189514214, 'expert_9': 64.70582379563457}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '5480 out of9216', 'system_accuracy': 92.55642361111111, 'expert_accuracy': 83.53853942513172, 'classifier_accuracy': 98.70437776086902, 'alone_classifier': 87.03342013888889, 'validation_loss': 7.290858904520671, 'n_experts': 10, 'expert_0': 85.58131573831093, 'expert_1': 86.72191973284669, 'expert_2': 82.70265799856324, 'expert_3': 84.53941806617232, 'expert_4': 81.15573811269441, 'expert_5': 84.1771796720761, 'expert_6': 82.17965178802599, 'expert_7': 84.76186439911218, 'expert_8': 84.84839914303116, 'expert_9': 82.60865784500785}
{'coverage': '5480 out of9216', 'system_accuracy': 92.55642361111111, 'expert_accuracy': 83.53853942513172, 'classifier_accuracy': 98.70437776086902, 'alone_classifier': 87.03342013888889, 'validation_loss': 7.290858904520671, 'n_experts': 10, 'expert_0': 85.58131573831093, 'expert_1': 86.72191973284669, 'expert_2': 82.70265799856324, 'expert_3': 84.53941806617232, 'expert_4': 81.15573811269441, 'expert_5': 84.1771796720761, 'expert_6': 82.17965178802599, 'expert_7': 84.76186439911218, 'expert_8': 84.84839914303116, 'expert_9': 82.60865784500785}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '3989 out of9216', 'system_accuracy': 97.45008680555556, 'expert_accuracy': 95.90586968028047, 'classifier_accuracy': 99.47354977504261, 'alone_classifier': 86.99001736111111, 'validation_loss': 3.4180146058400473, 'n_experts': 10, 'expert_0': 97.62705245623562, 'expert_1': 95.89035841624197, 'expert_2': 96.12899091226197, 'expert_3': 95.86952353498977, 'expert_4': 96.5957172778107, 'expert_5': 96.34638799827118, 'expert_6': 94.37409440953745, 'expert_7': 96.0643663454861, 'expert_8': 94.64876612122667, 'expert_9': 95.86642420781425}
{'coverage': '3989 out of9216', 'system_accuracy': 97.45008680555556, 'expert_accuracy': 95.90586968028047, 'classifier_accuracy': 99.47354977504261, 'alone_classifier': 86.99001736111111, 'validation_loss': 3.4180146058400473, 'n_experts': 10, 'expert_0': 97.62705245623562, 'expert_1': 95.89035841624197, 'expert_2': 96.12899091226197, 'expert_3': 95.86952353498977, 'expert_4': 96.5957172778107, 'expert_5': 96.34638799827118, 'expert_6': 94.37409440953745, 'expert_7': 96.0643663454861, 'expert_8': 94.64876612122667, 'expert_9': 95.86642420781425}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '492 out of9216', 'system_accuracy': 100.0, 'expert_accuracy': 99.99999770747368, 'classifier_accuracy': 99.99997967480088, 'alone_classifier': 86.67534722222223, 'validation_loss': 1.0627603862020705, 'n_experts': 10, 'expert_0': 99.99997957099498, 'expert_1': 99.9999672667865, 'expert_2': 99.99998786407915, 'expert_3': 99.99993174066093, 'expert_4': 99.99998265394925, 'expert_5': 99.99995910022122, 'expert_6': 99.99997903564382, 'expert_7': 99.99998191682063, 'expert_8': 99.99997698504558, 'expert_9': 99.99996784566952}
{'coverage': '492 out of9216', 'system_accuracy': 100.0, 'expert_accuracy': 99.99999770747368, 'classifier_accuracy': 99.99997967480088, 'alone_classifier': 86.67534722222223, 'validation_loss': 1.0627603862020705, 'n_experts': 10, 'expert_0': 99.99997957099498, 'expert_1': 99.9999672667865, 'expert_2': 99.99998786407915, 'expert_3': 99.99993174066093, 'expert_4': 99.99998265394925, 'expert_5': 99.99995910022122, 'expert_6': 99.99997903564382, 'expert_7': 99.99998191682063, 'expert_8': 99.99997698504558, 'expert_9': 99.99996784566952}
