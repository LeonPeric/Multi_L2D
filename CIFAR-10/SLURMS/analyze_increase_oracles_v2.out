Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "cuDNN"
   Try: "module spider cuDNN" to see how to load the module(s).



cuda:0
cuda:0
{'batch_size': 1024, 'alpha': 1.0, 'epochs': 100, 'patience': 20, 'expert_type': 'predict', 'n_classes': 10, 'k': 5, 'n_experts': 10, 'lr': 0.1, 'weight_decay': 0.0005, 'warmup_epochs': 0, 'loss_type': 'softmax', 'ckp_dir': './softmax_increase_oracle_v2/', 'experiment_name': 'increase_oracles_v2'}
log is of type <class 'dict'>
type of S, type of idx  <class 'list'> <class 'list'>
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '9205 out of9216', 'system_accuracy': 86.40407986111111, 'expert_accuracy': 0.0, 'classifier_accuracy': 86.50733203142497, 'alone_classifier': 86.44748263888889, 'validation_loss': 8.078335020277235, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 0.0}
{'coverage': '9205 out of9216', 'system_accuracy': 86.40407986111111, 'expert_accuracy': 0.0, 'classifier_accuracy': 86.50733203142497, 'alone_classifier': 86.44748263888889, 'validation_loss': 8.078335020277235, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 0.0}
type of S, type of idx  <class 'list'> <class 'list'>
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '5970 out of9216', 'system_accuracy': 62.78211805555556, 'expert_accuracy': 11.8915581089613, 'classifier_accuracy': 90.45225979141944, 'alone_classifier': 85.37326388888889, 'validation_loss': 9.153730498419868, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 11.8915581089613, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 0.0}
{'coverage': '5970 out of9216', 'system_accuracy': 62.78211805555556, 'expert_accuracy': 11.8915581089613, 'classifier_accuracy': 90.45225979141944, 'alone_classifier': 85.37326388888889, 'validation_loss': 9.153730498419868, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 11.8915581089613, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 0.0}
type of S, type of idx  <class 'list'> <class 'list'>
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '4896 out of9216', 'system_accuracy': 51.55164930555556, 'expert_accuracy': 10.995369861325468, 'classifier_accuracy': 87.33659952335377, 'alone_classifier': 87.109375, 'validation_loss': 10.449525197347006, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 11.045890552513844, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 10.720558621947761, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 0.0}
{'coverage': '4896 out of9216', 'system_accuracy': 51.55164930555556, 'expert_accuracy': 10.995369861325468, 'classifier_accuracy': 87.33659952335377, 'alone_classifier': 87.109375, 'validation_loss': 10.449525197347006, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 11.045890552513844, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 10.720558621947761, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 0.0}
type of S, type of idx  <class 'list'> <class 'list'>
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '5072 out of9216', 'system_accuracy': 54.25347222222222, 'expert_accuracy': 10.521235013453907, 'classifier_accuracy': 89.9842253552006, 'alone_classifier': 88.04253472222223, 'validation_loss': 11.83045079973009, 'n_experts': 10, 'expert_0': 12.637348750166208, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 14.054048989531896, 'expert_4': 9.770452632698492, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 49.99500049995, 'expert_8': 0.0, 'expert_9': 28.570612268220906}
{'coverage': '5072 out of9216', 'system_accuracy': 54.25347222222222, 'expert_accuracy': 10.521235013453907, 'classifier_accuracy': 89.9842253552006, 'alone_classifier': 88.04253472222223, 'validation_loss': 11.83045079973009, 'n_experts': 10, 'expert_0': 12.637348750166208, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 14.054048989531896, 'expert_4': 9.770452632698492, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 49.99500049995, 'expert_8': 0.0, 'expert_9': 28.570612268220906}
type of S, type of idx  <class 'list'> <class 'list'>
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '4701 out of9216', 'system_accuracy': 86.21961805555556, 'expert_accuracy': 81.15171290579345, 'classifier_accuracy': 91.08700082776004, 'alone_classifier': 87.38064236111111, 'validation_loss': 13.569357554117838, 'n_experts': 10, 'expert_0': 15.84156847369458, 'expert_1': 0.0, 'expert_2': 13.162700854588355, 'expert_3': 95.51053405362529, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 63.39274394152867, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 0.0}
{'coverage': '4701 out of9216', 'system_accuracy': 86.21961805555556, 'expert_accuracy': 81.15171290579345, 'classifier_accuracy': 91.08700082776004, 'alone_classifier': 87.38064236111111, 'validation_loss': 13.569357554117838, 'n_experts': 10, 'expert_0': 15.84156847369458, 'expert_1': 0.0, 'expert_2': 13.162700854588355, 'expert_3': 95.51053405362529, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 63.39274394152867, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 0.0}
type of S, type of idx  <class 'list'> <class 'list'>
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '5087 out of9216', 'system_accuracy': 54.24262152777778, 'expert_accuracy': 11.431338753628541, 'classifier_accuracy': 88.99154533140268, 'alone_classifier': 86.57769097222223, 'validation_loss': 15.172124014960396, 'n_experts': 10, 'expert_0': 11.231096660433408, 'expert_1': 0.0, 'expert_2': 10.801525893013292, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 16.666481483539073, 'expert_6': 13.06483043912958, 'expert_7': 0.0, 'expert_8': 16.666111129629012, 'expert_9': 0.0}
{'coverage': '5087 out of9216', 'system_accuracy': 54.24262152777778, 'expert_accuracy': 11.431338753628541, 'classifier_accuracy': 88.99154533140268, 'alone_classifier': 86.57769097222223, 'validation_loss': 15.172124014960396, 'n_experts': 10, 'expert_0': 11.231096660433408, 'expert_1': 0.0, 'expert_2': 10.801525893013292, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 16.666481483539073, 'expert_6': 13.06483043912958, 'expert_7': 0.0, 'expert_8': 16.666111129629012, 'expert_9': 0.0}
type of S, type of idx  <class 'list'> <class 'list'>
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '4592 out of9216', 'system_accuracy': 91.38454861111111, 'expert_accuracy': 92.69030740958877, 'classifier_accuracy': 90.069684449702, 'alone_classifier': 88.12934027777777, 'validation_loss': 16.918686125013565, 'n_experts': 10, 'expert_0': 60.97546103546088, 'expert_1': 0.0, 'expert_2': 94.54937428227878, 'expert_3': 80.75393620875548, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 97.89150729427271, 'expert_8': 0.0, 'expert_9': 0.0}
{'coverage': '4592 out of9216', 'system_accuracy': 91.38454861111111, 'expert_accuracy': 92.69030740958877, 'classifier_accuracy': 90.069684449702, 'alone_classifier': 88.12934027777777, 'validation_loss': 16.918686125013565, 'n_experts': 10, 'expert_0': 60.97546103546088, 'expert_1': 0.0, 'expert_2': 94.54937428227878, 'expert_3': 80.75393620875548, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 97.89150729427271, 'expert_8': 0.0, 'expert_9': 0.0}
type of S, type of idx  <class 'list'> <class 'list'>
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '4826 out of9216', 'system_accuracy': 90.18012152777777, 'expert_accuracy': 91.1161689696506, 'classifier_accuracy': 89.32863470102289, 'alone_classifier': 86.93576388888889, 'validation_loss': 18.695166693793404, 'n_experts': 10, 'expert_0': 94.13251450353926, 'expert_1': 70.3698491122288, 'expert_2': 8.33319444675922, 'expert_3': 90.36688957166093, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 91.30414933880577, 'expert_7': 0.0, 'expert_8': 50.537525725751124, 'expert_9': 90.9598688715217}
{'coverage': '4826 out of9216', 'system_accuracy': 90.18012152777777, 'expert_accuracy': 91.1161689696506, 'classifier_accuracy': 89.32863470102289, 'alone_classifier': 86.93576388888889, 'validation_loss': 18.695166693793404, 'n_experts': 10, 'expert_0': 94.13251450353926, 'expert_1': 70.3698491122288, 'expert_2': 8.33319444675922, 'expert_3': 90.36688957166093, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 91.30414933880577, 'expert_7': 0.0, 'expert_8': 50.537525725751124, 'expert_9': 90.9598688715217}
type of S, type of idx  <class 'list'> <class 'list'>
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '4753 out of9216', 'system_accuracy': 82.77994791666667, 'expert_accuracy': 74.4566401767134, 'classifier_accuracy': 90.59541151703321, 'alone_classifier': 88.78038194444444, 'validation_loss': 20.463196012708877, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 94.83746884608269, 'expert_3': 69.84115898228733, 'expert_4': 0.0, 'expert_5': 62.499804688110345, 'expert_6': 92.31948008618124, 'expert_7': 0.0, 'expert_8': 14.999850001499984, 'expert_9': 11.269033244866346}
{'coverage': '4753 out of9216', 'system_accuracy': 82.77994791666667, 'expert_accuracy': 74.4566401767134, 'classifier_accuracy': 90.59541151703321, 'alone_classifier': 88.78038194444444, 'validation_loss': 20.463196012708877, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 94.83746884608269, 'expert_3': 69.84115898228733, 'expert_4': 0.0, 'expert_5': 62.499804688110345, 'expert_6': 92.31948008618124, 'expert_7': 0.0, 'expert_8': 14.999850001499984, 'expert_9': 11.269033244866346}
type of S, type of idx  <class 'list'> <class 'list'>
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '5038 out of9216', 'system_accuracy': 90.38628472222223, 'expert_accuracy': 90.95260454989925, 'classifier_accuracy': 89.91663179998746, 'alone_classifier': 87.15277777777777, 'validation_loss': 22.502660327487522, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 87.8571219387805, 'expert_2': 85.34022477463374, 'expert_3': 86.48639298768326, 'expert_4': 69.38761349466633, 'expert_5': 99.98000399920016, 'expert_6': 98.02815796865826, 'expert_7': 93.61692168412587, 'expert_8': 97.51306347825565, 'expert_9': 6.766907117432906}
{'coverage': '5038 out of9216', 'system_accuracy': 90.38628472222223, 'expert_accuracy': 90.95260454989925, 'classifier_accuracy': 89.91663179998746, 'alone_classifier': 87.15277777777777, 'validation_loss': 22.502660327487522, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 87.8571219387805, 'expert_2': 85.34022477463374, 'expert_3': 86.48639298768326, 'expert_4': 69.38761349466633, 'expert_5': 99.98000399920016, 'expert_6': 98.02815796865826, 'expert_7': 93.61692168412587, 'expert_8': 97.51306347825565, 'expert_9': 6.766907117432906}
