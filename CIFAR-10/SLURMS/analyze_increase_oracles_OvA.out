Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "cuDNN"
   Try: "module spider cuDNN" to see how to load the module(s).



cuda:0
cuda:0
{'batch_size': 1024, 'alpha': 1.0, 'epochs': 100, 'patience': 20, 'expert_type': 'predict', 'n_classes': 10, 'k': 5, 'n_experts': 10, 'lr': 0.1, 'weight_decay': 0.0005, 'warmup_epochs': 0, 'loss_type': 'ova', 'ckp_dir': './ova_increase_oracle/', 'experiment_name': 'increase_oracles'}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '9114 out of9216', 'system_accuracy': 86.37152777777777, 'expert_accuracy': 20.588194925107988, 'classifier_accuracy': 87.10774536857862, 'alone_classifier': 86.55598958333333, 'validation_loss': 8.309441566467285, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 14.285306134110453, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 99.98000399920016, 'expert_9': 20.212722951653294}
{'coverage': '9114 out of9216', 'system_accuracy': 86.37152777777777, 'expert_accuracy': 20.588194925107988, 'classifier_accuracy': 87.10774536857862, 'alone_classifier': 86.55598958333333, 'validation_loss': 8.309441566467285, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 14.285306134110453, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 99.98000399920016, 'expert_9': 20.212722951653294}
/home/rverma/.conda/envs/defer/lib/python3.8/site-packages/torch/nn/functional.py:1944: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '9171 out of9216', 'system_accuracy': 87.109375, 'expert_accuracy': 19.999911111506172, 'classifier_accuracy': 87.43866440476869, 'alone_classifier': 87.23958333333333, 'validation_loss': 8.230623775058323, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 99.98000399920016, 'expert_5': 0.0, 'expert_6': 39.99840006399744, 'expert_7': 0.0, 'expert_8': 39.99840006399744, 'expert_9': 21.052409974631846}
{'coverage': '9171 out of9216', 'system_accuracy': 87.109375, 'expert_accuracy': 19.999911111506172, 'classifier_accuracy': 87.43866440476869, 'alone_classifier': 87.23958333333333, 'validation_loss': 8.230623775058323, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 99.98000399920016, 'expert_5': 0.0, 'expert_6': 39.99840006399744, 'expert_7': 0.0, 'expert_8': 39.99840006399744, 'expert_9': 21.052409974631846}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '9008 out of9216', 'system_accuracy': 85.57942708333333, 'expert_accuracy': 19.711519508154318, 'classifier_accuracy': 87.10035427286464, 'alone_classifier': 86.12196180555556, 'validation_loss': 8.338591469658745, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 49.99833338888703, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 18.781706820602214, 'expert_8': 24.99875006249687, 'expert_9': 0.0}
{'coverage': '9008 out of9216', 'system_accuracy': 85.57942708333333, 'expert_accuracy': 19.711519508154318, 'classifier_accuracy': 87.10035427286464, 'alone_classifier': 86.12196180555556, 'validation_loss': 8.338591469658745, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 49.99833338888703, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 18.781706820602214, 'expert_8': 24.99875006249687, 'expert_9': 0.0}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '9002 out of9216', 'system_accuracy': 86.97916666666667, 'expert_accuracy': 21.962596296638974, 'classifier_accuracy': 88.52477128943823, 'alone_classifier': 87.35894097222223, 'validation_loss': 8.487348874409994, 'n_experts': 10, 'expert_0': 55.554321015088554, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 24.99875006249687, 'expert_6': 20.338960068971673, 'expert_7': 21.73894140050956, 'expert_8': 0.0, 'expert_9': 0.0}
{'coverage': '9002 out of9216', 'system_accuracy': 86.97916666666667, 'expert_accuracy': 21.962596296638974, 'classifier_accuracy': 88.52477128943823, 'alone_classifier': 87.35894097222223, 'validation_loss': 8.487348874409994, 'n_experts': 10, 'expert_0': 55.554321015088554, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 24.99875006249687, 'expert_6': 20.338960068971673, 'expert_7': 21.73894140050956, 'expert_8': 0.0, 'expert_9': 0.0}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '9118 out of9216', 'system_accuracy': 87.63020833333333, 'expert_accuracy': 19.387715535274417, 'classifier_accuracy': 88.36367527567806, 'alone_classifier': 87.890625, 'validation_loss': 8.300043423970541, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 33.33259260905314, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 16.949095087813262, 'expert_9': 27.2724793410969}
{'coverage': '9118 out of9216', 'system_accuracy': 87.63020833333333, 'expert_accuracy': 19.387715535274417, 'classifier_accuracy': 88.36367527567806, 'alone_classifier': 87.890625, 'validation_loss': 8.300043423970541, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 33.33259260905314, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 16.949095087813262, 'expert_9': 27.2724793410969}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '9003 out of9216', 'system_accuracy': 85.76388888888889, 'expert_accuracy': 49.29572836081844, 'classifier_accuracy': 86.62667903335912, 'alone_classifier': 85.73133680555556, 'validation_loss': 8.425570805867514, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 24.99937501562461, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 56.06052112042254, 'expert_5': 38.46134122389116, 'expert_6': 57.14122453644181, 'expert_7': 42.85653062099113, 'expert_8': 0.0, 'expert_9': 30.768757403732252}
{'coverage': '9003 out of9216', 'system_accuracy': 85.76388888888889, 'expert_accuracy': 49.29572836081844, 'classifier_accuracy': 86.62667903335912, 'alone_classifier': 85.73133680555556, 'validation_loss': 8.425570805867514, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 24.99937501562461, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 56.06052112042254, 'expert_5': 38.46134122389116, 'expert_6': 57.14122453644181, 'expert_7': 42.85653062099113, 'expert_8': 0.0, 'expert_9': 30.768757403732252}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '9070 out of9216', 'system_accuracy': 85.17795138888889, 'expert_accuracy': 30.136945017883537, 'classifier_accuracy': 86.06394612939421, 'alone_classifier': 85.31901041666667, 'validation_loss': 8.268149693806967, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 99.98000399920016, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 46.2961248291673, 'expert_7': 24.99875006249687, 'expert_8': 0.0, 'expert_9': 21.24994687513281}
{'coverage': '9070 out of9216', 'system_accuracy': 85.17795138888889, 'expert_accuracy': 30.136945017883537, 'classifier_accuracy': 86.06394612939421, 'alone_classifier': 85.31901041666667, 'validation_loss': 8.268149693806967, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 99.98000399920016, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 46.2961248291673, 'expert_7': 24.99875006249687, 'expert_8': 0.0, 'expert_9': 21.24994687513281}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '9123 out of9216', 'system_accuracy': 87.94487847222223, 'expert_accuracy': 48.38699271614469, 'classifier_accuracy': 88.34813012881585, 'alone_classifier': 87.85807291666667, 'validation_loss': 8.150233586629232, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 12.499687507812306, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 55.69606152895815, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 0.0}
{'coverage': '9123 out of9216', 'system_accuracy': 87.94487847222223, 'expert_accuracy': 48.38699271614469, 'classifier_accuracy': 88.34813012881585, 'alone_classifier': 87.85807291666667, 'validation_loss': 8.150233586629232, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 12.499687507812306, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 55.69606152895815, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 0.0}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '9094 out of9216', 'system_accuracy': 86.26302083333333, 'expert_accuracy': 22.131111260473343, 'classifier_accuracy': 87.12337709343109, 'alone_classifier': 86.62109375, 'validation_loss': 8.159559885660807, 'n_experts': 10, 'expert_0': 66.66222251849877, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 24.99937501562461, 'expert_8': 0.0, 'expert_9': 21.698072267788174}
{'coverage': '9094 out of9216', 'system_accuracy': 86.26302083333333, 'expert_accuracy': 22.131111260473343, 'classifier_accuracy': 87.12337709343109, 'alone_classifier': 86.62109375, 'validation_loss': 8.159559885660807, 'n_experts': 10, 'expert_0': 66.66222251849877, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 24.99937501562461, 'expert_8': 0.0, 'expert_9': 21.698072267788174}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '9122 out of9216', 'system_accuracy': 86.328125, 'expert_accuracy': 51.063721141018846, 'classifier_accuracy': 86.69151406827983, 'alone_classifier': 86.30642361111111, 'validation_loss': 8.130232705010307, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 37.20912925986391, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 19.99920003199872, 'expert_8': 77.14241632904955, 'expert_9': 57.14122453644181}
{'coverage': '9122 out of9216', 'system_accuracy': 86.328125, 'expert_accuracy': 51.063721141018846, 'classifier_accuracy': 86.69151406827983, 'alone_classifier': 86.30642361111111, 'validation_loss': 8.130232705010307, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 37.20912925986391, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 19.99920003199872, 'expert_8': 77.14241632904955, 'expert_9': 57.14122453644181}
