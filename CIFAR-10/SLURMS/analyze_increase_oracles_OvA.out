Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "cuDNN"
   Try: "module spider cuDNN" to see how to load the module(s).



cuda:0
cuda:0
{'batch_size': 1024, 'alpha': 1.0, 'epochs': 100, 'patience': 20, 'expert_type': 'predict', 'n_classes': 10, 'k': 5, 'n_experts': 10, 'lr': 0.1, 'weight_decay': 0.0005, 'warmup_epochs': 0, 'loss_type': 'ova', 'ckp_dir': './ova_increase_oracle/', 'experiment_name': 'increase_oracles'}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '9094 out of9216', 'system_accuracy': 87.68446180555556, 'expert_accuracy': 13.114732598799018, 'classifier_accuracy': 88.6848461767666, 'alone_classifier': 88.03168402777777, 'validation_loss': 8.501094924079048, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 33.33111125924938, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 13.392833227083523}
{'coverage': '9094 out of9216', 'system_accuracy': 87.68446180555556, 'expert_accuracy': 13.114732598799018, 'classifier_accuracy': 88.6848461767666, 'alone_classifier': 88.03168402777777, 'validation_loss': 8.501094924079048, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 33.33111125924938, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 13.392833227083523}
/home/rverma/.conda/envs/defer/lib/python3.8/site-packages/torch/nn/functional.py:1944: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '8997 out of9216', 'system_accuracy': 86.34982638888889, 'expert_accuracy': 21.004547027810933, 'classifier_accuracy': 87.94042360853147, 'alone_classifier': 86.74045138888889, 'validation_loss': 9.041086196899414, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 99.98000399920016, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 99.98000399920016, 'expert_7': 74.99625018749062, 'expert_8': 19.617206107936738, 'expert_9': 0.0}
{'coverage': '8997 out of9216', 'system_accuracy': 86.34982638888889, 'expert_accuracy': 21.004547027810933, 'classifier_accuracy': 87.94042360853147, 'alone_classifier': 86.74045138888889, 'validation_loss': 9.041086196899414, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 99.98000399920016, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 99.98000399920016, 'expert_7': 74.99625018749062, 'expert_8': 19.617206107936738, 'expert_9': 0.0}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '8597 out of9216', 'system_accuracy': 84.13628472222223, 'expert_accuracy': 18.57834617824033, 'classifier_accuracy': 88.8565768424267, 'alone_classifier': 86.62109375, 'validation_loss': 10.380634413825142, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 18.3999705600471, 'expert_8': 18.42695801035595, 'expert_9': 20.408079967020544}
{'coverage': '8597 out of9216', 'system_accuracy': 84.13628472222223, 'expert_accuracy': 18.57834617824033, 'classifier_accuracy': 88.8565768424267, 'alone_classifier': 86.62109375, 'validation_loss': 10.380634413825142, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 18.3999705600471, 'expert_8': 18.42695801035595, 'expert_9': 20.408079967020544}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '8181 out of9216', 'system_accuracy': 83.09461805555556, 'expert_accuracy': 17.004827631917365, 'classifier_accuracy': 91.45581112998642, 'alone_classifier': 87.55425347222223, 'validation_loss': 12.263150427076551, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 7.272714049610818, 'expert_7': 18.10841566126513, 'expert_8': 22.727169421957175, 'expert_9': 7.142755103498522}
{'coverage': '8181 out of9216', 'system_accuracy': 83.09461805555556, 'expert_accuracy': 17.004827631917365, 'classifier_accuracy': 91.45581112998642, 'alone_classifier': 87.55425347222223, 'validation_loss': 12.263150427076551, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 7.272714049610818, 'expert_7': 18.10841566126513, 'expert_8': 22.727169421957175, 'expert_9': 7.142755103498522}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '8339 out of9216', 'system_accuracy': 85.12369791666667, 'expert_accuracy': 17.103758927306973, 'classifier_accuracy': 92.27725036242656, 'alone_classifier': 88.17274305555556, 'validation_loss': 14.462578349643284, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 13.25298011330093, 'expert_6': 24.10709980875034, 'expert_7': 15.48386430801535, 'expert_8': 18.51850137175799, 'expert_9': 0.0}
{'coverage': '8339 out of9216', 'system_accuracy': 85.12369791666667, 'expert_accuracy': 17.103758927306973, 'classifier_accuracy': 92.27725036242656, 'alone_classifier': 88.17274305555556, 'validation_loss': 14.462578349643284, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 13.25298011330093, 'expert_6': 24.10709980875034, 'expert_7': 15.48386430801535, 'expert_8': 18.51850137175799, 'expert_9': 0.0}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '7123 out of9216', 'system_accuracy': 76.5625, 'expert_accuracy': 15.95795356350181, 'classifier_accuracy': 94.37034824694162, 'alone_classifier': 86.28472222222223, 'validation_loss': 17.35621409946018, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 20.7546386617409, 'expert_5': 13.008108929904179, 'expert_6': 17.10353642155486, 'expert_7': 11.246193771310777, 'expert_8': 16.666597222511573, 'expert_9': 7.692189350933063}
{'coverage': '7123 out of9216', 'system_accuracy': 76.5625, 'expert_accuracy': 15.95795356350181, 'classifier_accuracy': 94.37034824694162, 'alone_classifier': 86.28472222222223, 'validation_loss': 17.35621409946018, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 20.7546386617409, 'expert_5': 13.008108929904179, 'expert_6': 17.10353642155486, 'expert_7': 11.246193771310777, 'expert_8': 16.666597222511573, 'expert_9': 7.692189350933063}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '6681 out of9216', 'system_accuracy': 75.03255208333333, 'expert_accuracy': 19.881655236161322, 'classifier_accuracy': 95.95868738274677, 'alone_classifier': 86.69704861111111, 'validation_loss': 21.29990514119466, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 24.672703993413094, 'expert_4': 0.0, 'expert_5': 34.95929274911748, 'expert_6': 0.0, 'expert_7': 15.721646783222203, 'expert_8': 10.810752374311491, 'expert_9': 13.364042982448863}
{'coverage': '6681 out of9216', 'system_accuracy': 75.03255208333333, 'expert_accuracy': 19.881655236161322, 'classifier_accuracy': 95.95868738274677, 'alone_classifier': 86.69704861111111, 'validation_loss': 21.29990514119466, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 24.672703993413094, 'expert_4': 0.0, 'expert_5': 34.95929274911748, 'expert_6': 0.0, 'expert_7': 15.721646783222203, 'expert_8': 10.810752374311491, 'expert_9': 13.364042982448863}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '6820 out of9216', 'system_accuracy': 76.00911458333333, 'expert_accuracy': 18.864773049685056, 'classifier_accuracy': 96.0850425793982, 'alone_classifier': 87.09852430555556, 'validation_loss': 26.100038316514755, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 24.99937501562461, 'expert_3': 24.96412483095414, 'expert_4': 21.34829061989818, 'expert_5': 13.821812852320924, 'expert_6': 39.58316840346499, 'expert_7': 0.0, 'expert_8': 27.2726942149161, 'expert_9': 8.08079175597625}
{'coverage': '6820 out of9216', 'system_accuracy': 76.00911458333333, 'expert_accuracy': 18.864773049685056, 'classifier_accuracy': 96.0850425793982, 'alone_classifier': 87.09852430555556, 'validation_loss': 26.100038316514755, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 24.99937501562461, 'expert_3': 24.96412483095414, 'expert_4': 21.34829061989818, 'expert_5': 13.821812852320924, 'expert_6': 39.58316840346499, 'expert_7': 0.0, 'expert_8': 27.2726942149161, 'expert_9': 8.08079175597625}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '6291 out of9216', 'system_accuracy': 74.35980902777777, 'expert_accuracy': 24.854699155234247, 'classifier_accuracy': 97.3772039838308, 'alone_classifier': 86.93576388888889, 'validation_loss': 31.045420964558918, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 19.626164148252514, 'expert_2': 51.063775464068655, 'expert_3': 9.037324543290946, 'expert_4': 91.4140490767181, 'expert_5': 22.86095645428972, 'expert_6': 7.792187552759603, 'expert_7': 46.42823979828716, 'expert_8': 0.0, 'expert_9': 11.848330001582937}
{'coverage': '6291 out of9216', 'system_accuracy': 74.35980902777777, 'expert_accuracy': 24.854699155234247, 'classifier_accuracy': 97.3772039838308, 'alone_classifier': 86.93576388888889, 'validation_loss': 31.045420964558918, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 19.626164148252514, 'expert_2': 51.063775464068655, 'expert_3': 9.037324543290946, 'expert_4': 91.4140490767181, 'expert_5': 22.86095645428972, 'expert_6': 7.792187552759603, 'expert_7': 46.42823979828716, 'expert_8': 0.0, 'expert_9': 11.848330001582937}
Traceback (most recent call last):
  File "analyse_increase_oracles.py", line 179, in <module>
    validation(model_name, expert_fns, config)
  File "analyse_increase_oracles.py", line 107, in validation
    get('test', test_dl)
  File "analyse_increase_oracles.py", line 65, in get
    true, confidence, expert_predictions = forward(model, dl, expert_fns, n_dataset, n_expert)
  File "analyse_increase_oracles.py", line 32, in forward
    expert_pred1 = fn(inp, lbl)
  File "/home/rverma/Multi-L2D/CIFAR-10/models/experts.py", line 58, in predict_prob_cifar
    outs[i] = random.randint(self.k2, self.n_classes - 1)
  File "/home/rverma/.conda/envs/defer/lib/python3.8/random.py", line 248, in randint
    return self.randrange(a, b+1)
  File "/home/rverma/.conda/envs/defer/lib/python3.8/random.py", line 226, in randrange
    raise ValueError("empty range for randrange() (%d, %d, %d)" % (istart, istop, width))
ValueError: empty range for randrange() (10, 10, 0)
srun: error: r35n3: task 0: Exited with exit code 1
