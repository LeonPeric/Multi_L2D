Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "cuDNN"
   Try: "module spider cuDNN" to see how to load the module(s).



cuda:0
cuda:0
{'batch_size': 1024, 'alpha': 1.0, 'epochs': 100, 'patience': 20, 'expert_type': 'predict', 'n_classes': 10, 'k': 5, 'n_experts': 10, 'lr': 0.1, 'weight_decay': 0.0005, 'warmup_epochs': 0, 'loss_type': 'ova', 'ckp_dir': './ova_increase_oracle/', 'experiment_name': 'increase_oracles'}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '9094 out of9216', 'system_accuracy': 87.71701388888889, 'expert_accuracy': 15.573744961073833, 'classifier_accuracy': 88.6848461767666, 'alone_classifier': 88.03168402777777, 'validation_loss': 8.330415195888943, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 33.33111125924938, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 16.071399872500226}
{'coverage': '9094 out of9216', 'system_accuracy': 87.71701388888889, 'expert_accuracy': 15.573744961073833, 'classifier_accuracy': 88.6848461767666, 'alone_classifier': 88.03168402777777, 'validation_loss': 8.330415195888943, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 33.33111125924938, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 16.071399872500226}
/home/rverma/.conda/envs/defer/lib/python3.8/site-packages/torch/nn/functional.py:1944: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '8997 out of9216', 'system_accuracy': 86.45833333333333, 'expert_accuracy': 25.570752903422004, 'classifier_accuracy': 87.94042360853147, 'alone_classifier': 86.74045138888889, 'validation_loss': 8.75476106007894, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 99.98000399920016, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 49.99750012499374, 'expert_8': 25.358827407820662, 'expert_9': 0.0}
{'coverage': '8997 out of9216', 'system_accuracy': 86.45833333333333, 'expert_accuracy': 25.570752903422004, 'classifier_accuracy': 87.94042360853147, 'alone_classifier': 86.74045138888889, 'validation_loss': 8.75476106007894, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 99.98000399920016, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 49.99750012499374, 'expert_8': 25.358827407820662, 'expert_9': 0.0}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '8597 out of9216', 'system_accuracy': 84.13628472222223, 'expert_accuracy': 18.57834617824033, 'classifier_accuracy': 88.8565768424267, 'alone_classifier': 86.62109375, 'validation_loss': 9.955621189541286, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 21.599965440055296, 'expert_8': 17.977520010103365, 'expert_9': 16.326463973616434}
{'coverage': '8597 out of9216', 'system_accuracy': 84.13628472222223, 'expert_accuracy': 18.57834617824033, 'classifier_accuracy': 88.8565768424267, 'alone_classifier': 86.62109375, 'validation_loss': 9.955621189541286, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 21.599965440055296, 'expert_8': 17.977520010103365, 'expert_9': 16.326463973616434}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '8181 out of9216', 'system_accuracy': 83.30078125, 'expert_accuracy': 18.8405760694539, 'classifier_accuracy': 91.45581112998642, 'alone_classifier': 87.55425347222223, 'validation_loss': 11.665576193067762, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 12.727249586818932, 'expert_7': 19.492498386966925, 'expert_8': 24.99988636415289, 'expert_9': 7.142755103498522}
{'coverage': '8181 out of9216', 'system_accuracy': 83.30078125, 'expert_accuracy': 18.8405760694539, 'classifier_accuracy': 91.45581112998642, 'alone_classifier': 87.55425347222223, 'validation_loss': 11.665576193067762, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 12.727249586818932, 'expert_7': 19.492498386966925, 'expert_8': 24.99988636415289, 'expert_9': 7.142755103498522}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '8339 out of9216', 'system_accuracy': 85.43836805555556, 'expert_accuracy': 20.410485653252987, 'classifier_accuracy': 92.27725036242656, 'alone_classifier': 88.17274305555556, 'validation_loss': 13.675586912367079, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 14.45779648723738, 'expert_6': 31.24994419652822, 'expert_7': 17.63440101746193, 'expert_8': 23.148126714697487, 'expert_9': 0.0}
{'coverage': '8339 out of9216', 'system_accuracy': 85.43836805555556, 'expert_accuracy': 20.410485653252987, 'classifier_accuracy': 92.27725036242656, 'alone_classifier': 88.17274305555556, 'validation_loss': 13.675586912367079, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 14.45779648723738, 'expert_6': 31.24994419652822, 'expert_7': 17.63440101746193, 'expert_8': 23.148126714697487, 'expert_9': 0.0}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '7123 out of9216', 'system_accuracy': 77.49565972222223, 'expert_accuracy': 20.066887714583114, 'classifier_accuracy': 94.37034824694162, 'alone_classifier': 86.28472222222223, 'validation_loss': 16.27038425869412, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 18.867853328855364, 'expert_5': 18.699156586737256, 'expert_6': 21.231976247447413, 'expert_7': 16.413363882453567, 'expert_8': 14.583272569697627, 'expert_9': 15.384378701866126}
{'coverage': '7123 out of9216', 'system_accuracy': 77.49565972222223, 'expert_accuracy': 20.066887714583114, 'classifier_accuracy': 94.37034824694162, 'alone_classifier': 86.28472222222223, 'validation_loss': 16.27038425869412, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 18.867853328855364, 'expert_5': 18.699156586737256, 'expert_6': 21.231976247447413, 'expert_7': 16.413363882453567, 'expert_8': 14.583272569697627, 'expert_9': 15.384378701866126}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '6681 out of9216', 'system_accuracy': 76.45399305555556, 'expert_accuracy': 25.04930768841754, 'classifier_accuracy': 95.95868738274677, 'alone_classifier': 86.69704861111111, 'validation_loss': 19.86272430419922, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 29.80865462061337, 'expert_4': 0.0, 'expert_5': 38.211319981593526, 'expert_6': 0.0, 'expert_7': 20.18899996752578, 'expert_8': 24.324192842200855, 'expert_9': 22.11979528129467}
{'coverage': '6681 out of9216', 'system_accuracy': 76.45399305555556, 'expert_accuracy': 25.04930768841754, 'classifier_accuracy': 95.95868738274677, 'alone_classifier': 86.69704861111111, 'validation_loss': 19.86272430419922, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 29.80865462061337, 'expert_4': 0.0, 'expert_5': 38.211319981593526, 'expert_6': 0.0, 'expert_7': 20.18899996752578, 'expert_8': 24.324192842200855, 'expert_9': 22.11979528129467}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '6820 out of9216', 'system_accuracy': 77.72352430555556, 'expert_accuracy': 25.459096372362573, 'classifier_accuracy': 96.0850425793982, 'alone_classifier': 87.09852430555556, 'validation_loss': 24.548173268636067, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 12.499687507812306, 'expert_3': 32.71161184745715, 'expert_4': 22.471884863050715, 'expert_5': 23.147373330995283, 'expert_6': 33.333194445023146, 'expert_7': 0.0, 'expert_8': 18.78785601471998, 'expert_9': 16.1615835119525}
{'coverage': '6820 out of9216', 'system_accuracy': 77.72352430555556, 'expert_accuracy': 25.459096372362573, 'classifier_accuracy': 96.0850425793982, 'alone_classifier': 87.09852430555556, 'validation_loss': 24.548173268636067, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 12.499687507812306, 'expert_3': 32.71161184745715, 'expert_4': 22.471884863050715, 'expert_5': 23.147373330995283, 'expert_6': 33.333194445023146, 'expert_7': 0.0, 'expert_8': 18.78785601471998, 'expert_9': 16.1615835119525}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '6291 out of9216', 'system_accuracy': 74.14279513888889, 'expert_accuracy': 24.170938518226425, 'classifier_accuracy': 97.3772039838308, 'alone_classifier': 86.93576388888889, 'validation_loss': 37.44930097791884, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 23.2606389905215, 'expert_2': 53.19143277507151, 'expert_3': 17.4852583554977, 'expert_4': 23.737349760252766, 'expert_5': 24.866303511683554, 'expert_6': 10.38958340367947, 'expert_7': 35.71403061406704, 'expert_8': 0.0, 'expert_9': 20.37912760272265}
{'coverage': '6291 out of9216', 'system_accuracy': 74.14279513888889, 'expert_accuracy': 24.170938518226425, 'classifier_accuracy': 97.3772039838308, 'alone_classifier': 86.93576388888889, 'validation_loss': 37.44930097791884, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 23.2606389905215, 'expert_2': 53.19143277507151, 'expert_3': 17.4852583554977, 'expert_4': 23.737349760252766, 'expert_5': 24.866303511683554, 'expert_6': 10.38958340367947, 'expert_7': 35.71403061406704, 'expert_8': 0.0, 'expert_9': 20.37912760272265}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '6305 out of9216', 'system_accuracy': 74.35980902777777, 'expert_accuracy': 24.630709403592622, 'classifier_accuracy': 97.31958608533567, 'alone_classifier': 86.50173611111111, 'validation_loss': 34.02577379014757, 'n_experts': 10, 'expert_0': 37.24337991590621, 'expert_1': 33.33316239403901, 'expert_2': 18.28254341203784, 'expert_3': 28.119343920552637, 'expert_4': 18.595025954524004, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 19.371707464180666, 'expert_8': 20.27647900785345, 'expert_9': 15.094282663084291}
{'coverage': '6305 out of9216', 'system_accuracy': 74.35980902777777, 'expert_accuracy': 24.630709403592622, 'classifier_accuracy': 97.31958608533567, 'alone_classifier': 86.50173611111111, 'validation_loss': 34.02577379014757, 'n_experts': 10, 'expert_0': 37.24337991590621, 'expert_1': 33.33316239403901, 'expert_2': 18.28254341203784, 'expert_3': 28.119343920552637, 'expert_4': 18.595025954524004, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 19.371707464180666, 'expert_8': 20.27647900785345, 'expert_9': 15.094282663084291}
