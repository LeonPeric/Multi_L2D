Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "cuDNN"
   Try: "module spider cuDNN" to see how to load the module(s).



cuda:0
cuda:0
{'batch_size': 1024, 'alpha': 1.0, 'epochs': 100, 'patience': 20, 'expert_type': 'predict', 'n_classes': 10, 'k': 5, 'n_experts': 2, 'lr': 0.1, 'weight_decay': 0.0005, 'warmup_epochs': 0, 'loss_type': 'softmax', 'ckp_dir': './softmax_increase_experts/', 'experiment_name': 'multiple_experts'}
seed is 948
n is 1
torch.Size([9216]) torch.Size([9216, 11]) [torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 11]), expert_predictions (1, 9216)
Evaluate...
{'coverage': '7392 out of9216', 'system_accuracy': 91.61241319444444, 'expert_accuracy': 85.25218363462899, 'classifier_accuracy': 93.18181692124165, 'alone_classifier': 86.50173611111111, 'validation_loss': 2.059084892272949, 'n_experts': 1, 'expert_0': 85.25218363462899}
n is 2
torch.Size([9216]) torch.Size([9216, 12]) [torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 12]), expert_predictions (2, 9216)
Evaluate...
{'coverage': '5398 out of9216', 'system_accuracy': 92.7734375, 'expert_accuracy': 93.68778974919907, 'classifier_accuracy': 92.12671189094642, 'alone_classifier': 87.20703125, 'validation_loss': 3.947682168748644, 'n_experts': 2, 'expert_0': 92.81580590011515, 'expert_1': 94.72475977927067}
n is 4
torch.Size([9216]) torch.Size([9216, 14]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 14]), expert_predictions (4, 9216)
Evaluate...
{'coverage': '4654 out of9216', 'system_accuracy': 92.89279513888889, 'expert_accuracy': 94.629544295066, 'classifier_accuracy': 91.19037191254036, 'alone_classifier': 86.78385416666667, 'validation_loss': 8.541615804036459, 'n_experts': 4, 'expert_0': 89.60627099015088, 'expert_1': 97.40255523698907, 'expert_2': 95.43072785618581, 'expert_3': 65.51678953938249}
n is 6
torch.Size([9216]) torch.Size([9216, 16]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 16]), expert_predictions (6, 9216)
Evaluate...
{'coverage': '3760 out of9216', 'system_accuracy': 93.67404513888889, 'expert_accuracy': 93.98826634940372, 'classifier_accuracy': 93.21808262717865, 'alone_classifier': 87.84722222222223, 'validation_loss': 13.808470831976997, 'n_experts': 6, 'expert_0': 73.68416204989339, 'expert_1': 84.76174331096512, 'expert_2': 96.39766674418827, 'expert_3': 96.61589434676883, 'expert_4': 94.26228649705952, 'expert_5': 94.5312007649996}
n is 8
torch.Size([9216]) torch.Size([9216, 18]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 18]), expert_predictions (8, 9216)
Evaluate...
{'coverage': '4054 out of9216', 'system_accuracy': 94.01041666666667, 'expert_accuracy': 95.1956569083434, 'classifier_accuracy': 92.50123106805053, 'alone_classifier': 87.57595486111111, 'validation_loss': 19.530065112643772, 'n_experts': 8, 'expert_0': 95.99923200614396, 'expert_1': 0.0, 'expert_2': 95.44020100715795, 'expert_3': 0.0, 'expert_4': 94.16908248264104, 'expert_5': 94.0473951252497, 'expert_6': 99.12263311818751, 'expert_7': 97.49975625060937}
n is 10
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '3873 out of9216', 'system_accuracy': 93.51128472222223, 'expert_accuracy': 94.44132156311728, 'classifier_accuracy': 92.2282444557644, 'alone_classifier': 87.03342013888889, 'validation_loss': 25.782114664713543, 'n_experts': 10, 'expert_0': 78.98086656660301, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 99.99500024998748, 'expert_4': 97.40115071518655, 'expert_5': 0.0, 'expert_6': 76.6466147944733, 'expert_7': 85.7136734737609, 'expert_8': 66.66555557407376, 'expert_9': 99.98000399920016}
n is 14
torch.Size([9216]) torch.Size([9216, 24]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 24]), expert_predictions (14, 9216)
Evaluate...
{'coverage': '4047 out of9216', 'system_accuracy': 93.67404513888889, 'expert_accuracy': 94.33158853427786, 'classifier_accuracy': 92.8341958775835, 'alone_classifier': 87.57595486111111, 'validation_loss': 39.00972196790907, 'n_experts': 14, 'expert_0': 84.20963989852739, 'expert_1': 84.6140828602637, 'expert_2': 0.0, 'expert_3': 71.42755103498521, 'expert_4': 79.41164792404717, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 71.42836734752186, 'expert_8': 83.33320105841102, 'expert_9': 94.57402691946989, 'expert_10': 0.0, 'expert_11': 61.537514807464504, 'expert_12': 79.99680012799487, 'expert_13': 96.35843653277854}
n is 18
torch.Size([9216]) torch.Size([9216, 28]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 28]), expert_predictions (18, 9216)
Evaluate...
{'coverage': '4236 out of9216', 'system_accuracy': 93.37022569444444, 'expert_accuracy': 93.45381150787905, 'classifier_accuracy': 93.27195247233351, 'alone_classifier': 87.44574652777777, 'validation_loss': 53.37605879041884, 'n_experts': 18, 'expert_0': 77.13563963033184, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 96.9354526014669, 'expert_4': 0.0, 'expert_5': 99.9900009999, 'expert_6': 0.0, 'expert_7': 93.71978412565602, 'expert_8': 0.0, 'expert_9': 85.60599575303353, 'expert_10': 49.99500049995, 'expert_11': 0.0, 'expert_12': 0.0, 'expert_13': 96.97669908060507, 'expert_14': 83.95985766423175, 'expert_15': 99.57848270211113, 'expert_16': 96.79677741806259, 'expert_17': 89.53467550075464}
seed is 625
n is 1
torch.Size([9216]) torch.Size([9216, 11]) [torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 11]), expert_predictions (1, 9216)
Evaluate...
{'coverage': '6006 out of9216', 'system_accuracy': 92.29600694444444, 'expert_accuracy': 93.55139604041146, 'classifier_accuracy': 91.62504009948317, 'alone_classifier': 87.04427083333333, 'validation_loss': 2.05873359574212, 'n_experts': 1, 'expert_0': 93.55139604041146}
n is 2
torch.Size([9216]) torch.Size([9216, 12]) [torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 12]), expert_predictions (2, 9216)
Evaluate...
{'coverage': '5811 out of9216', 'system_accuracy': 92.76258680555556, 'expert_accuracy': 94.06754219867594, 'classifier_accuracy': 91.99793336778637, 'alone_classifier': 88.06423611111111, 'validation_loss': 3.913806782828437, 'n_experts': 2, 'expert_0': 93.78512843315875, 'expert_1': 98.52207042160549}
n is 4
torch.Size([9216]) torch.Size([9216, 14]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 14]), expert_predictions (4, 9216)
Evaluate...
{'coverage': '4900 out of9216', 'system_accuracy': 92.87109375, 'expert_accuracy': 93.97589925968956, 'classifier_accuracy': 91.89795730820495, 'alone_classifier': 87.13107638888889, 'validation_loss': 8.536770078870985, 'n_experts': 4, 'expert_0': 91.73225938785843, 'expert_1': 98.97954133696871, 'expert_2': 94.60897872818778, 'expert_3': 80.25467483480912}
n is 6
torch.Size([9216]) torch.Size([9216, 16]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 16]), expert_predictions (6, 9216)
Evaluate...
{'coverage': '4949 out of9216', 'system_accuracy': 93.04470486111111, 'expert_accuracy': 93.41457260770693, 'classifier_accuracy': 92.72580131893713, 'alone_classifier': 86.17621527777777, 'validation_loss': 13.803902520073784, 'n_experts': 6, 'expert_0': 95.83332699515033, 'expert_1': 92.3497015437974, 'expert_2': 93.38827539128035, 'expert_3': 59.99940000599994, 'expert_4': 81.51253654408694, 'expert_5': 70.4544387053959}
n is 8
torch.Size([9216]) torch.Size([9216, 18]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 18]), expert_predictions (8, 9216)
Evaluate...
{'coverage': '4278 out of9216', 'system_accuracy': 93.45703125, 'expert_accuracy': 93.9449131654551, 'classifier_accuracy': 92.89387347139146, 'alone_classifier': 87.59765625, 'validation_loss': 19.54044511583116, 'n_experts': 8, 'expert_0': 99.3241901024458, 'expert_1': 0.0, 'expert_2': 93.23728745599941, 'expert_3': 0.0, 'expert_4': 93.5195426235148, 'expert_5': 89.2850765351676, 'expert_6': 97.29724470419205, 'expert_7': 99.99980582561975}
n is 10
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '3883 out of9216', 'system_accuracy': 93.67404513888889, 'expert_accuracy': 94.26213784878537, 'classifier_accuracy': 92.86633806679531, 'alone_classifier': 87.23958333333333, 'validation_loss': 25.77658208211263, 'n_experts': 10, 'expert_0': 59.997600095996155, 'expert_1': 92.9935713416743, 'expert_2': 99.49662760123698, 'expert_3': 87.05879426595152, 'expert_4': 99.26468155277414, 'expert_5': 99.99600015999359, 'expert_6': 74.56133810408939, 'expert_7': 97.5903144143063, 'expert_8': 99.9980000399992, 'expert_9': 92.86935620429479}
n is 14
torch.Size([9216]) torch.Size([9216, 24]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 24]), expert_predictions (14, 9216)
Evaluate...
{'coverage': '3750 out of9216', 'system_accuracy': 93.31597222222223, 'expert_accuracy': 93.59677667044359, 'classifier_accuracy': 92.90666418915562, 'alone_classifier': 86.57769097222223, 'validation_loss': 39.05912992689345, 'n_experts': 14, 'expert_0': 75.6093872712816, 'expert_1': 59.997600095996155, 'expert_2': 0.0, 'expert_3': 78.12475586013792, 'expert_4': 78.10207576339305, 'expert_5': 79.99680012799487, 'expert_6': 99.98000399920016, 'expert_7': 74.07389117557734, 'expert_8': 74.21863403338432, 'expert_9': 88.12055175167522, 'expert_10': 99.99600015999359, 'expert_11': 63.63520663260668, 'expert_12': 99.99500024998748, 'expert_13': 97.38070034332468}
n is 18
torch.Size([9216]) torch.Size([9216, 28]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 28]), expert_predictions (18, 9216)
Evaluate...
{'coverage': '4067 out of9216', 'system_accuracy': 92.93619791666667, 'expert_accuracy': 93.57156366006744, 'classifier_accuracy': 92.13179021067641, 'alone_classifier': 86.34982638888889, 'validation_loss': 53.3797976175944, 'n_experts': 18, 'expert_0': 82.72246977881163, 'expert_1': 0.0, 'expert_2': 99.9900009999, 'expert_3': 95.6521045999242, 'expert_4': 0.0, 'expert_5': 99.99750006249845, 'expert_6': 0.0, 'expert_7': 91.92748206672749, 'expert_8': 79.99680012799487, 'expert_9': 88.6739841580198, 'expert_10': 99.98000399920016, 'expert_11': 99.98000399920016, 'expert_12': 0.0, 'expert_13': 94.4839521409423, 'expert_14': 85.92590046639987, 'expert_15': 98.20492173449189, 'expert_16': 98.75281207419228, 'expert_17': 97.9587838416986}
seed is 436
n is 1
torch.Size([9216]) torch.Size([9216, 11]) [torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 11]), expert_predictions (1, 9216)
Evaluate...
{'coverage': '5115 out of9216', 'system_accuracy': 92.95789930555556, 'expert_accuracy': 95.0987517630455, 'classifier_accuracy': 91.24144494151622, 'alone_classifier': 87.26128472222223, 'validation_loss': 2.05696169535319, 'n_experts': 1, 'expert_0': 95.0987517630455}
n is 2
torch.Size([9216]) torch.Size([9216, 12]) [torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 12]), expert_predictions (2, 9216)
Evaluate...
{'coverage': '5238 out of9216', 'system_accuracy': 92.33940972222223, 'expert_accuracy': 92.35796418511995, 'classifier_accuracy': 92.32531324312116, 'alone_classifier': 85.86154513888889, 'validation_loss': 3.943716181649102, 'n_experts': 2, 'expert_0': 71.57890969531068, 'expert_1': 94.55252392704148}
n is 4
torch.Size([9216]) torch.Size([9216, 14]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 14]), expert_predictions (4, 9216)
Evaluate...
{'coverage': '5104 out of9216', 'system_accuracy': 92.94704861111111, 'expert_accuracy': 94.38229112926598, 'classifier_accuracy': 91.79075055268905, 'alone_classifier': 86.88151041666667, 'validation_loss': 8.51710287729899, 'n_experts': 4, 'expert_0': 93.44640039377018, 'expert_1': 94.17466584983897, 'expert_2': 94.88460808579939, 'expert_3': 88.88691362414168}
n is 6
torch.Size([9216]) torch.Size([9216, 16]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 16]), expert_predictions (6, 9216)
Evaluate...
{'coverage': '4715 out of9216', 'system_accuracy': 92.96875, 'expert_accuracy': 93.62363503116484, 'classifier_accuracy': 92.34358234690175, 'alone_classifier': 85.94835069444444, 'validation_loss': 13.836307843526205, 'n_experts': 6, 'expert_0': 96.01557243765293, 'expert_1': 89.89748465666628, 'expert_2': 84.90533997984913, 'expert_3': 0.0, 'expert_4': 81.71740625074446, 'expert_5': 83.33308080884602}
n is 8
torch.Size([9216]) torch.Size([9216, 18]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 18]), expert_predictions (8, 9216)
Evaluate...
{'coverage': '3936 out of9216', 'system_accuracy': 92.99045138888889, 'expert_accuracy': 93.95832977430568, 'classifier_accuracy': 91.69207084115673, 'alone_classifier': 86.40407986111111, 'validation_loss': 19.58703104654948, 'n_experts': 8, 'expert_0': 93.65049634763065, 'expert_1': 0.0, 'expert_2': 93.37966942206756, 'expert_3': 99.98000399920016, 'expert_4': 94.04301224015309, 'expert_5': 94.11727797145893, 'expert_6': 99.99974683608396, 'expert_7': 98.4126203074442}
n is 10
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '4017 out of9216', 'system_accuracy': 93.57638888888889, 'expert_accuracy': 93.96037338102045, 'classifier_accuracy': 93.0794101797508, 'alone_classifier': 87.08767361111111, 'validation_loss': 25.76684506734212, 'n_experts': 10, 'expert_0': 91.66513891435143, 'expert_1': 93.74995814734011, 'expert_2': 99.50528628900547, 'expert_3': 82.08089322508933, 'expert_4': 98.67307631530126, 'expert_5': 0.0, 'expert_6': 79.62957064476248, 'expert_7': 98.64858199420135, 'expert_8': 0.0, 'expert_9': 91.84395860369382}
n is 14
torch.Size([9216]) torch.Size([9216, 24]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 24]), expert_predictions (14, 9216)
Evaluate...
{'coverage': '4047 out of9216', 'system_accuracy': 93.05555555555556, 'expert_accuracy': 93.98335871606272, 'classifier_accuracy': 91.87051910376775, 'alone_classifier': 86.34982638888889, 'validation_loss': 39.06452857123481, 'n_experts': 14, 'expert_0': 83.33194446759221, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 82.3524567502544, 'expert_4': 77.53611951287027, 'expert_5': 59.997600095996155, 'expert_6': 0.0, 'expert_7': 65.51701545856739, 'expert_8': 78.43121876231615, 'expert_9': 91.5662528023758, 'expert_10': 0.0, 'expert_11': 84.6140828602637, 'expert_12': 0.0, 'expert_13': 96.98158183026973}
n is 18
torch.Size([9216]) torch.Size([9216, 28]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 28]), expert_predictions (18, 9216)
Evaluate...
{'coverage': '3993 out of9216', 'system_accuracy': 93.97786458333333, 'expert_accuracy': 94.86884568758009, 'classifier_accuracy': 92.81241941366342, 'alone_classifier': 87.40234375, 'validation_loss': 53.32421366373698, 'n_experts': 18, 'expert_0': 75.35537881006748, 'expert_1': 0.0, 'expert_2': 99.98000399920016, 'expert_3': 97.92202705349244, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 95.49032276444915, 'expert_8': 0.0, 'expert_9': 86.90090293872017, 'expert_10': 99.98000399920016, 'expert_11': 99.98000399920016, 'expert_12': 99.98000399920016, 'expert_13': 93.74980468790689, 'expert_14': 89.87563414719925, 'expert_15': 99.19222953275775, 'expert_16': 96.99997844444924, 'expert_17': 97.39113497193917}
===Mean and Standard Error===
[92.28877315 92.62514468 92.90364583 93.22916667 93.48596644 93.58723958
 93.34852431 93.42809606]
[0.38842522 0.14290181 0.02258752 0.22351728 0.29479384 0.04729708
 0.1792829  0.3020922 ]
