Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "cuDNN"
   Try: "module spider cuDNN" to see how to load the module(s).



cuda:0
cuda:0
{'batch_size': 1024, 'alpha': 1.0, 'epochs': 100, 'patience': 20, 'expert_type': 'predict', 'n_classes': 10, 'k': 5, 'n_experts': 10, 'lr': 0.1, 'weight_decay': 0.0005, 'warmup_epochs': 0, 'loss_type': 'ova', 'ckp_dir': './ova_increase_oracle_v2/', 'experiment_name': 'increase_oracles_v2'}
log is of type <class 'dict'>
type of S, type of idx  <class 'list'> <class 'list'>
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '4559 out of9216', 'system_accuracy': 45.10633680555556, 'expert_accuracy': 1.4816404774902092, 'classifier_accuracy': 89.66878504784415, 'alone_classifier': 87.36979166666667, 'validation_loss': 5.349726835886638, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 1.470588134706694, 'expert_3': 0.0, 'expert_4': 1.0423052063390306, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 8.823512110760566, 'expert_9': 0.0}
{'coverage': '4559 out of9216', 'system_accuracy': 45.10633680555556, 'expert_accuracy': 1.4816404774902092, 'classifier_accuracy': 89.66878504784415, 'alone_classifier': 87.36979166666667, 'validation_loss': 5.349726835886638, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 1.470588134706694, 'expert_3': 0.0, 'expert_4': 1.0423052063390306, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 8.823512110760566, 'expert_9': 0.0}
type of S, type of idx  <class 'list'> <class 'list'>
/home/rverma/.conda/envs/defer/lib/python3.8/site-packages/torch/nn/functional.py:1944: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '4586 out of9216', 'system_accuracy': 86.14366319444444, 'expert_accuracy': 87.25701566924337, 'classifier_accuracy': 85.0196230915913, 'alone_classifier': 86.55598958333333, 'validation_loss': 5.570460319519043, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 95.46870796122234, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 4.6035782078883845, 'expert_6': 0.0, 'expert_7': 61.53827218993172, 'expert_8': 0.0, 'expert_9': 0.0}
{'coverage': '4586 out of9216', 'system_accuracy': 86.14366319444444, 'expert_accuracy': 87.25701566924337, 'classifier_accuracy': 85.0196230915913, 'alone_classifier': 86.55598958333333, 'validation_loss': 5.570460319519043, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 95.46870796122234, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 4.6035782078883845, 'expert_6': 0.0, 'expert_7': 61.53827218993172, 'expert_8': 0.0, 'expert_9': 0.0}
log is of type <class 'dict'>
type of S, type of idx  <class 'list'> <class 'list'>
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '4810 out of9216', 'system_accuracy': 43.10980902777778, 'expert_accuracy': 1.134816108269809, 'classifier_accuracy': 81.55924986363306, 'alone_classifier': 85.69878472222223, 'validation_loss': 5.291016896565755, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 5.882318339303887, 'expert_5': 0.0, 'expert_6': 0.4569190004022193, 'expert_7': 0.0, 'expert_8': 1.4441703808263204, 'expert_9': 0.0}
{'coverage': '4810 out of9216', 'system_accuracy': 43.10980902777778, 'expert_accuracy': 1.134816108269809, 'classifier_accuracy': 81.55924986363306, 'alone_classifier': 85.69878472222223, 'validation_loss': 5.291016896565755, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 5.882318339303887, 'expert_5': 0.0, 'expert_6': 0.4569190004022193, 'expert_7': 0.0, 'expert_8': 1.4441703808263204, 'expert_9': 0.0}
type of S, type of idx  <class 'list'> <class 'list'>
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '4576 out of9216', 'system_accuracy': 44.78081597222222, 'expert_accuracy': 1.8534481959720603, 'classifier_accuracy': 88.3085645037464, 'alone_classifier': 86.61024305555556, 'validation_loss': 5.899630228678386, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 2.227090016276742, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 1.104651034342903, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 2.42423948577032, 'expert_8': 0.0, 'expert_9': 15.384378701866126}
{'coverage': '4576 out of9216', 'system_accuracy': 44.78081597222222, 'expert_accuracy': 1.8534481959720603, 'classifier_accuracy': 88.3085645037464, 'alone_classifier': 86.61024305555556, 'validation_loss': 5.899630228678386, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 2.227090016276742, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 1.104651034342903, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 2.42423948577032, 'expert_8': 0.0, 'expert_9': 15.384378701866126}
log is of type <class 'dict'>
type of S, type of idx  <class 'list'> <class 'list'>
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '4751 out of9216', 'system_accuracy': 45.442708333333336, 'expert_accuracy': 1.881298907892546, 'classifier_accuracy': 86.38181253669096, 'alone_classifier': 85.26475694444444, 'validation_loss': 5.699628194173177, 'n_experts': 10, 'expert_0': 1.526418667207932, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 3.094910165762013, 'expert_9': 0.0}
{'coverage': '4751 out of9216', 'system_accuracy': 45.442708333333336, 'expert_accuracy': 1.881298907892546, 'classifier_accuracy': 86.38181253669096, 'alone_classifier': 85.26475694444444, 'validation_loss': 5.699628194173177, 'n_experts': 10, 'expert_0': 1.526418667207932, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 3.094910165762013, 'expert_9': 0.0}
type of S, type of idx  <class 'list'> <class 'list'>
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '4893 out of9216', 'system_accuracy': 83.56119791666667, 'expert_accuracy': 80.40712096196525, 'classifier_accuracy': 86.34784209385158, 'alone_classifier': 86.72960069444444, 'validation_loss': 5.7177719540066185, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 99.52378582767005, 'expert_4': 52.631024936579614, 'expert_5': 96.84999031500097, 'expert_6': 89.85311352386823, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 2.7972020147686676}
{'coverage': '4893 out of9216', 'system_accuracy': 83.56119791666667, 'expert_accuracy': 80.40712096196525, 'classifier_accuracy': 86.34784209385158, 'alone_classifier': 86.72960069444444, 'validation_loss': 5.7177719540066185, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 99.52378582767005, 'expert_4': 52.631024936579614, 'expert_5': 96.84999031500097, 'expert_6': 89.85311352386823, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 2.7972020147686676}
