Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "cuDNN"
   Try: "module spider cuDNN" to see how to load the module(s).



cuda:0
cuda:0
{'batch_size': 1024, 'alpha': 1.0, 'epochs': 100, 'patience': 20, 'expert_type': 'predict', 'n_classes': 10, 'k': 5, 'n_experts': 2, 'lr': 0.1, 'weight_decay': 0.0005, 'warmup_epochs': 0, 'loss_type': 'softmax', 'ckp_dir': './softmax_increase_experts/', 'experiment_name': 'multiple_experts'}
n is 1
torch.Size([9216]) torch.Size([9216, 11]) [torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 11]), expert_predictions (1, 9216)
Evaluate...
{'coverage': '5559 out of9216', 'system_accuracy': 92.54557291666667, 'expert_accuracy': 94.0114796821723, 'classifier_accuracy': 91.58121799638032, 'alone_classifier': 87.91232638888889, 'validation_loss': 2.091891050338745, 'n_experts': 1, 'expert_0': 94.0114796821723}
{'coverage': '5559 out of9216', 'system_accuracy': 92.50217013888889, 'expert_accuracy': 93.90210041552636, 'classifier_accuracy': 91.58121799638032, 'alone_classifier': 87.91232638888889, 'validation_loss': 2.0924786461724176, 'n_experts': 1, 'expert_0': 93.90210041552636}
{'coverage': '5559 out of9216', 'system_accuracy': 92.50217013888889, 'expert_accuracy': 93.90210041552636, 'classifier_accuracy': 91.58121799638032, 'alone_classifier': 87.91232638888889, 'validation_loss': 2.0924786461724176, 'n_experts': 1, 'expert_0': 93.90210041552636}
n is 2
torch.Size([9216]) torch.Size([9216, 12]) [torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 12]), expert_predictions (2, 9216)
Evaluate...
{'coverage': '5955 out of9216', 'system_accuracy': 92.71918402777777, 'expert_accuracy': 92.88561221186065, 'classifier_accuracy': 92.62804210532255, 'alone_classifier': 86.75130208333333, 'validation_loss': 3.941265927420722, 'n_experts': 2, 'expert_0': 99.98000399920016, 'expert_1': 92.88342988445216}
{'coverage': '5955 out of9216', 'system_accuracy': 92.76258680555556, 'expert_accuracy': 93.00827396453396, 'classifier_accuracy': 92.62804210532255, 'alone_classifier': 86.75130208333333, 'validation_loss': 3.945222324795193, 'n_experts': 2, 'expert_0': 99.98000399920016, 'expert_1': 93.00612926342765}
{'coverage': '5955 out of9216', 'system_accuracy': 92.76258680555556, 'expert_accuracy': 93.00827396453396, 'classifier_accuracy': 92.62804210532255, 'alone_classifier': 86.75130208333333, 'validation_loss': 3.945222324795193, 'n_experts': 2, 'expert_0': 99.98000399920016, 'expert_1': 93.00612926342765}
n is 4
torch.Size([9216]) torch.Size([9216, 14]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 14]), expert_predictions (4, 9216)
Evaluate...
{'coverage': '5127 out of9216', 'system_accuracy': 93.15321180555556, 'expert_accuracy': 94.08167796127768, 'classifier_accuracy': 92.41271518602076, 'alone_classifier': 87.40234375, 'validation_loss': 8.49703205956353, 'n_experts': 4, 'expert_0': 93.57863007523376, 'expert_1': 97.85571233695427, 'expert_2': 93.66099277345037, 'expert_3': 69.22970415839757}
{'coverage': '5127 out of9216', 'system_accuracy': 93.1640625, 'expert_accuracy': 94.10613381725929, 'classifier_accuracy': 92.41271518602076, 'alone_classifier': 87.40234375, 'validation_loss': 8.48916647169325, 'n_experts': 4, 'expert_0': 93.65078013697257, 'expert_1': 97.66078063907189, 'expert_2': 93.79879707865898, 'expert_3': 53.84532545653144}
{'coverage': '5127 out of9216', 'system_accuracy': 93.1640625, 'expert_accuracy': 94.10613381725929, 'classifier_accuracy': 92.41271518602076, 'alone_classifier': 87.40234375, 'validation_loss': 8.48916647169325, 'n_experts': 4, 'expert_0': 93.65078013697257, 'expert_1': 97.66078063907189, 'expert_2': 93.79879707865898, 'expert_3': 53.84532545653144}
n is 6
torch.Size([9216]) torch.Size([9216, 16]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 16]), expert_predictions (6, 9216)
Evaluate...
{'coverage': '5033 out of9216', 'system_accuracy': 93.38107638888889, 'expert_accuracy': 93.35404765220905, 'classifier_accuracy': 93.40353480223455, 'alone_classifier': 86.64279513888889, 'validation_loss': 13.8145629035102, 'n_experts': 6, 'expert_0': 94.99999208333399, 'expert_1': 93.12405184991752, 'expert_2': 85.71346939552957, 'expert_3': 59.997600095996155, 'expert_4': 85.04667598337944, 'expert_5': 86.73451686833292}
{'coverage': '5033 out of9216', 'system_accuracy': 93.33767361111111, 'expert_accuracy': 93.25842250736683, 'classifier_accuracy': 93.40353480223455, 'alone_classifier': 86.64279513888889, 'validation_loss': 13.83172247144911, 'n_experts': 6, 'expert_0': 95.12499207291732, 'expert_1': 92.67562142367393, 'expert_2': 85.71346939552957, 'expert_3': 59.997600095996155, 'expert_4': 84.73514969772604, 'expert_5': 86.73451686833292}
{'coverage': '5033 out of9216', 'system_accuracy': 93.33767361111111, 'expert_accuracy': 93.25842250736683, 'classifier_accuracy': 93.40353480223455, 'alone_classifier': 86.64279513888889, 'validation_loss': 13.83172247144911, 'n_experts': 6, 'expert_0': 95.12499207291732, 'expert_1': 92.67562142367393, 'expert_2': 85.71346939552957, 'expert_3': 59.997600095996155, 'expert_4': 84.73514969772604, 'expert_5': 86.73451686833292}
n is 8
torch.Size([9216]) torch.Size([9216, 18]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 18]), expert_predictions (8, 9216)
Evaluate...
{'coverage': '4388 out of9216', 'system_accuracy': 92.74088541666667, 'expert_accuracy': 93.08201768508626, 'classifier_accuracy': 92.36554028337419, 'alone_classifier': 86.75130208333333, 'validation_loss': 19.579110039605034, 'n_experts': 8, 'expert_0': 97.93457866874722, 'expert_1': 83.04170039254365, 'expert_2': 78.08197785759491, 'expert_3': 95.99996800001067, 'expert_4': 99.99333377774815, 'expert_5': 0.0, 'expert_6': 93.50466415844261, 'expert_7': 95.32692462257079}
{'coverage': '4388 out of9216', 'system_accuracy': 92.90364583333333, 'expert_accuracy': 93.39270532755984, 'classifier_accuracy': 92.36554028337419, 'alone_classifier': 86.75130208333333, 'validation_loss': 19.63633155822754, 'n_experts': 8, 'expert_0': 98.19275418369119, 'expert_1': 83.84923718728474, 'expert_2': 83.56141490023315, 'expert_3': 96.16663461112181, 'expert_4': 99.99333377774815, 'expert_5': 0.0, 'expert_6': 93.50466415844261, 'expert_7': 96.26150231494894}
{'coverage': '4388 out of9216', 'system_accuracy': 92.90364583333333, 'expert_accuracy': 93.39270532755984, 'classifier_accuracy': 92.36554028337419, 'alone_classifier': 86.75130208333333, 'validation_loss': 19.63633155822754, 'n_experts': 8, 'expert_0': 98.19275418369119, 'expert_1': 83.84923718728474, 'expert_2': 83.56141490023315, 'expert_3': 96.16663461112181, 'expert_4': 99.99333377774815, 'expert_5': 0.0, 'expert_6': 93.50466415844261, 'expert_7': 96.26150231494894}
n is 10
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '4015 out of9216', 'system_accuracy': 93.79340277777777, 'expert_accuracy': 94.7894599196516, 'classifier_accuracy': 92.50311102109312, 'alone_classifier': 87.48914930555556, 'validation_loss': 25.773588604397244, 'n_experts': 10, 'expert_0': 99.99333377774815, 'expert_1': 94.38196944833177, 'expert_2': 99.26811719652466, 'expert_3': 88.6849881697284, 'expert_4': 99.15394275670296, 'expert_5': 99.99666677777407, 'expert_6': 79.62077761063733, 'expert_7': 98.54716777376863, 'expert_8': 99.98000399920016, 'expert_9': 92.34448498366577}
{'coverage': '4015 out of9216', 'system_accuracy': 93.83680555555556, 'expert_accuracy': 94.86636820356208, 'classifier_accuracy': 92.50311102109312, 'alone_classifier': 87.48914930555556, 'validation_loss': 25.807747734917534, 'n_experts': 10, 'expert_0': 99.99333377774815, 'expert_1': 95.22466560412045, 'expert_2': 99.20158360591037, 'expert_3': 88.53208301771163, 'expert_4': 99.32314743717515, 'expert_5': 99.99666677777407, 'expert_6': 80.09471081070065, 'expert_7': 98.54716777376863, 'expert_8': 99.98000399920016, 'expert_9': 92.41283767425323}
{'coverage': '4015 out of9216', 'system_accuracy': 93.83680555555556, 'expert_accuracy': 94.86636820356208, 'classifier_accuracy': 92.50311102109312, 'alone_classifier': 87.48914930555556, 'validation_loss': 25.807747734917534, 'n_experts': 10, 'expert_0': 99.99333377774815, 'expert_1': 95.22466560412045, 'expert_2': 99.20158360591037, 'expert_3': 88.53208301771163, 'expert_4': 99.32314743717515, 'expert_5': 99.99666677777407, 'expert_6': 80.09471081070065, 'expert_7': 98.54716777376863, 'expert_8': 99.98000399920016, 'expert_9': 92.41283767425323}
n is 12
torch.Size([9216]) torch.Size([9216, 22]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 22]), expert_predictions (12, 9216)
Evaluate...
{'coverage': '3999 out of9216', 'system_accuracy': 93.57638888888889, 'expert_accuracy': 94.88211252129145, 'classifier_accuracy': 91.87296594466201, 'alone_classifier': 86.79470486111111, 'validation_loss': 32.30652321709527, 'n_experts': 12, 'expert_0': 0.0, 'expert_1': 98.05818895910099, 'expert_2': 96.16754079009968, 'expert_3': 94.99905000949991, 'expert_4': 76.086625710323, 'expert_5': 83.33327160498399, 'expert_6': 99.03657069881669, 'expert_7': 87.27912110278407, 'expert_8': 93.32190182844147, 'expert_9': 99.55114909315097, 'expert_10': 98.79494266278876, 'expert_11': 0.0}
{'coverage': '3999 out of9216', 'system_accuracy': 93.53298611111111, 'expert_accuracy': 94.80544010713282, 'classifier_accuracy': 91.87296594466201, 'alone_classifier': 86.79470486111111, 'validation_loss': 32.32257440355089, 'n_experts': 12, 'expert_0': 0.0, 'expert_1': 98.05818895910099, 'expert_2': 96.16754079009968, 'expert_3': 99.9990000099999, 'expert_4': 71.73881852687597, 'expert_5': 82.96290150896185, 'expert_6': 98.65121439259562, 'expert_7': 87.27912110278407, 'expert_8': 93.32190182844147, 'expert_9': 99.55114909315097, 'expert_10': 98.79494266278876, 'expert_11': 0.0}
{'coverage': '3999 out of9216', 'system_accuracy': 93.53298611111111, 'expert_accuracy': 94.80544010713282, 'classifier_accuracy': 91.87296594466201, 'alone_classifier': 86.79470486111111, 'validation_loss': 32.32257440355089, 'n_experts': 12, 'expert_0': 0.0, 'expert_1': 98.05818895910099, 'expert_2': 96.16754079009968, 'expert_3': 99.9990000099999, 'expert_4': 71.73881852687597, 'expert_5': 82.96290150896185, 'expert_6': 98.65121439259562, 'expert_7': 87.27912110278407, 'expert_8': 93.32190182844147, 'expert_9': 99.55114909315097, 'expert_10': 98.79494266278876, 'expert_11': 0.0}
n is 16
torch.Size([9216]) torch.Size([9216, 26]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 26]), expert_predictions (16, 9216)
Evaluate...
{'coverage': '3876 out of9216', 'system_accuracy': 93.80425347222223, 'expert_accuracy': 94.21347961747267, 'classifier_accuracy': 93.24045167078297, 'alone_classifier': 87.61935763888889, 'validation_loss': 46.08400175306532, 'n_experts': 16, 'expert_0': 85.88803606421602, 'expert_1': 96.27279427582373, 'expert_2': 99.99600015999359, 'expert_3': 99.98000399920016, 'expert_4': 0.0, 'expert_5': 99.99500024998748, 'expert_6': 0.0, 'expert_7': 99.9985714489793, 'expert_8': 0.0, 'expert_9': 93.74941406616209, 'expert_10': 0.0, 'expert_11': 92.89852379752934, 'expert_12': 0.0, 'expert_13': 85.24995737502131, 'expert_14': 0.0, 'expert_15': 0.0}
{'coverage': '3876 out of9216', 'system_accuracy': 93.91276041666667, 'expert_accuracy': 94.40074552806196, 'classifier_accuracy': 93.24045167078297, 'alone_classifier': 87.61935763888889, 'validation_loss': 46.117920345730255, 'n_experts': 16, 'expert_0': 85.64472718018142, 'expert_1': 96.48426664106441, 'expert_2': 99.99600015999359, 'expert_3': 99.98000399920016, 'expert_4': 0.0, 'expert_5': 99.99500024998748, 'expert_6': 0.0, 'expert_7': 99.9985714489793, 'expert_8': 0.0, 'expert_9': 96.87439453503416, 'expert_10': 0.0, 'expert_11': 93.18837878597716, 'expert_12': 0.0, 'expert_13': 85.24995737502131, 'expert_14': 0.0, 'expert_15': 0.0}
{'coverage': '3876 out of9216', 'system_accuracy': 93.91276041666667, 'expert_accuracy': 94.40074552806196, 'classifier_accuracy': 93.24045167078297, 'alone_classifier': 87.61935763888889, 'validation_loss': 46.117920345730255, 'n_experts': 16, 'expert_0': 85.64472718018142, 'expert_1': 96.48426664106441, 'expert_2': 99.99600015999359, 'expert_3': 99.98000399920016, 'expert_4': 0.0, 'expert_5': 99.99500024998748, 'expert_6': 0.0, 'expert_7': 99.9985714489793, 'expert_8': 0.0, 'expert_9': 96.87439453503416, 'expert_10': 0.0, 'expert_11': 93.18837878597716, 'expert_12': 0.0, 'expert_13': 85.24995737502131, 'expert_14': 0.0, 'expert_15': 0.0}
n is 18
torch.Size([9216]) torch.Size([9216, 28]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 28]), expert_predictions (18, 9216)
Evaluate...
{'coverage': '4080 out of9216', 'system_accuracy': 93.39192708333333, 'expert_accuracy': 93.76946675352544, 'classifier_accuracy': 92.91666438929744, 'alone_classifier': 86.88151041666667, 'validation_loss': 53.37314224243164, 'n_experts': 18, 'expert_0': 80.28163360448337, 'expert_1': 0.0, 'expert_2': 99.98000399920016, 'expert_3': 95.42615574796018, 'expert_4': 0.0, 'expert_5': 99.99714293877317, 'expert_6': 0.0, 'expert_7': 94.1020961087859, 'expert_8': 0.0, 'expert_9': 86.02934850783198, 'expert_10': 0.0, 'expert_11': 0.0, 'expert_12': 0.0, 'expert_13': 92.23053021026054, 'expert_14': 88.62791381262947, 'expert_15': 99.46617447221095, 'expert_16': 99.31620536198108, 'expert_17': 91.89139518164767}
{'coverage': '4080 out of9216', 'system_accuracy': 93.44618055555556, 'expert_accuracy': 93.86681877465658, 'classifier_accuracy': 92.91666438929744, 'alone_classifier': 86.88151041666667, 'validation_loss': 53.38431167602539, 'n_experts': 18, 'expert_0': 79.22529632021386, 'expert_1': 0.0, 'expert_2': 99.98000399920016, 'expert_3': 95.21825562650494, 'expert_4': 0.0, 'expert_5': 99.99714293877317, 'expert_6': 0.0, 'expert_7': 94.54223687636676, 'expert_8': 0.0, 'expert_9': 87.49993566181202, 'expert_10': 0.0, 'expert_11': 0.0, 'expert_12': 99.98000399920016, 'expert_13': 91.97990376947179, 'expert_14': 88.50430444887407, 'expert_15': 99.55514242791061, 'expert_16': 99.31620536198108, 'expert_17': 91.89139518164767}
{'coverage': '4080 out of9216', 'system_accuracy': 93.44618055555556, 'expert_accuracy': 93.86681877465658, 'classifier_accuracy': 92.91666438929744, 'alone_classifier': 86.88151041666667, 'validation_loss': 53.38431167602539, 'n_experts': 18, 'expert_0': 79.22529632021386, 'expert_1': 0.0, 'expert_2': 99.98000399920016, 'expert_3': 95.21825562650494, 'expert_4': 0.0, 'expert_5': 99.99714293877317, 'expert_6': 0.0, 'expert_7': 94.54223687636676, 'expert_8': 0.0, 'expert_9': 87.49993566181202, 'expert_10': 0.0, 'expert_11': 0.0, 'expert_12': 99.98000399920016, 'expert_13': 91.97990376947179, 'expert_14': 88.50430444887407, 'expert_15': 99.55514242791061, 'expert_16': 99.31620536198108, 'expert_17': 91.89139518164767}
n is 20
torch.Size([9216]) torch.Size([9216, 30]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 30]), expert_predictions (20, 9216)
Evaluate...
{'coverage': '4107 out of9216', 'system_accuracy': 94.12977430555556, 'expert_accuracy': 94.34331202414123, 'classifier_accuracy': 93.86413211920788, 'alone_classifier': 87.59765625, 'validation_loss': 60.759202321370445, 'n_experts': 20, 'expert_0': 0.0, 'expert_1': 99.98000399920016, 'expert_2': 94.73667590056859, 'expert_3': 78.57030613848374, 'expert_4': 0.0, 'expert_5': 90.36122804523362, 'expert_6': 0.0, 'expert_7': 83.33194446759221, 'expert_8': 88.51845294929412, 'expert_9': 65.77172379634389, 'expert_10': 93.38157324062601, 'expert_11': 0.0, 'expert_12': 87.60676272926263, 'expert_13': 89.79555185489039, 'expert_14': 82.3519723297373, 'expert_15': 99.99500024998748, 'expert_16': 98.43543717459266, 'expert_17': 97.91098111616884, 'expert_18': 92.02117870087372, 'expert_19': 63.15756232861932}
{'coverage': '4107 out of9216', 'system_accuracy': 94.21657986111111, 'expert_accuracy': 94.49989843413981, 'classifier_accuracy': 93.86413211920788, 'alone_classifier': 87.59765625, 'validation_loss': 60.8769416809082, 'n_experts': 20, 'expert_0': 0.0, 'expert_1': 99.98000399920016, 'expert_2': 94.73667590056859, 'expert_3': 85.71306124198226, 'expert_4': 0.0, 'expert_5': 90.36122804523362, 'expert_6': 0.0, 'expert_7': 83.33194446759221, 'expert_8': 87.7777127572498, 'expert_9': 65.77172379634389, 'expert_10': 93.38157324062601, 'expert_11': 0.0, 'expert_12': 87.60676272926263, 'expert_13': 91.83635985159245, 'expert_14': 82.3519723297373, 'expert_15': 99.99500024998748, 'expert_16': 98.30505911210976, 'expert_17': 98.09263414235839, 'expert_18': 94.6807503396273, 'expert_19': 63.15756232861932}
{'coverage': '4107 out of9216', 'system_accuracy': 94.21657986111111, 'expert_accuracy': 94.49989843413981, 'classifier_accuracy': 93.86413211920788, 'alone_classifier': 87.59765625, 'validation_loss': 60.8769416809082, 'n_experts': 20, 'expert_0': 0.0, 'expert_1': 99.98000399920016, 'expert_2': 94.73667590056859, 'expert_3': 85.71306124198226, 'expert_4': 0.0, 'expert_5': 90.36122804523362, 'expert_6': 0.0, 'expert_7': 83.33194446759221, 'expert_8': 87.7777127572498, 'expert_9': 65.77172379634389, 'expert_10': 93.38157324062601, 'expert_11': 0.0, 'expert_12': 87.60676272926263, 'expert_13': 91.83635985159245, 'expert_14': 82.3519723297373, 'expert_15': 99.99500024998748, 'expert_16': 98.30505911210976, 'expert_17': 98.09263414235839, 'expert_18': 94.6807503396273, 'expert_19': 63.15756232861932}
