Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "cuDNN"
   Try: "module spider cuDNN" to see how to load the module(s).



cuda:0
cuda:0
{'batch_size': 1024, 'alpha': 1.0, 'epochs': 100, 'patience': 20, 'expert_type': 'predict', 'n_classes': 10, 'k': 5, 'n_experts': 10, 'lr': 0.1, 'weight_decay': 0.0005, 'warmup_epochs': 0, 'loss_type': 'ova', 'ckp_dir': './ova_increase_oracle_v2/', 'experiment_name': 'increase_oracles_v2'}
log is of type <class 'dict'>
type of S, type of idx  <class 'list'> <class 'list'>
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '4728 out of9216', 'system_accuracy': 46.76649305555556, 'expert_accuracy': 1.4928698086956411, 'classifier_accuracy': 89.74196087686208, 'alone_classifier': 87.87977430555556, 'validation_loss': 5.022093878851996, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 1.4928698086956411, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 0.0}
{'coverage': '4728 out of9216', 'system_accuracy': 46.76649305555556, 'expert_accuracy': 1.4928698086956411, 'classifier_accuracy': 89.74196087686208, 'alone_classifier': 87.87977430555556, 'validation_loss': 5.022093878851996, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 1.4928698086956411, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 0.0}
log is of type <class 'dict'>
type of S, type of idx  <class 'list'> <class 'list'>
/home/rverma/.conda/envs/defer/lib/python3.8/site-packages/torch/nn/functional.py:1944: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '5018 out of9216', 'system_accuracy': 44.921875, 'expert_accuracy': 1.0957598334559393, 'classifier_accuracy': 81.58628773243747, 'alone_classifier': 86.08940972222223, 'validation_loss': 4.986063215467665, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 1.0721943734956219, 'expert_5': 99.98000399920016, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 0.0}
{'coverage': '5018 out of9216', 'system_accuracy': 44.921875, 'expert_accuracy': 1.0957598334559393, 'classifier_accuracy': 81.58628773243747, 'alone_classifier': 86.08940972222223, 'validation_loss': 4.986063215467665, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 1.0721943734956219, 'expert_5': 99.98000399920016, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 0.0}
log is of type <class 'dict'>
type of S, type of idx  <class 'list'> <class 'list'>
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '4790 out of9216', 'system_accuracy': 46.419270833333336, 'expert_accuracy': 1.7623135218114088, 'classifier_accuracy': 87.68267040328453, 'alone_classifier': 87.14192708333333, 'validation_loss': 5.211440987057156, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 1.7623135218114088, 'expert_9': 0.0}
{'coverage': '4790 out of9216', 'system_accuracy': 46.419270833333336, 'expert_accuracy': 1.7623135218114088, 'classifier_accuracy': 87.68267040328453, 'alone_classifier': 87.14192708333333, 'validation_loss': 5.211440987057156, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 1.7623135218114088, 'expert_9': 0.0}
