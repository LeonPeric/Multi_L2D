Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "cuDNN"
   Try: "module spider cuDNN" to see how to load the module(s).



cuda:0
cuda:0
{'batch_size': 1024, 'alpha': 1.0, 'epochs': 100, 'patience': 20, 'expert_type': 'predict', 'n_classes': 10, 'k': 5, 'n_experts': 2, 'lr': 0.1, 'weight_decay': 0.0005, 'warmup_epochs': 0, 'loss_type': 'ova', 'ckp_dir': './ova_increase_experts/', 'experiment_name': 'multiple_experts'}
n is 1
Evaluate...
{'coverage': '4184 out of9216', 'system_accuracy': 93.17491319444444, 'expert_accuracy': 94.07789769165748, 'classifier_accuracy': 92.08890793286548, 'alone_classifier': 86.12196180555556, 'validation_loss': 1.4516045782301161, 'n_experts': 1, 'expert_0': 94.07789769165748}
/home/rverma/.conda/envs/defer/lib/python3.8/site-packages/torch/nn/functional.py:1944: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
{'coverage': '4184 out of9216', 'system_accuracy': 93.24001736111111, 'expert_accuracy': 94.1971345708611, 'classifier_accuracy': 92.08890793286548, 'alone_classifier': 86.12196180555556, 'validation_loss': 1.4460296895768907, 'n_experts': 1, 'expert_0': 94.1971345708611}
{'coverage': '4184 out of9216', 'system_accuracy': 93.24001736111111, 'expert_accuracy': 94.1971345708611, 'classifier_accuracy': 92.08890793286548, 'alone_classifier': 86.12196180555556, 'validation_loss': 1.4460296895768907, 'n_experts': 1, 'expert_0': 94.1971345708611}
n is 2
Evaluate...
{'coverage': '4568 out of9216', 'system_accuracy': 93.37022569444444, 'expert_accuracy': 94.87951398969388, 'classifier_accuracy': 91.83449886526928, 'alone_classifier': 87.01171875, 'validation_loss': 1.7912641631232367, 'n_experts': 2, 'expert_0': 92.27543805084575, 'expert_1': 96.33981891606321}
{'coverage': '4568 out of9216', 'system_accuracy': 93.53298611111111, 'expert_accuracy': 95.20223342503297, 'classifier_accuracy': 91.83449886526928, 'alone_classifier': 87.01171875, 'validation_loss': 1.7931117349200778, 'n_experts': 2, 'expert_0': 92.8143601419928, 'expert_1': 96.54129640421112}
{'coverage': '4568 out of9216', 'system_accuracy': 93.53298611111111, 'expert_accuracy': 95.20223342503297, 'classifier_accuracy': 91.83449886526928, 'alone_classifier': 87.01171875, 'validation_loss': 1.7931117349200778, 'n_experts': 2, 'expert_0': 92.8143601419928, 'expert_1': 96.54129640421112}
n is 4
Evaluate...
{'coverage': '3873 out of9216', 'system_accuracy': 94.03211805555556, 'expert_accuracy': 95.56428614769656, 'classifier_accuracy': 91.91840712836542, 'alone_classifier': 87.41319444444444, 'validation_loss': 2.490467972225613, 'n_experts': 4, 'expert_0': 95.66688587224876, 'expert_1': 99.99996497374258, 'expert_2': 98.23787103702334, 'expert_3': 81.35961343876603}
{'coverage': '3873 out of9216', 'system_accuracy': 94.06467013888889, 'expert_accuracy': 95.62043437692553, 'classifier_accuracy': 91.91840712836542, 'alone_classifier': 87.41319444444444, 'validation_loss': 2.4788110786014133, 'n_experts': 4, 'expert_0': 95.90385268084951, 'expert_1': 99.99996497374258, 'expert_2': 98.23787103702334, 'expert_3': 80.48242084104349}
{'coverage': '3873 out of9216', 'system_accuracy': 94.06467013888889, 'expert_accuracy': 95.62043437692553, 'classifier_accuracy': 91.91840712836542, 'alone_classifier': 87.41319444444444, 'validation_loss': 2.4788110786014133, 'n_experts': 4, 'expert_0': 95.90385268084951, 'expert_1': 99.99996497374258, 'expert_2': 98.23787103702334, 'expert_3': 80.48242084104349}
n is 6
Evaluate...
{'coverage': '3812 out of9216', 'system_accuracy': 93.54383680555556, 'expert_accuracy': 95.04070706733134, 'classifier_accuracy': 91.4218234149574, 'alone_classifier': 85.56857638888889, 'validation_loss': 3.456324153476291, 'n_experts': 6, 'expert_0': 85.4984377652944, 'expert_1': 94.6901816901047, 'expert_2': 98.54364148366918, 'expert_3': 94.068065214388, 'expert_4': 99.9900009999, 'expert_5': 98.59048982336947}
{'coverage': '3812 out of9216', 'system_accuracy': 93.63064236111111, 'expert_accuracy': 95.1887455518599, 'classifier_accuracy': 91.4218234149574, 'alone_classifier': 85.56857638888889, 'validation_loss': 3.432735284169515, 'n_experts': 6, 'expert_0': 86.10266700745196, 'expert_1': 94.2477042055715, 'expert_2': 98.54364148366918, 'expert_3': 94.26255466693326, 'expert_4': 99.9900009999, 'expert_5': 98.66467378862407}
{'coverage': '3812 out of9216', 'system_accuracy': 93.63064236111111, 'expert_accuracy': 95.1887455518599, 'classifier_accuracy': 91.4218234149574, 'alone_classifier': 85.56857638888889, 'validation_loss': 3.432735284169515, 'n_experts': 6, 'expert_0': 86.10266700745196, 'expert_1': 94.2477042055715, 'expert_2': 98.54364148366918, 'expert_3': 94.26255466693326, 'expert_4': 99.9900009999, 'expert_5': 98.66467378862407}
n is 8
Evaluate...
{'coverage': '3991 out of9216', 'system_accuracy': 93.29427083333333, 'expert_accuracy': 94.56458968173818, 'classifier_accuracy': 91.63116783685372, 'alone_classifier': 85.49262152777777, 'validation_loss': 4.18821922938029, 'n_experts': 8, 'expert_0': 76.5676062260025, 'expert_1': 0.0, 'expert_2': 89.02437354139333, 'expert_3': 70.58740485406054, 'expert_4': 0.0, 'expert_5': 97.72667375350542, 'expert_6': 0.0, 'expert_7': 72.72595043726479}
{'coverage': '3991 out of9216', 'system_accuracy': 93.21831597222223, 'expert_accuracy': 94.43061839500025, 'classifier_accuracy': 91.63116783685372, 'alone_classifier': 85.49262152777777, 'validation_loss': 4.203714185290867, 'n_experts': 8, 'expert_0': 74.58740951326105, 'expert_1': 0.0, 'expert_2': 88.7429477030117, 'expert_3': 70.58740485406054, 'expert_4': 0.0, 'expert_5': 97.72667375350542, 'expert_6': 0.0, 'expert_7': 90.90743804658098}
{'coverage': '3991 out of9216', 'system_accuracy': 93.21831597222223, 'expert_accuracy': 94.43061839500025, 'classifier_accuracy': 91.63116783685372, 'alone_classifier': 85.49262152777777, 'validation_loss': 4.203714185290867, 'n_experts': 8, 'expert_0': 74.58740951326105, 'expert_1': 0.0, 'expert_2': 88.7429477030117, 'expert_3': 70.58740485406054, 'expert_4': 0.0, 'expert_5': 97.72667375350542, 'expert_6': 0.0, 'expert_7': 90.90743804658098}
n is 10
Evaluate...
{'coverage': '3714 out of9216', 'system_accuracy': 93.04470486111111, 'expert_accuracy': 94.72918594223242, 'classifier_accuracy': 90.54927058294909, 'alone_classifier': 85.24305555555556, 'validation_loss': 5.023867183261448, 'n_experts': 10, 'expert_0': 94.2562314414635, 'expert_1': 99.04752471664312, 'expert_2': 49.99750012499374, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 96.73300062087867, 'expert_7': 91.76106161060127, 'expert_8': 0.0, 'expert_9': 99.99500024998748}
{'coverage': '3714 out of9216', 'system_accuracy': 93.12065972222223, 'expert_accuracy': 94.85641240071202, 'classifier_accuracy': 90.54927058294909, 'alone_classifier': 85.24305555555556, 'validation_loss': 4.995986302693685, 'n_experts': 10, 'expert_0': 94.2562314414635, 'expert_1': 99.04752471664312, 'expert_2': 49.99750012499374, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 96.92075877425769, 'expert_7': 91.86404821173551, 'expert_8': 0.0, 'expert_9': 99.99500024998748}
{'coverage': '3714 out of9216', 'system_accuracy': 93.12065972222223, 'expert_accuracy': 94.85641240071202, 'classifier_accuracy': 90.54927058294909, 'alone_classifier': 85.24305555555556, 'validation_loss': 4.995986302693685, 'n_experts': 10, 'expert_0': 94.2562314414635, 'expert_1': 99.04752471664312, 'expert_2': 49.99750012499374, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 96.92075877425769, 'expert_7': 91.86404821173551, 'expert_8': 0.0, 'expert_9': 99.99500024998748}
n is 12
Evaluate...
{'coverage': '3691 out of9216', 'system_accuracy': 94.04296875, 'expert_accuracy': 95.131218275793, 'classifier_accuracy': 92.41397744746742, 'alone_classifier': 85.85069444444444, 'validation_loss': 5.670978281233046, 'n_experts': 12, 'expert_0': 95.99998400000267, 'expert_1': 96.96966023876507, 'expert_2': 0.0, 'expert_3': 92.45521932091577, 'expert_4': 44.44345681207084, 'expert_5': 0.0, 'expert_6': 72.03059614513705, 'expert_7': 99.9990000099999, 'expert_8': 76.92248521165222, 'expert_9': 98.0051953161149, 'expert_10': 93.58950361665738, 'expert_11': 96.50787523309509}
{'coverage': '3691 out of9216', 'system_accuracy': 94.07552083333333, 'expert_accuracy': 95.18551691636137, 'classifier_accuracy': 92.41397744746742, 'alone_classifier': 85.85069444444444, 'validation_loss': 5.697606563568115, 'n_experts': 12, 'expert_0': 96.4166505972249, 'expert_1': 97.34844797407274, 'expert_2': 0.0, 'expert_3': 92.07158770547629, 'expert_4': 55.554321015088554, 'expert_5': 0.0, 'expert_6': 70.88117173856571, 'expert_7': 99.9990000099999, 'expert_8': 76.92248521165222, 'expert_9': 97.9184650547732, 'expert_10': 93.58950361665738, 'expert_11': 97.4602555807901}
{'coverage': '3691 out of9216', 'system_accuracy': 94.07552083333333, 'expert_accuracy': 95.18551691636137, 'classifier_accuracy': 92.41397744746742, 'alone_classifier': 85.85069444444444, 'validation_loss': 5.697606563568115, 'n_experts': 12, 'expert_0': 96.4166505972249, 'expert_1': 97.34844797407274, 'expert_2': 0.0, 'expert_3': 92.07158770547629, 'expert_4': 55.554321015088554, 'expert_5': 0.0, 'expert_6': 70.88117173856571, 'expert_7': 99.9990000099999, 'expert_8': 76.92248521165222, 'expert_9': 97.9184650547732, 'expert_10': 93.58950361665738, 'expert_11': 97.4602555807901}
n is 16
Evaluate...
{'coverage': '3675 out of9216', 'system_accuracy': 93.02300347222223, 'expert_accuracy': 94.09853477355946, 'classifier_accuracy': 91.4013580571059, 'alone_classifier': 83.60460069444444, 'validation_loss': 7.8118175400627985, 'n_experts': 16, 'expert_0': 97.11979329037021, 'expert_1': 94.28517551328278, 'expert_2': 91.66513891435143, 'expert_3': 82.0338426889202, 'expert_4': 91.98603066688828, 'expert_5': 99.99714293877317, 'expert_6': 97.0012911341211, 'expert_7': 99.99846156212982, 'expert_8': 99.9977778271594, 'expert_9': 74.35878369542641, 'expert_10': 0.0, 'expert_11': 74.03831915707853, 'expert_12': 0.0, 'expert_13': 76.72951149087328, 'expert_14': 97.86800043289333, 'expert_15': 98.44629987392659}
{'coverage': '3675 out of9216', 'system_accuracy': 92.89279513888889, 'expert_accuracy': 93.88196737477107, 'classifier_accuracy': 91.4013580571059, 'alone_classifier': 83.60460069444444, 'validation_loss': 7.864311854044597, 'n_experts': 16, 'expert_0': 97.0045859436438, 'expert_1': 94.28517551328278, 'expert_2': 91.66513891435143, 'expert_3': 81.69485986789161, 'expert_4': 92.16024663406041, 'expert_5': 99.99714293877317, 'expert_6': 96.67534593541774, 'expert_7': 99.99846156212982, 'expert_8': 99.9977778271594, 'expert_9': 73.07673570067769, 'expert_10': 0.0, 'expert_11': 75.96139238193773, 'expert_12': 0.0, 'expert_13': 74.21378980264792, 'expert_14': 98.07104607694497, 'expert_15': 98.30505697597262}
{'coverage': '3675 out of9216', 'system_accuracy': 92.89279513888889, 'expert_accuracy': 93.88196737477107, 'classifier_accuracy': 91.4013580571059, 'alone_classifier': 83.60460069444444, 'validation_loss': 7.864311854044597, 'n_experts': 16, 'expert_0': 97.0045859436438, 'expert_1': 94.28517551328278, 'expert_2': 91.66513891435143, 'expert_3': 81.69485986789161, 'expert_4': 92.16024663406041, 'expert_5': 99.99714293877317, 'expert_6': 96.67534593541774, 'expert_7': 99.99846156212982, 'expert_8': 99.9977778271594, 'expert_9': 73.07673570067769, 'expert_10': 0.0, 'expert_11': 75.96139238193773, 'expert_12': 0.0, 'expert_13': 74.21378980264792, 'expert_14': 98.07104607694497, 'expert_15': 98.30505697597262}
n is 18
Evaluate...
{'coverage': '3842 out of9216', 'system_accuracy': 92.23090277777777, 'expert_accuracy': 94.157048970709, 'classifier_accuracy': 89.5366973051354, 'alone_classifier': 82.58463541666667, 'validation_loss': 8.493695471021864, 'n_experts': 18, 'expert_0': 0.0, 'expert_1': 99.9900009999, 'expert_2': 0.0, 'expert_3': 92.04256542903543, 'expert_4': 98.82341314892571, 'expert_5': 72.67433409961151, 'expert_6': 97.77756049431001, 'expert_7': 99.99333377774815, 'expert_8': 97.85571233695427, 'expert_9': 78.12451172180174, 'expert_10': 98.70104233495496, 'expert_11': 99.99991666673611, 'expert_12': 49.99500049995, 'expert_13': 98.18938769097836, 'expert_14': 0.0, 'expert_15': 0.0, 'expert_16': 99.64847112531771, 'expert_17': 91.26689021724718}
{'coverage': '3842 out of9216', 'system_accuracy': 92.23090277777777, 'expert_accuracy': 94.157048970709, 'classifier_accuracy': 89.5366973051354, 'alone_classifier': 82.58463541666667, 'validation_loss': 8.451982975006104, 'n_experts': 18, 'expert_0': 0.0, 'expert_1': 99.9900009999, 'expert_2': 0.0, 'expert_3': 92.04256542903543, 'expert_4': 97.64694394477182, 'expert_5': 71.51154475401772, 'expert_6': 97.77756049431001, 'expert_7': 99.99333377774815, 'expert_8': 97.85571233695427, 'expert_9': 78.12451172180174, 'expert_10': 99.9997402604149, 'expert_11': 99.99991666673611, 'expert_12': 99.9900009999, 'expert_13': 98.18938769097836, 'expert_14': 0.0, 'expert_15': 0.0, 'expert_16': 99.47272426266284, 'expert_17': 91.63589381650829}
{'coverage': '3842 out of9216', 'system_accuracy': 92.23090277777777, 'expert_accuracy': 94.157048970709, 'classifier_accuracy': 89.5366973051354, 'alone_classifier': 82.58463541666667, 'validation_loss': 8.451982975006104, 'n_experts': 18, 'expert_0': 0.0, 'expert_1': 99.9900009999, 'expert_2': 0.0, 'expert_3': 92.04256542903543, 'expert_4': 97.64694394477182, 'expert_5': 71.51154475401772, 'expert_6': 97.77756049431001, 'expert_7': 99.99333377774815, 'expert_8': 97.85571233695427, 'expert_9': 78.12451172180174, 'expert_10': 99.9997402604149, 'expert_11': 99.99991666673611, 'expert_12': 99.9900009999, 'expert_13': 98.18938769097836, 'expert_14': 0.0, 'expert_15': 0.0, 'expert_16': 99.47272426266284, 'expert_17': 91.63589381650829}
n is 20
Evaluate...
{'coverage': '3622 out of9216', 'system_accuracy': 93.27256944444444, 'expert_accuracy': 94.65498410243174, 'classifier_accuracy': 91.13749058151599, 'alone_classifier': 83.91927083333333, 'validation_loss': 9.337837325202095, 'n_experts': 20, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 97.77766913592318, 'expert_3': 89.99910000899992, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 98.85242660576178, 'expert_8': 0.0, 'expert_9': 99.65628889602138, 'expert_10': 81.23484715863266, 'expert_11': 0.0, 'expert_12': 0.0, 'expert_13': 0.0, 'expert_14': 0.0, 'expert_15': 99.98000399920016, 'expert_16': 99.3630320094186, 'expert_17': 94.01706723160478, 'expert_18': 98.49052887149855, 'expert_19': 95.45177738607916}
{'coverage': '3622 out of9216', 'system_accuracy': 93.32682291666667, 'expert_accuracy': 94.74436557939343, 'classifier_accuracy': 91.13749058151599, 'alone_classifier': 83.91927083333333, 'validation_loss': 9.347178671095106, 'n_experts': 20, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 97.77766913592318, 'expert_3': 84.99915000849991, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 98.85242660576178, 'expert_8': 0.0, 'expert_9': 99.65628889602138, 'expert_10': 81.4769778506107, 'expert_11': 0.0, 'expert_12': 0.0, 'expert_13': 0.0, 'expert_14': 0.0, 'expert_15': 99.98000399920016, 'expert_16': 99.3630320094186, 'expert_17': 94.58686763906906, 'expert_18': 98.67920804558187, 'expert_19': 95.3911345796077}
{'coverage': '3622 out of9216', 'system_accuracy': 93.32682291666667, 'expert_accuracy': 94.74436557939343, 'classifier_accuracy': 91.13749058151599, 'alone_classifier': 83.91927083333333, 'validation_loss': 9.347178671095106, 'n_experts': 20, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 97.77766913592318, 'expert_3': 84.99915000849991, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 98.85242660576178, 'expert_8': 0.0, 'expert_9': 99.65628889602138, 'expert_10': 81.4769778506107, 'expert_11': 0.0, 'expert_12': 0.0, 'expert_13': 0.0, 'expert_14': 0.0, 'expert_15': 99.98000399920016, 'expert_16': 99.3630320094186, 'expert_17': 94.58686763906906, 'expert_18': 98.67920804558187, 'expert_19': 95.3911345796077}
