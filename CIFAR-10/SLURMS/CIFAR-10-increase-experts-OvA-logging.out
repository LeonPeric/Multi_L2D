Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "cuDNN"
   Try: "module spider cuDNN" to see how to load the module(s).



cuda:0
cuda:0
{'batch_size': 1024, 'alpha': 1.0, 'epochs': 100, 'patience': 20, 'expert_type': 'predict', 'n_classes': 10, 'k': 5, 'n_experts': 2, 'lr': 0.1, 'weight_decay': 0.0005, 'warmup_epochs': 0, 'loss_type': 'ova', 'ckp_dir': './ova_increase_experts/', 'experiment_name': 'multiple_experts'}
n is 1
torch.Size([9216]) torch.Size([9216, 11]) [torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 11]), expert_predictions (1, 9216)
Evaluate...
{'coverage': '4184 out of9216', 'system_accuracy': 93.21831597222223, 'expert_accuracy': 94.1573889444599, 'classifier_accuracy': 92.08890793286548, 'alone_classifier': 86.12196180555556, 'validation_loss': 1.4449850983089871, 'n_experts': 1, 'expert_0': 94.1573889444599}
/home/rverma/.conda/envs/defer/lib/python3.8/site-packages/torch/nn/functional.py:1944: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
{'coverage': '4184 out of9216', 'system_accuracy': 93.1640625, 'expert_accuracy': 94.05802487845688, 'classifier_accuracy': 92.08890793286548, 'alone_classifier': 86.12196180555556, 'validation_loss': 1.4487247069676716, 'n_experts': 1, 'expert_0': 94.05802487845688}
{'coverage': '4184 out of9216', 'system_accuracy': 93.1640625, 'expert_accuracy': 94.05802487845688, 'classifier_accuracy': 92.08890793286548, 'alone_classifier': 86.12196180555556, 'validation_loss': 1.4487247069676716, 'n_experts': 1, 'expert_0': 94.05802487845688}
n is 2
torch.Size([9216]) torch.Size([9216, 12]) [torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 12]), expert_predictions (2, 9216)
Evaluate...
{'coverage': '4568 out of9216', 'system_accuracy': 93.44618055555556, 'expert_accuracy': 95.03011639285212, 'classifier_accuracy': 91.83449886526928, 'alone_classifier': 87.01171875, 'validation_loss': 1.7958289252387152, 'n_experts': 2, 'expert_0': 92.75447990964312, 'expert_1': 96.30623933470521}
{'coverage': '4568 out of9216', 'system_accuracy': 93.44618055555556, 'expert_accuracy': 95.03011639285212, 'classifier_accuracy': 91.83449886526928, 'alone_classifier': 87.01171875, 'validation_loss': 1.8009579711490207, 'n_experts': 2, 'expert_0': 92.39519851554509, 'expert_1': 96.50771682285314}
{'coverage': '4568 out of9216', 'system_accuracy': 93.44618055555556, 'expert_accuracy': 95.03011639285212, 'classifier_accuracy': 91.83449886526928, 'alone_classifier': 87.01171875, 'validation_loss': 1.8009579711490207, 'n_experts': 2, 'expert_0': 92.39519851554509, 'expert_1': 96.50771682285314}
n is 4
torch.Size([9216]) torch.Size([9216, 14]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 14]), expert_predictions (4, 9216)
Evaluate...
{'coverage': '3873 out of9216', 'system_accuracy': 94.06467013888889, 'expert_accuracy': 95.62043437692553, 'classifier_accuracy': 91.91840712836542, 'alone_classifier': 87.41319444444444, 'validation_loss': 2.497360520892673, 'n_experts': 4, 'expert_0': 95.7684430759348, 'expert_1': 99.99996497374258, 'expert_2': 98.23787103702334, 'expert_3': 81.35961343876603}
{'coverage': '3873 out of9216', 'system_accuracy': 93.97786458333333, 'expert_accuracy': 95.47070576564829, 'classifier_accuracy': 91.91840712836542, 'alone_classifier': 87.41319444444444, 'validation_loss': 2.495526419745551, 'n_experts': 4, 'expert_0': 95.66688587224876, 'expert_1': 99.99996497374258, 'expert_2': 98.16444960874455, 'expert_3': 80.48242084104349}
{'coverage': '3873 out of9216', 'system_accuracy': 93.97786458333333, 'expert_accuracy': 95.47070576564829, 'classifier_accuracy': 91.91840712836542, 'alone_classifier': 87.41319444444444, 'validation_loss': 2.495526419745551, 'n_experts': 4, 'expert_0': 95.66688587224876, 'expert_1': 99.99996497374258, 'expert_2': 98.16444960874455, 'expert_3': 80.48242084104349}
n is 6
torch.Size([9216]) torch.Size([9216, 16]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 16]), expert_predictions (6, 9216)
Evaluate...
{'coverage': '3812 out of9216', 'system_accuracy': 93.53298611111111, 'expert_accuracy': 95.02220225676527, 'classifier_accuracy': 91.4218234149574, 'alone_classifier': 85.56857638888889, 'validation_loss': 3.4438385698530407, 'n_experts': 6, 'expert_0': 85.19632314421563, 'expert_1': 94.6901816901047, 'expert_2': 99.0290781412242, 'expert_3': 94.03565030563045, 'expert_4': 99.9900009999, 'expert_5': 98.51630585811486}
{'coverage': '3812 out of9216', 'system_accuracy': 93.64149305555556, 'expert_accuracy': 95.20725036242597, 'classifier_accuracy': 91.4218234149574, 'alone_classifier': 85.56857638888889, 'validation_loss': 3.4425903956095376, 'n_experts': 6, 'expert_0': 85.4984377652944, 'expert_1': 95.5751366591711, 'expert_2': 98.54364148366918, 'expert_3': 94.23013975817571, 'expert_4': 99.9900009999, 'expert_5': 98.73885775387868}
{'coverage': '3812 out of9216', 'system_accuracy': 93.64149305555556, 'expert_accuracy': 95.20725036242597, 'classifier_accuracy': 91.4218234149574, 'alone_classifier': 85.56857638888889, 'validation_loss': 3.4425903956095376, 'n_experts': 6, 'expert_0': 85.4984377652944, 'expert_1': 95.5751366591711, 'expert_2': 98.54364148366918, 'expert_3': 94.23013975817571, 'expert_4': 99.9900009999, 'expert_5': 98.73885775387868}
n is 8
torch.Size([9216]) torch.Size([9216, 18]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 18]), expert_predictions (8, 9216)
Evaluate...
{'coverage': '3991 out of9216', 'system_accuracy': 93.18576388888889, 'expert_accuracy': 94.37320212925542, 'classifier_accuracy': 91.63116783685372, 'alone_classifier': 85.49262152777777, 'validation_loss': 4.17628812789917, 'n_experts': 8, 'expert_0': 74.58740951326105, 'expert_1': 0.0, 'expert_2': 88.46152186463004, 'expert_3': 70.58740485406054, 'expert_4': 0.0, 'expert_5': 97.77893400684954, 'expert_6': 0.0, 'expert_7': 72.72595043726479}
{'coverage': '3991 out of9216', 'system_accuracy': 93.359375, 'expert_accuracy': 94.67942221322785, 'classifier_accuracy': 91.63116783685372, 'alone_classifier': 85.49262152777777, 'validation_loss': 4.229767137103611, 'n_experts': 8, 'expert_0': 76.89763901145939, 'expert_1': 0.0, 'expert_2': 89.2119907669811, 'expert_3': 76.46968859189892, 'expert_4': 0.0, 'expert_5': 97.77893400684954, 'expert_6': 0.0, 'expert_7': 72.72595043726479}
{'coverage': '3991 out of9216', 'system_accuracy': 93.359375, 'expert_accuracy': 94.67942221322785, 'classifier_accuracy': 91.63116783685372, 'alone_classifier': 85.49262152777777, 'validation_loss': 4.229767137103611, 'n_experts': 8, 'expert_0': 76.89763901145939, 'expert_1': 0.0, 'expert_2': 89.2119907669811, 'expert_3': 76.46968859189892, 'expert_4': 0.0, 'expert_5': 97.77893400684954, 'expert_6': 0.0, 'expert_7': 72.72595043726479}
n is 10
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '3714 out of9216', 'system_accuracy': 93.15321180555556, 'expert_accuracy': 94.9109380257747, 'classifier_accuracy': 90.54927058294909, 'alone_classifier': 85.24305555555556, 'validation_loss': 5.007976637946235, 'n_experts': 10, 'expert_0': 94.2562314414635, 'expert_1': 99.04752471664312, 'expert_2': 49.99750012499374, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 96.9583104049335, 'expert_7': 91.96703481286974, 'expert_8': 0.0, 'expert_9': 99.99500024998748}
{'coverage': '3714 out of9216', 'system_accuracy': 93.15321180555556, 'expert_accuracy': 94.9109380257747, 'classifier_accuracy': 90.54927058294909, 'alone_classifier': 85.24305555555556, 'validation_loss': 5.022244877285427, 'n_experts': 10, 'expert_0': 94.69805752634537, 'expert_1': 99.04752471664312, 'expert_2': 49.99750012499374, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 97.10851692763673, 'expert_7': 91.60658170889992, 'expert_8': 0.0, 'expert_9': 99.99500024998748}
{'coverage': '3714 out of9216', 'system_accuracy': 93.15321180555556, 'expert_accuracy': 94.9109380257747, 'classifier_accuracy': 90.54927058294909, 'alone_classifier': 85.24305555555556, 'validation_loss': 5.022244877285427, 'n_experts': 10, 'expert_0': 94.69805752634537, 'expert_1': 99.04752471664312, 'expert_2': 49.99750012499374, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 97.10851692763673, 'expert_7': 91.60658170889992, 'expert_8': 0.0, 'expert_9': 99.99500024998748}
n is 12
torch.Size([9216]) torch.Size([9216, 22]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 22]), expert_predictions (12, 9216)
Evaluate...
{'coverage': '3691 out of9216', 'system_accuracy': 94.140625, 'expert_accuracy': 95.29411419749812, 'classifier_accuracy': 92.41397744746742, 'alone_classifier': 85.85069444444444, 'validation_loss': 5.621125009324816, 'n_experts': 12, 'expert_0': 96.5833172361138, 'expert_1': 96.59087250345739, 'expert_2': 0.0, 'expert_3': 92.07158770547629, 'expert_4': 55.554321015088554, 'expert_5': 0.0, 'expert_6': 73.94630348942262, 'expert_7': 99.9990000099999, 'expert_8': 76.92248521165222, 'expert_9': 98.0051953161149, 'expert_10': 93.58950361665738, 'expert_11': 96.82533534899343}
{'coverage': '3691 out of9216', 'system_accuracy': 94.09722222222223, 'expert_accuracy': 95.22171601007362, 'classifier_accuracy': 92.41397744746742, 'alone_classifier': 85.85069444444444, 'validation_loss': 5.67480108473036, 'n_experts': 12, 'expert_0': 95.99998400000267, 'expert_1': 96.59087250345739, 'expert_2': 0.0, 'expert_3': 92.32734211576928, 'expert_4': 44.44345681207084, 'expert_5': 0.0, 'expert_6': 72.79687908285128, 'expert_7': 99.9990000099999, 'expert_8': 80.76860947223483, 'expert_9': 98.13529070812743, 'expert_10': 94.87155161140612, 'expert_11': 96.82533534899343}
{'coverage': '3691 out of9216', 'system_accuracy': 94.09722222222223, 'expert_accuracy': 95.22171601007362, 'classifier_accuracy': 92.41397744746742, 'alone_classifier': 85.85069444444444, 'validation_loss': 5.67480108473036, 'n_experts': 12, 'expert_0': 95.99998400000267, 'expert_1': 96.59087250345739, 'expert_2': 0.0, 'expert_3': 92.32734211576928, 'expert_4': 44.44345681207084, 'expert_5': 0.0, 'expert_6': 72.79687908285128, 'expert_7': 99.9990000099999, 'expert_8': 80.76860947223483, 'expert_9': 98.13529070812743, 'expert_10': 94.87155161140612, 'expert_11': 96.82533534899343}
n is 16
torch.Size([9216]) torch.Size([9216, 26]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 26]), expert_predictions (16, 9216)
Evaluate...
{'coverage': '3675 out of9216', 'system_accuracy': 93.00130208333333, 'expert_accuracy': 94.06244020709474, 'classifier_accuracy': 91.4013580571059, 'alone_classifier': 83.60460069444444, 'validation_loss': 7.846824751959907, 'n_experts': 16, 'expert_0': 97.0045859436438, 'expert_1': 97.14230204398832, 'expert_2': 91.66513891435143, 'expert_3': 81.35587704686301, 'expert_4': 92.33446260123254, 'expert_5': 99.99714293877317, 'expert_6': 96.93610209438043, 'expert_7': 99.99846156212982, 'expert_8': 99.9977778271594, 'expert_9': 74.35878369542641, 'expert_10': 0.0, 'expert_11': 74.03831915707853, 'expert_12': 0.0, 'expert_13': 76.4150462798451, 'expert_14': 97.96952325491914, 'expert_15': 98.30505697597262}
{'coverage': '3675 out of9216', 'system_accuracy': 93.01215277777777, 'expert_accuracy': 94.0804874903271, 'classifier_accuracy': 91.4013580571059, 'alone_classifier': 83.60460069444444, 'validation_loss': 7.813734637366401, 'n_experts': 16, 'expert_0': 97.11979329037021, 'expert_1': 99.99942857469387, 'expert_2': 91.66513891435143, 'expert_3': 82.7118083309774, 'expert_4': 91.81181469971614, 'expert_5': 99.99714293877317, 'expert_6': 96.80572401489908, 'expert_7': 99.99846156212982, 'expert_8': 99.9977778271594, 'expert_9': 78.20492767967261, 'expert_10': 0.0, 'expert_11': 73.07678254464895, 'expert_12': 0.0, 'expert_13': 75.4716506467606, 'expert_14': 97.96952325491914, 'expert_15': 98.44629987392659}
{'coverage': '3675 out of9216', 'system_accuracy': 93.01215277777777, 'expert_accuracy': 94.0804874903271, 'classifier_accuracy': 91.4013580571059, 'alone_classifier': 83.60460069444444, 'validation_loss': 7.813734637366401, 'n_experts': 16, 'expert_0': 97.11979329037021, 'expert_1': 99.99942857469387, 'expert_2': 91.66513891435143, 'expert_3': 82.7118083309774, 'expert_4': 91.81181469971614, 'expert_5': 99.99714293877317, 'expert_6': 96.80572401489908, 'expert_7': 99.99846156212982, 'expert_8': 99.9977778271594, 'expert_9': 78.20492767967261, 'expert_10': 0.0, 'expert_11': 73.07678254464895, 'expert_12': 0.0, 'expert_13': 75.4716506467606, 'expert_14': 97.96952325491914, 'expert_15': 98.44629987392659}
n is 18
torch.Size([9216]) torch.Size([9216, 28]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 28]), expert_predictions (18, 9216)
Evaluate...
{'coverage': '3842 out of9216', 'system_accuracy': 92.30685763888889, 'expert_accuracy': 94.28730575782262, 'classifier_accuracy': 89.5366973051354, 'alone_classifier': 82.58463541666667, 'validation_loss': 8.438026958041721, 'n_experts': 18, 'expert_0': 0.0, 'expert_1': 99.9900009999, 'expert_2': 0.0, 'expert_3': 92.34667082142212, 'expert_4': 97.64694394477182, 'expert_5': 74.99991279079907, 'expert_6': 98.8886691362908, 'expert_7': 99.99333377774815, 'expert_8': 98.24557573271902, 'expert_9': 78.12451172180174, 'expert_10': 98.70104233495496, 'expert_11': 99.99991666673611, 'expert_12': 49.99500049995, 'expert_13': 98.05011196375712, 'expert_14': 0.0, 'expert_15': 0.0, 'expert_16': 99.64847112531771, 'expert_17': 90.89788661798607}
{'coverage': '3842 out of9216', 'system_accuracy': 92.25260416666667, 'expert_accuracy': 94.1942651955986, 'classifier_accuracy': 89.5366973051354, 'alone_classifier': 82.58463541666667, 'validation_loss': 8.451766120062935, 'n_experts': 18, 'expert_0': 0.0, 'expert_1': 99.9900009999, 'expert_2': 0.0, 'expert_3': 92.19461812522877, 'expert_4': 97.64694394477182, 'expert_5': 71.51154475401772, 'expert_6': 97.77756049431001, 'expert_7': 99.99333377774815, 'expert_8': 97.85571233695427, 'expert_9': 81.2494921906738, 'expert_10': 98.70104233495496, 'expert_11': 99.99991666673611, 'expert_12': 49.99500049995, 'expert_13': 97.91083623653587, 'expert_14': 0.0, 'expert_15': 0.0, 'expert_16': 99.47272426266284, 'expert_17': 91.88189621601569}
{'coverage': '3842 out of9216', 'system_accuracy': 92.25260416666667, 'expert_accuracy': 94.1942651955986, 'classifier_accuracy': 89.5366973051354, 'alone_classifier': 82.58463541666667, 'validation_loss': 8.451766120062935, 'n_experts': 18, 'expert_0': 0.0, 'expert_1': 99.9900009999, 'expert_2': 0.0, 'expert_3': 92.19461812522877, 'expert_4': 97.64694394477182, 'expert_5': 71.51154475401772, 'expert_6': 97.77756049431001, 'expert_7': 99.99333377774815, 'expert_8': 97.85571233695427, 'expert_9': 81.2494921906738, 'expert_10': 98.70104233495496, 'expert_11': 99.99991666673611, 'expert_12': 49.99500049995, 'expert_13': 97.91083623653587, 'expert_14': 0.0, 'expert_15': 0.0, 'expert_16': 99.47272426266284, 'expert_17': 91.88189621601569}
n is 20
torch.Size([9216]) torch.Size([9216, 30]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 30]), expert_predictions (20, 9216)
Evaluate...
{'coverage': '3622 out of9216', 'system_accuracy': 93.18576388888889, 'expert_accuracy': 94.51197373929303, 'classifier_accuracy': 91.13749058151599, 'alone_classifier': 83.91927083333333, 'validation_loss': 9.347182697719997, 'n_experts': 20, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 97.22211419765088, 'expert_3': 89.99910000899992, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 98.52455786080071, 'expert_8': 0.0, 'expert_9': 99.65628889602138, 'expert_10': 80.62952042868756, 'expert_11': 0.0, 'expert_12': 0.0, 'expert_13': 0.0, 'expert_14': 0.0, 'expert_15': 99.98000399920016, 'expert_16': 99.49042051199478, 'expert_17': 94.01706723160478, 'expert_18': 98.67920804558187, 'expert_19': 95.33049177313623}
{'coverage': '3622 out of9216', 'system_accuracy': 93.42447916666667, 'expert_accuracy': 94.90525223792447, 'classifier_accuracy': 91.13749058151599, 'alone_classifier': 83.91927083333333, 'validation_loss': 9.402358055114746, 'n_experts': 20, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 98.33322407419547, 'expert_3': 89.99910000899992, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 99.0163609782423, 'expert_8': 0.0, 'expert_9': 99.65628889602138, 'expert_10': 81.84017388857775, 'expert_11': 0.0, 'expert_12': 0.0, 'expert_13': 0.0, 'expert_14': 0.0, 'expert_15': 99.98000399920016, 'expert_16': 99.3630320094186, 'expert_17': 94.87176784280119, 'expert_18': 98.8678872196652, 'expert_19': 95.3911345796077}
{'coverage': '3622 out of9216', 'system_accuracy': 93.42447916666667, 'expert_accuracy': 94.90525223792447, 'classifier_accuracy': 91.13749058151599, 'alone_classifier': 83.91927083333333, 'validation_loss': 9.402358055114746, 'n_experts': 20, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 98.33322407419547, 'expert_3': 89.99910000899992, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 99.0163609782423, 'expert_8': 0.0, 'expert_9': 99.65628889602138, 'expert_10': 81.84017388857775, 'expert_11': 0.0, 'expert_12': 0.0, 'expert_13': 0.0, 'expert_14': 0.0, 'expert_15': 99.98000399920016, 'expert_16': 99.3630320094186, 'expert_17': 94.87176784280119, 'expert_18': 98.8678872196652, 'expert_19': 95.3911345796077}
