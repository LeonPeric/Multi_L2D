Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "cuDNN"
   Try: "module spider cuDNN" to see how to load the module(s).



cuda:0
cuda:0
{'batch_size': 1024, 'alpha': 1.0, 'epochs': 100, 'patience': 20, 'expert_type': 'predict', 'n_classes': 10, 'k': 5, 'n_experts': 10, 'lr': 0.1, 'weight_decay': 0.0005, 'warmup_epochs': 0, 'loss_type': 'softmax', 'ckp_dir': './softmax_increase_oracle/', 'experiment_name': 'increase_oracles'}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '9043 out of9216', 'system_accuracy': 86.04600694444444, 'expert_accuracy': 14.45085034583775, 'classifier_accuracy': 87.41567967028996, 'alone_classifier': 86.78385416666667, 'validation_loss': 10.631262991163466, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 28.570612268220906, 'expert_6': 12.499687507812306, 'expert_7': 99.98000399920016, 'expert_8': 0.0, 'expert_9': 13.815771295037768}
{'coverage': '9043 out of9216', 'system_accuracy': 86.04600694444444, 'expert_accuracy': 14.45085034583775, 'classifier_accuracy': 87.41567967028996, 'alone_classifier': 86.78385416666667, 'validation_loss': 10.631262991163466, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 28.570612268220906, 'expert_6': 12.499687507812306, 'expert_7': 99.98000399920016, 'expert_8': 0.0, 'expert_9': 13.815771295037768}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '7738 out of9216', 'system_accuracy': 75.35807291666667, 'expert_accuracy': 16.102839498939176, 'classifier_accuracy': 86.67614258624783, 'alone_classifier': 86.67534722222223, 'validation_loss': 10.93326081169976, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 14.285306134110453, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 16.666481483539073, 'expert_8': 16.08442269513498, 'expert_9': 17.33328711123437}
{'coverage': '7738 out of9216', 'system_accuracy': 75.35807291666667, 'expert_accuracy': 16.102839498939176, 'classifier_accuracy': 86.67614258624783, 'alone_classifier': 86.67534722222223, 'validation_loss': 10.93326081169976, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 14.285306134110453, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 16.666481483539073, 'expert_8': 16.08442269513498, 'expert_9': 17.33328711123437}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '7531 out of9216', 'system_accuracy': 73.74131944444444, 'expert_accuracy': 15.074182187040691, 'classifier_accuracy': 86.86761270923367, 'alone_classifier': 84.53776041666667, 'validation_loss': 11.384410752190483, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 14.9209456677973, 'expert_8': 14.989286942489532, 'expert_9': 16.17645472896595}
{'coverage': '7531 out of9216', 'system_accuracy': 73.74131944444444, 'expert_accuracy': 15.074182187040691, 'classifier_accuracy': 86.86761270923367, 'alone_classifier': 84.53776041666667, 'validation_loss': 11.384410752190483, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 14.9209456677973, 'expert_8': 14.989286942489532, 'expert_9': 16.17645472896595}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '5970 out of9216', 'system_accuracy': 63.650173611111114, 'expert_accuracy': 15.5576084068017, 'classifier_accuracy': 89.79899347070362, 'alone_classifier': 87.64105902777777, 'validation_loss': 11.820760091145834, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 99.98000399920016, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 11.110987655692714, 'expert_7': 22.11979528129467, 'expert_8': 12.993628918009055, 'expert_9': 17.4094683273721}
{'coverage': '5970 out of9216', 'system_accuracy': 63.650173611111114, 'expert_accuracy': 15.5576084068017, 'classifier_accuracy': 89.79899347070362, 'alone_classifier': 87.64105902777777, 'validation_loss': 11.820760091145834, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 99.98000399920016, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 11.110987655692714, 'expert_7': 22.11979528129467, 'expert_8': 12.993628918009055, 'expert_9': 17.4094683273721}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '5226 out of9216', 'system_accuracy': 58.908420138888886, 'expert_accuracy': 15.864660858914243, 'classifier_accuracy': 91.77190792629338, 'alone_classifier': 85.57942708333333, 'validation_loss': 12.085736274719238, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 15.796177539048278, 'expert_7': 11.11086420301771, 'expert_8': 3.448252081020131, 'expert_9': 40.74043895971141}
{'coverage': '5226 out of9216', 'system_accuracy': 58.908420138888886, 'expert_accuracy': 15.864660858914243, 'classifier_accuracy': 91.77190792629338, 'alone_classifier': 85.57942708333333, 'validation_loss': 12.085736274719238, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 15.796177539048278, 'expert_7': 11.11086420301771, 'expert_8': 3.448252081020131, 'expert_9': 40.74043895971141}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '4344 out of9216', 'system_accuracy': 55.251736111111114, 'expert_accuracy': 20.443348914476644, 'classifier_accuracy': 94.29097388832933, 'alone_classifier': 86.99001736111111, 'validation_loss': 12.58303885989719, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 38.23528474625374, 'expert_5': 18.803416330911727, 'expert_6': 17.295586606549303, 'expert_7': 24.99995689662604, 'expert_8': 14.501824256460694, 'expert_9': 19.56519612478682}
{'coverage': '4344 out of9216', 'system_accuracy': 55.251736111111114, 'expert_accuracy': 20.443348914476644, 'classifier_accuracy': 94.29097388832933, 'alone_classifier': 86.99001736111111, 'validation_loss': 12.58303885989719, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 38.23528474625374, 'expert_5': 18.803416330911727, 'expert_6': 17.295586606549303, 'expert_7': 24.99995689662604, 'expert_8': 14.501824256460694, 'expert_9': 19.56519612478682}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '4376 out of9216', 'system_accuracy': 56.34765625, 'expert_accuracy': 22.37603213322181, 'classifier_accuracy': 93.92138725042533, 'alone_classifier': 87.59765625, 'validation_loss': 12.939513736300999, 'n_experts': 10, 'expert_0': 99.98000399920016, 'expert_1': 0.0, 'expert_2': 39.99840006399744, 'expert_3': 28.200690089917643, 'expert_4': 12.990005689468765, 'expert_5': 0.0, 'expert_6': 14.529902111194776, 'expert_7': 14.146327662119354, 'expert_8': 15.49291410446731, 'expert_9': 16.541328509280437}
{'coverage': '4376 out of9216', 'system_accuracy': 56.34765625, 'expert_accuracy': 22.37603213322181, 'classifier_accuracy': 93.92138725042533, 'alone_classifier': 87.59765625, 'validation_loss': 12.939513736300999, 'n_experts': 10, 'expert_0': 99.98000399920016, 'expert_1': 0.0, 'expert_2': 39.99840006399744, 'expert_3': 28.200690089917643, 'expert_4': 12.990005689468765, 'expert_5': 0.0, 'expert_6': 14.529902111194776, 'expert_7': 14.146327662119354, 'expert_8': 15.49291410446731, 'expert_9': 16.541328509280437}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '4154 out of9216', 'system_accuracy': 54.14496527777778, 'expert_accuracy': 20.34768785666978, 'classifier_accuracy': 95.32980030501203, 'alone_classifier': 87.65190972222223, 'validation_loss': 13.198213683234322, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 20.72497921066566, 'expert_3': 17.342338436410262, 'expert_4': 41.30416824274677, 'expert_5': 0.0, 'expert_6': 21.069169138887332, 'expert_7': 99.98000399920016, 'expert_8': 0.0, 'expert_9': 0.0}
{'coverage': '4154 out of9216', 'system_accuracy': 54.14496527777778, 'expert_accuracy': 20.34768785666978, 'classifier_accuracy': 95.32980030501203, 'alone_classifier': 87.65190972222223, 'validation_loss': 13.198213683234322, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 20.72497921066566, 'expert_3': 17.342338436410262, 'expert_4': 41.30416824274677, 'expert_5': 0.0, 'expert_6': 21.069169138887332, 'expert_7': 99.98000399920016, 'expert_8': 0.0, 'expert_9': 0.0}
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '3390 out of9216', 'system_accuracy': 54.231770833333336, 'expert_accuracy': 31.08479124322721, 'classifier_accuracy': 94.01179663682015, 'alone_classifier': 86.02430555555556, 'validation_loss': 13.638033654954699, 'n_experts': 10, 'expert_0': 99.99600015999359, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 17.013877073696477, 'expert_4': 33.332222259258025, 'expert_5': 10.63464472224881, 'expert_6': 0.0, 'expert_7': 61.01689744330725, 'expert_8': 32.90144295236011, 'expert_9': 0.0}
{'coverage': '3390 out of9216', 'system_accuracy': 54.231770833333336, 'expert_accuracy': 31.08479124322721, 'classifier_accuracy': 94.01179663682015, 'alone_classifier': 86.02430555555556, 'validation_loss': 13.638033654954699, 'n_experts': 10, 'expert_0': 99.99600015999359, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 17.013877073696477, 'expert_4': 33.332222259258025, 'expert_5': 10.63464472224881, 'expert_6': 0.0, 'expert_7': 61.01689744330725, 'expert_8': 32.90144295236011, 'expert_9': 0.0}
Traceback (most recent call last):
  File "analyse_increase_oracles.py", line 179, in <module>
    validation(model_name, expert_fns, config)
  File "analyse_increase_oracles.py", line 107, in validation
    get('test', test_dl)
  File "analyse_increase_oracles.py", line 65, in get
    true, confidence, expert_predictions = forward(model, dl, expert_fns, n_dataset, n_expert)
  File "analyse_increase_oracles.py", line 32, in forward
    expert_pred1 = fn(inp, lbl)
  File "/home/rverma/Multi-L2D/CIFAR-10/models/experts.py", line 58, in predict_prob_cifar
    outs[i] = random.randint(self.k2, self.n_classes - 1)
  File "/home/rverma/.conda/envs/defer/lib/python3.8/random.py", line 248, in randint
    return self.randrange(a, b+1)
  File "/home/rverma/.conda/envs/defer/lib/python3.8/random.py", line 226, in randrange
    raise ValueError("empty range for randrange() (%d, %d, %d)" % (istart, istop, width))
ValueError: empty range for randrange() (10, 10, 0)
srun: error: r35n3: task 0: Exited with exit code 1
