Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "cuDNN"
   Try: "module spider cuDNN" to see how to load the module(s).



cuda:0
cuda:0
{'batch_size': 1024, 'alpha': 1.0, 'epochs': 100, 'patience': 20, 'expert_type': 'predict', 'n_classes': 10, 'k': 5, 'n_experts': 2, 'lr': 0.1, 'weight_decay': 0.0005, 'warmup_epochs': 0, 'loss_type': 'ova', 'ckp_dir': './ova_increase_experts/', 'experiment_name': 'multiple_experts'}
seed is 948
n is 1
torch.Size([9216]) torch.Size([9216, 11]) [torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 11]), expert_predictions (1, 9216)
Evaluate...
{'coverage': '4312 out of9216', 'system_accuracy': 93.37022569444444, 'expert_accuracy': 94.1068477117925, 'classifier_accuracy': 92.53246538653836, 'alone_classifier': 86.28472222222223, 'validation_loss': 1.40313454469045, 'n_experts': 1, 'expert_0': 94.1068477117925}
n is 2
/home/rverma/.conda/envs/defer/lib/python3.8/site-packages/torch/nn/functional.py:1944: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
torch.Size([9216]) torch.Size([9216, 12]) [torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 12]), expert_predictions (2, 9216)
Evaluate...
{'coverage': '4558 out of9216', 'system_accuracy': 93.07725694444444, 'expert_accuracy': 94.82610155319443, 'classifier_accuracy': 91.29003748815187, 'alone_classifier': 86.87065972222223, 'validation_loss': 1.8614388174480863, 'n_experts': 2, 'expert_0': 95.94329462919896, 'expert_1': 93.95098821202234}
n is 4
torch.Size([9216]) torch.Size([9216, 14]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 14]), expert_predictions (4, 9216)
Evaluate...
{'coverage': '3884 out of9216', 'system_accuracy': 93.40277777777777, 'expert_accuracy': 95.03000393735918, 'classifier_accuracy': 91.16889569596046, 'alone_classifier': 86.08940972222223, 'validation_loss': 2.691583024130927, 'n_experts': 4, 'expert_0': 93.73864848106638, 'expert_1': 98.65868892438483, 'expert_2': 95.18955603835663, 'expert_3': 99.99500024998748}
n is 6
torch.Size([9216]) torch.Size([9216, 16]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 16]), expert_predictions (6, 9216)
Evaluate...
{'coverage': '4043 out of9216', 'system_accuracy': 93.50043402777777, 'expert_accuracy': 94.49062074267849, 'classifier_accuracy': 92.23348770137304, 'alone_classifier': 86.00260416666667, 'validation_loss': 3.519527488284641, 'n_experts': 6, 'expert_0': 88.64621078933556, 'expert_1': 98.01322339663943, 'expert_2': 63.91739398475467, 'expert_3': 94.28024894561507, 'expert_4': 95.54948309727828, 'expert_5': 94.584020705302}
n is 8
torch.Size([9216]) torch.Size([9216, 18]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 18]), expert_predictions (8, 9216)
Evaluate...
{'coverage': '3801 out of9216', 'system_accuracy': 95.01953125, 'expert_accuracy': 96.76823280634412, 'classifier_accuracy': 92.52827959673034, 'alone_classifier': 89.13845486111111, 'validation_loss': 4.203989717695448, 'n_experts': 8, 'expert_0': 49.99500049995, 'expert_1': 99.1476991057673, 'expert_2': 72.72683195859419, 'expert_3': 88.88849382891631, 'expert_4': 55.554321015088554, 'expert_5': 95.01131632396456, 'expert_6': 88.88691362414168, 'expert_7': 97.18573587854539}
n is 10
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '3619 out of9216', 'system_accuracy': 93.79340277777777, 'expert_accuracy': 95.05091673929188, 'classifier_accuracy': 91.8485744170054, 'alone_classifier': 86.08940972222223, 'validation_loss': 5.027389261457655, 'n_experts': 10, 'expert_0': 94.89776551476425, 'expert_1': 99.01353908420738, 'expert_2': 99.6932311465785, 'expert_3': 98.72609368872746, 'expert_4': 99.47638770869753, 'expert_5': 0.0, 'expert_6': 87.87030879035117, 'expert_7': 95.0427025495034, 'expert_8': 99.99666677777407, 'expert_9': 83.33055564814505}
n is 14
torch.Size([9216]) torch.Size([9216, 24]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 24]), expert_predictions (14, 9216)
Evaluate...
{'coverage': '4003 out of9216', 'system_accuracy': 92.19835069444444, 'expert_accuracy': 92.53788250382188, 'classifier_accuracy': 91.75618057066748, 'alone_classifier': 81.35850694444444, 'validation_loss': 6.873492028978136, 'n_experts': 14, 'expert_0': 89.09485515924642, 'expert_1': 0.0, 'expert_2': 96.11826391191723, 'expert_3': 86.48636961301403, 'expert_4': 89.50336580059464, 'expert_5': 96.59068956661461, 'expert_6': 0.0, 'expert_7': 77.24541647255512, 'expert_8': 95.0989123112489, 'expert_9': 99.99978260916824, 'expert_10': 0.0, 'expert_11': 66.66444451851605, 'expert_12': 99.25911220872266, 'expert_13': 77.77604942112399}
n is 18
torch.Size([9216]) torch.Size([9216, 28]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 28]), expert_predictions (18, 9216)
Evaluate...
{'coverage': '3548 out of9216', 'system_accuracy': 93.43532986111111, 'expert_accuracy': 93.91319358104468, 'classifier_accuracy': 92.67192523472589, 'alone_classifier': 83.42013888888889, 'validation_loss': 8.549242867363823, 'n_experts': 18, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 99.99985611531494, 'expert_4': 99.9980000399992, 'expert_5': 0.0, 'expert_6': 88.88855967200122, 'expert_7': 0.0, 'expert_8': 83.33240741769536, 'expert_9': 80.44688243190926, 'expert_10': 99.99974683608396, 'expert_11': 95.31240071624926, 'expert_12': 96.77356920277934, 'expert_13': 93.75637794137607, 'expert_14': 97.71823457971537, 'expert_15': 95.60083785389746, 'expert_16': 93.57695530709243, 'expert_17': 76.56226074293517}
seed is 625
n is 1
torch.Size([9216]) torch.Size([9216, 11]) [torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 11]), expert_predictions (1, 9216)
Evaluate...
{'coverage': '4720 out of9216', 'system_accuracy': 93.27256944444444, 'expert_accuracy': 95.99643701083464, 'classifier_accuracy': 90.6779641805516, 'alone_classifier': 87.17447916666667, 'validation_loss': 1.4338926209343805, 'n_experts': 1, 'expert_0': 95.99643701083464}
n is 2
torch.Size([9216]) torch.Size([9216, 12]) [torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 12]), expert_predictions (2, 9216)
Evaluate...
{'coverage': '4466 out of9216', 'system_accuracy': 93.359375, 'expert_accuracy': 94.8842065311913, 'classifier_accuracy': 91.73757071792274, 'alone_classifier': 86.97916666666667, 'validation_loss': 1.8779918087853327, 'n_experts': 2, 'expert_0': 97.20929410492228, 'expert_1': 92.57860858879593}
n is 4
torch.Size([9216]) torch.Size([9216, 14]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 14]), expert_predictions (4, 9216)
Evaluate...
{'coverage': '3863 out of9216', 'system_accuracy': 93.72829861111111, 'expert_accuracy': 94.84400915957372, 'classifier_accuracy': 92.18223939471292, 'alone_classifier': 86.1328125, 'validation_loss': 2.5661643346150718, 'n_experts': 4, 'expert_0': 96.48646040906476, 'expert_1': 84.99957500212498, 'expert_2': 96.80364033872925, 'expert_3': 93.58552015884736}
n is 6
torch.Size([9216]) torch.Size([9216, 16]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 16]), expert_predictions (6, 9216)
Evaluate...
{'coverage': '3857 out of9216', 'system_accuracy': 92.99045138888889, 'expert_accuracy': 94.5138983200635, 'classifier_accuracy': 90.87373370822573, 'alone_classifier': 84.59201388888889, 'validation_loss': 3.5085429350535073, 'n_experts': 6, 'expert_0': 92.81597442827703, 'expert_1': 99.04760911803417, 'expert_2': 97.33004983978162, 'expert_3': 81.13199893207647, 'expert_4': 73.55359743207036, 'expert_5': 68.74914063574205}
n is 8
torch.Size([9216]) torch.Size([9216, 18]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 18]), expert_predictions (8, 9216)
Evaluate...
{'coverage': '3830 out of9216', 'system_accuracy': 93.77170138888889, 'expert_accuracy': 95.43259950120313, 'classifier_accuracy': 91.43602894422901, 'alone_classifier': 86.06770833333333, 'validation_loss': 4.145362218221028, 'n_experts': 8, 'expert_0': 95.11902497166072, 'expert_1': 91.34293199934918, 'expert_2': 95.10824456964802, 'expert_3': 99.17215259200246, 'expert_4': 96.120668939511, 'expert_5': 97.17584154663889, 'expert_6': 99.9900009999, 'expert_7': 96.47036124620882}
n is 10
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '3778 out of9216', 'system_accuracy': 92.27430555555556, 'expert_accuracy': 94.18903662416194, 'classifier_accuracy': 89.51826126208942, 'alone_classifier': 83.12717013888889, 'validation_loss': 5.254677560594347, 'n_experts': 10, 'expert_0': 82.75833531608512, 'expert_1': 99.98000399920016, 'expert_2': 98.10242956264534, 'expert_3': 89.70093707578931, 'expert_4': 93.10909054813938, 'expert_5': 83.09835746941557, 'expert_6': 83.95056546261391, 'expert_7': 96.91437662630364, 'expert_8': 91.89683539711405, 'expert_9': 97.8492519370926}
n is 14
torch.Size([9216]) torch.Size([9216, 24]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 24]), expert_predictions (14, 9216)
Evaluate...
{'coverage': '3942 out of9216', 'system_accuracy': 92.29600694444444, 'expert_accuracy': 93.02237038216266, 'classifier_accuracy': 91.32419859654493, 'alone_classifier': 81.68402777777777, 'validation_loss': 6.950132369995117, 'n_experts': 14, 'expert_0': 92.55117595859369, 'expert_1': 96.45889618728154, 'expert_2': 94.01186345884615, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 84.68453209994216, 'expert_6': 90.69725257091828, 'expert_7': 90.47606737950017, 'expert_8': 90.51092247856279, 'expert_9': 96.82319550430981, 'expert_10': 55.554321015088554, 'expert_11': 99.98000399920016, 'expert_12': 0.0, 'expert_13': 82.75859690844916}
n is 18
torch.Size([9216]) torch.Size([9216, 28]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 28]), expert_predictions (18, 9216)
Evaluate...
{'coverage': '3749 out of9216', 'system_accuracy': 93.02300347222223, 'expert_accuracy': 94.38448529780554, 'classifier_accuracy': 91.03760760102406, 'alone_classifier': 83.52864583333333, 'validation_loss': 8.429329130384657, 'n_experts': 18, 'expert_0': 98.32471692661936, 'expert_1': 71.8745507840576, 'expert_2': 99.98000399920016, 'expert_3': 91.56291956252842, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 91.89418227061736, 'expert_7': 0.0, 'expert_8': 0.0, 'expert_9': 0.0, 'expert_10': 0.0, 'expert_11': 69.56461248163059, 'expert_12': 72.72595043726479, 'expert_13': 87.49890626367171, 'expert_14': 0.0, 'expert_15': 98.21426622732814, 'expert_16': 97.85351064305287, 'expert_17': 88.94727479234233}
seed is 436
n is 1
torch.Size([9216]) torch.Size([9216, 11]) [torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 11]), expert_predictions (1, 9216)
Evaluate...
{'coverage': '4680 out of9216', 'system_accuracy': 94.21657986111111, 'expert_accuracy': 95.67900812702786, 'classifier_accuracy': 92.79914331625761, 'alone_classifier': 87.82552083333333, 'validation_loss': 1.5115362008412678, 'n_experts': 1, 'expert_0': 95.67900812702786}
n is 2
torch.Size([9216]) torch.Size([9216, 12]) [torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 12]), expert_predictions (2, 9216)
Evaluate...
{'coverage': '3909 out of9216', 'system_accuracy': 93.71744791666667, 'expert_accuracy': 95.30808007129903, 'classifier_accuracy': 91.55794086574723, 'alone_classifier': 86.62109375, 'validation_loss': 1.828763074345059, 'n_experts': 2, 'expert_0': 99.369022480112, 'expert_1': 95.0500963907777}
n is 4
torch.Size([9216]) torch.Size([9216, 14]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 14]), expert_predictions (4, 9216)
Evaluate...
{'coverage': '4210 out of9216', 'system_accuracy': 93.21831597222223, 'expert_accuracy': 94.48661228579255, 'classifier_accuracy': 91.71021159833226, 'alone_classifier': 86.01345486111111, 'validation_loss': 2.766061305999756, 'n_experts': 4, 'expert_0': 93.8538102044507, 'expert_1': 98.68764677381509, 'expert_2': 96.15793038251219, 'expert_3': 89.82141253189063}
n is 6
torch.Size([9216]) torch.Size([9216, 16]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 16]), expert_predictions (6, 9216)
Evaluate...
{'coverage': '3775 out of9216', 'system_accuracy': 93.53298611111111, 'expert_accuracy': 95.25822108957098, 'classifier_accuracy': 91.04635520407005, 'alone_classifier': 85.68793402777777, 'validation_loss': 3.4506634606255426, 'n_experts': 6, 'expert_0': 86.50786785089853, 'expert_1': 73.999704001184, 'expert_2': 44.44345681207084, 'expert_3': 94.29163525774413, 'expert_4': 69.99953333644443, 'expert_5': 97.25810921789416}
n is 8
torch.Size([9216]) torch.Size([9216, 18]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 18]), expert_predictions (8, 9216)
Evaluate...
{'coverage': '3690 out of9216', 'system_accuracy': 93.76085069444444, 'expert_accuracy': 94.8968478140844, 'classifier_accuracy': 92.05961810136536, 'alone_classifier': 86.12196180555556, 'validation_loss': 4.202620956632826, 'n_experts': 8, 'expert_0': 0.0, 'expert_1': 92.30102209324878, 'expert_2': 99.9900009999, 'expert_3': 91.88189621601569, 'expert_4': 90.98037431757366, 'expert_5': 98.10598628334373, 'expert_6': 99.52302081938926, 'expert_7': 98.35565184462219}
n is 10
torch.Size([9216]) torch.Size([9216, 20]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 20]), expert_predictions (10, 9216)
Evaluate...
{'coverage': '3669 out of9216', 'system_accuracy': 93.06640625, 'expert_accuracy': 94.2671680451715, 'classifier_accuracy': 91.25101958977869, 'alone_classifier': 84.07118055555556, 'validation_loss': 5.149529510074192, 'n_experts': 10, 'expert_0': 0.0, 'expert_1': 90.09286531070197, 'expert_2': 99.98000399920016, 'expert_3': 94.05456256246345, 'expert_4': 99.99981308446152, 'expert_5': 0.0, 'expert_6': 99.99333377774815, 'expert_7': 73.62621181052349, 'expert_8': 96.59503493586546, 'expert_9': 0.0}
n is 14
torch.Size([9216]) torch.Size([9216, 24]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 24]), expert_predictions (14, 9216)
Evaluate...
{'coverage': '3635 out of9216', 'system_accuracy': 94.94357638888889, 'expert_accuracy': 95.78928164166702, 'classifier_accuracy': 93.64511434263784, 'alone_classifier': 88.48741319444444, 'validation_loss': 6.764705287085639, 'n_experts': 14, 'expert_0': 0.0, 'expert_1': 97.33307377846991, 'expert_2': 99.99978022026325, 'expert_3': 86.62789018839338, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 99.9980000399992, 'expert_7': 96.1324904613365, 'expert_8': 98.02792144159056, 'expert_9': 99.99948718211702, 'expert_10': 98.46057900731786, 'expert_11': 0.0, 'expert_12': 98.55043898423482, 'expert_13': 96.94286453051255}
n is 18
torch.Size([9216]) torch.Size([9216, 28]) [torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216]), torch.Size([9216])]
shapes: true labels torch.Size([9216]), confidences torch.Size([9216, 28]), expert_predictions (18, 9216)
Evaluate...
{'coverage': '3696 out of9216', 'system_accuracy': 93.70659722222223, 'expert_accuracy': 95.2898516199329, 'classifier_accuracy': 91.34198887061719, 'alone_classifier': 85.13454861111111, 'validation_loss': 8.28425539864434, 'n_experts': 18, 'expert_0': 89.11283136061986, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 99.99991596645717, 'expert_4': 0.0, 'expert_5': 0.0, 'expert_6': 92.4957039025983, 'expert_7': 99.56131617428406, 'expert_8': 0.0, 'expert_9': 80.3568558683719, 'expert_10': 97.76781349651183, 'expert_11': 0.0, 'expert_12': 0.0, 'expert_13': 98.92586489240283, 'expert_14': 99.9900009999, 'expert_15': 98.47157271983724, 'expert_16': 0.0, 'expert_17': 96.71844672937938}
===Mean and Standard Error===
[93.61979167 93.38469329 93.44979745 93.34129051 94.18402778 93.04470486
 93.14597801 93.38831019]
[0.29972282 0.18524028 0.14908466 0.17567107 0.41776348 0.43865982
 0.89924119 0.19873201]
