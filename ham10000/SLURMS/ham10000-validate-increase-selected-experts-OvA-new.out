Lmod has detected the following error: These module(s) or extension(s) exist
but cannot be loaded as requested: "cuDNN"
   Try: "module spider cuDNN" to see how to load the module(s).



cuda:0
run for seed 948
n is 1
selected experts ['predict_prob']
shapes: true labels torch.Size([1280]), confidences torch.Size([1280, 8]), expert_predictions (1, 1280)
Evaluate...
{'coverage': '944 out of1280', 'system_accuracy': 84.140625, 'expert_accuracy': 68.74995907740531, 'classifier_accuracy': 89.61863457429719, 'alone_classifier': 79.140625, 'validation_loss': 2.324201202392578, 'n_experts': 1, 'expert_0': 68.74995907740531}
n is 2
selected experts ['predict', 'predict']
/home/rverma/.conda/envs/defer/lib/python3.8/site-packages/torch/nn/functional.py:1944: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
shapes: true labels torch.Size([1280]), confidences torch.Size([1280, 9]), expert_predictions (2, 1280)
Evaluate...
{'coverage': '80 out of1280', 'system_accuracy': 93.125, 'expert_accuracy': 94.66665088889152, 'classifier_accuracy': 69.99991250010937, 'alone_classifier': 78.671875, 'validation_loss': 1.8953280210494996, 'n_experts': 2, 'expert_0': 95.46566287606302, 'expert_1': 92.96870157880126}
n is 4
selected experts ['predict_prob', 'predict_random', 'MLPMixer', 'predict_prob']
shapes: true labels torch.Size([1280]), confidences torch.Size([1280, 11]), expert_predictions (4, 1280)
Evaluate...
{'coverage': '708 out of1280', 'system_accuracy': 72.65625, 'expert_accuracy': 47.37760581202594, 'classifier_accuracy': 93.07908289843462, 'alone_classifier': 77.734375, 'validation_loss': 4.348558330535889, 'n_experts': 4, 'expert_0': 66.66660968665839, 'expert_1': 8.60214128802012, 'expert_2': 0.0, 'expert_3': 65.1314932480352}
n is 6
selected experts ['predict', 'predict', 'predict_prob', 'predict', 'MLPMixer', 'predict']
shapes: true labels torch.Size([1280]), confidences torch.Size([1280, 13]), expert_predictions (6, 1280)
Evaluate...
{'coverage': '68 out of1280', 'system_accuracy': 86.875, 'expert_accuracy': 87.70625615408315, 'classifier_accuracy': 72.05871756070947, 'alone_classifier': 77.109375, 'validation_loss': 3.7740007877349853, 'n_experts': 6, 'expert_0': 96.7741311134638, 'expert_1': 74.99625018749062, 'expert_2': 73.7326509376489, 'expert_3': 24.99937501562461, 'expert_4': 83.89825768460018, 'expert_5': 94.35730761297329}
n is 8
selected experts ['MLPMixer', 'predict_random', 'predict_prob', 'predict_random', 'predict', 'MLPMixer', 'predict_random', 'predict']
shapes: true labels torch.Size([1280]), confidences torch.Size([1280, 15]), expert_predictions (8, 1280)
Evaluate...
{'coverage': '85 out of1280', 'system_accuracy': 41.875, 'expert_accuracy': 39.24685535617484, 'classifier_accuracy': 78.82343667830979, 'alone_classifier': 76.484375, 'validation_loss': 5.8820414543151855, 'n_experts': 8, 'expert_0': 70.22898082863328, 'expert_1': 0.0, 'expert_2': 66.66222251849877, 'expert_3': 13.593745751954454, 'expert_4': 0.0, 'expert_5': 33.333015876039276, 'expert_6': 0.0, 'expert_7': 71.42653067055227}
n is 12
selected experts ['predict_random', 'MLPMixer', 'predict_random', 'MLPMixer', 'predict_prob', 'predict_random', 'MLPMixer', 'predict_random', 'predict_random', 'predict_random', 'MLPMixer', 'predict']
shapes: true labels torch.Size([1280]), confidences torch.Size([1280, 19]), expert_predictions (12, 1280)
Evaluate...
{'coverage': '155 out of1280', 'system_accuracy': 25.546875, 'expert_accuracy': 15.999997155556063, 'classifier_accuracy': 94.83864849119452, 'alone_classifier': 74.609375, 'validation_loss': 8.795242309570312, 'n_experts': 12, 'expert_0': 12.699997460000509, 'expert_1': 94.11653980541405, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 26.922869824078276, 'expert_6': 0.0, 'expert_7': 17.64698961964855, 'expert_8': 18.181487609316196, 'expert_9': 0.0, 'expert_10': 94.99905000949991, 'expert_11': 0.0}
n is 16
selected experts ['predict_random', 'MLPMixer', 'MLPMixer', 'predict', 'predict_prob', 'predict', 'predict', 'predict', 'predict_prob', 'predict_prob', 'MLPMixer', 'MLPMixer', 'MLPMixer', 'predict_prob', 'predict_random', 'MLPMixer']
shapes: true labels torch.Size([1280]), confidences torch.Size([1280, 23]), expert_predictions (16, 1280)
Evaluate...
{'coverage': '35 out of1280', 'system_accuracy': 76.25, 'expert_accuracy': 75.58231717553139, 'classifier_accuracy': 99.9997142865306, 'alone_classifier': 70.9375, 'validation_loss': 10.747808837890625, 'n_experts': 16, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 49.9990000199996, 'expert_3': 99.98000399920016, 'expert_4': 0.0, 'expert_5': 99.98000399920016, 'expert_6': 33.332222259258025, 'expert_7': 0.0, 'expert_8': 76.08690138630334, 'expert_9': 74.3420563539103, 'expert_10': 80.66293886025477, 'expert_11': 42.85683673688045, 'expert_12': 75.29405859289523, 'expert_13': 0.0, 'expert_14': 0.0, 'expert_15': 0.0}
run for seed 625
n is 1
selected experts ['predict_prob']
shapes: true labels torch.Size([1280]), confidences torch.Size([1280, 8]), expert_predictions (1, 1280)
Evaluate...
{'coverage': '917 out of1280', 'system_accuracy': 83.90625, 'expert_accuracy': 69.14596741269013, 'classifier_accuracy': 89.74917232833454, 'alone_classifier': 77.109375, 'validation_loss': 2.3840541362762453, 'n_experts': 1, 'expert_0': 69.14596741269013}
n is 2
selected experts ['predict_prob', 'predict_prob']
shapes: true labels torch.Size([1280]), confidences torch.Size([1280, 9]), expert_predictions (2, 1280)
Evaluate...
{'coverage': '924 out of1280', 'system_accuracy': 84.0625, 'expert_accuracy': 70.78647708624882, 'classifier_accuracy': 89.17747952624681, 'alone_classifier': 78.28125, 'validation_loss': 3.196793556213379, 'n_experts': 2, 'expert_0': 75.42848522458831, 'expert_1': 66.29826928368034}
n is 4
selected experts ['predict_random', 'predict', 'predict_prob', 'MLPMixer']
shapes: true labels torch.Size([1280]), confidences torch.Size([1280, 11]), expert_predictions (4, 1280)
Evaluate...
{'coverage': '240 out of1280', 'system_accuracy': 76.640625, 'expert_accuracy': 73.07690902367135, 'classifier_accuracy': 92.08329496529376, 'alone_classifier': 78.75, 'validation_loss': 3.792535972595215, 'n_experts': 4, 'expert_0': 7.1428061228134085, 'expert_1': 24.999750002499976, 'expert_2': 75.90724276063655, 'expert_3': 0.0}
n is 6
selected experts ['MLPMixer', 'predict_prob', 'predict_random', 'predict_prob', 'predict', 'predict_random']
shapes: true labels torch.Size([1280]), confidences torch.Size([1280, 13]), expert_predictions (6, 1280)
Evaluate...
{'coverage': '232 out of1280', 'system_accuracy': 76.875, 'expert_accuracy': 73.47326842113199, 'classifier_accuracy': 92.24133955114674, 'alone_classifier': 77.03125, 'validation_loss': 5.155920314788818, 'n_experts': 6, 'expert_0': 0.0, 'expert_1': 75.92406075443341, 'expert_2': 18.51838134532337, 'expert_3': 0.0, 'expert_4': 35.71377551749261, 'expert_5': 0.0}
n is 8
selected experts ['predict_prob', 'predict_random', 'predict_random', 'predict', 'predict_prob', 'predict', 'predict_prob', 'predict']
shapes: true labels torch.Size([1280]), confidences torch.Size([1280, 15]), expert_predictions (8, 1280)
Evaluate...
{'coverage': '63 out of1280', 'system_accuracy': 52.65625, 'expert_accuracy': 51.27361523851845, 'classifier_accuracy': 79.36495338896287, 'alone_classifier': 78.28125, 'validation_loss': 5.894997501373291, 'n_experts': 8, 'expert_0': 76.74413505373086, 'expert_1': 28.570612268220906, 'expert_2': 13.513507426348006, 'expert_3': 33.332222259258025, 'expert_4': 71.71049486381804, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 66.66222251849877}
n is 12
selected experts ['predict_random', 'predict', 'predict_prob', 'predict_prob', 'predict', 'MLPMixer', 'predict_random', 'predict_prob', 'predict', 'predict_random', 'predict_random', 'predict_prob']
shapes: true labels torch.Size([1280]), confidences torch.Size([1280, 19]), expert_predictions (12, 1280)
Evaluate...
{'coverage': '78 out of1280', 'system_accuracy': 60.234375, 'expert_accuracy': 59.400988452414566, 'classifier_accuracy': 73.07682938868027, 'alone_classifier': 76.640625, 'validation_loss': 8.486655044555665, 'n_experts': 12, 'expert_0': 0.0, 'expert_1': 0.0, 'expert_2': 0.0, 'expert_3': 75.83330173612427, 'expert_4': 39.99946667377768, 'expert_5': 0.0, 'expert_6': 28.570612268220906, 'expert_7': 73.5897058514329, 'expert_8': 33.33111125924938, 'expert_9': 33.332222259258025, 'expert_10': 17.567555697597502, 'expert_11': 0.0}
n is 16
selected experts ['predict_random', 'predict_random', 'predict_prob', 'predict_random', 'predict_random', 'predict', 'predict_prob', 'MLPMixer', 'predict', 'predict', 'MLPMixer', 'MLPMixer', 'MLPMixer', 'MLPMixer', 'predict', 'predict_prob']
shapes: true labels torch.Size([1280]), confidences torch.Size([1280, 23]), expert_predictions (16, 1280)
Evaluate...
{'coverage': '25 out of1280', 'system_accuracy': 63.4375, 'expert_accuracy': 63.2669221885383, 'classifier_accuracy': 71.99971200115199, 'alone_classifier': 75.390625, 'validation_loss': 10.70998706817627, 'n_experts': 16, 'expert_0': 0.0, 'expert_1': 13.445366852632896, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 0.0, 'expert_5': 99.9900009999, 'expert_6': 75.3332831111446, 'expert_7': 87.663995976905, 'expert_8': 99.98000399920016, 'expert_9': 35.71403061406704, 'expert_10': 67.27267834714301, 'expert_11': 0.0, 'expert_12': 0.0, 'expert_13': 36.36297521863239, 'expert_14': 0.0, 'expert_15': 0.0}
run for seed 436
n is 1
selected experts ['predict_prob']
shapes: true labels torch.Size([1280]), confidences torch.Size([1280, 8]), expert_predictions (1, 1280)
Evaluate...
{'coverage': '969 out of1280', 'system_accuracy': 82.34375, 'expert_accuracy': 66.23789952546655, 'classifier_accuracy': 87.51289086554274, 'alone_classifier': 78.046875, 'validation_loss': 2.4079882144927978, 'n_experts': 1, 'expert_0': 66.23789952546655}
n is 2
selected experts ['predict_prob', 'predict_prob']
shapes: true labels torch.Size([1280]), confidences torch.Size([1280, 9]), expert_predictions (2, 1280)
Evaluate...
{'coverage': '929 out of1280', 'system_accuracy': 84.609375, 'expert_accuracy': 72.36463113126432, 'classifier_accuracy': 89.23572774642328, 'alone_classifier': 78.203125, 'validation_loss': 3.1398598194122314, 'n_experts': 2, 'expert_0': 73.02621970234249, 'expert_1': 71.85922426208617}
n is 4
selected experts ['predict', 'predict_random', 'MLPMixer', 'predict_random']
shapes: true labels torch.Size([1280]), confidences torch.Size([1280, 11]), expert_predictions (4, 1280)
Evaluate...
{'coverage': '175 out of1280', 'system_accuracy': 25.3125, 'expert_accuracy': 15.565608042423884, 'classifier_accuracy': 86.85709322451815, 'alone_classifier': 78.125, 'validation_loss': 3.6867227077484133, 'n_experts': 4, 'expert_0': 0.0, 'expert_1': 7.692189350933063, 'expert_2': 0.0, 'expert_3': 15.659337791330076}
n is 6
selected experts ['predict_prob', 'predict_prob', 'predict_random', 'predict', 'predict', 'MLPMixer']
shapes: true labels torch.Size([1280]), confidences torch.Size([1280, 13]), expert_predictions (6, 1280)
Evaluate...
{'coverage': '88 out of1280', 'system_accuracy': 45.9375, 'expert_accuracy': 43.45636854758917, 'classifier_accuracy': 79.54536415299528, 'alone_classifier': 77.265625, 'validation_loss': 4.933873462677002, 'n_experts': 6, 'expert_0': 66.66518521810627, 'expert_1': 77.34803780919418, 'expert_2': 13.942303223620764, 'expert_3': 0.0, 'expert_4': 33.33277778703688, 'expert_5': 24.99875006249687}
n is 8
selected experts ['predict_random', 'predict_prob', 'predict_random', 'predict_prob', 'predict_random', 'predict_random', 'MLPMixer', 'MLPMixer']
shapes: true labels torch.Size([1280]), confidences torch.Size([1280, 15]), expert_predictions (8, 1280)
Evaluate...
{'coverage': '508 out of1280', 'system_accuracy': 62.03125, 'expert_accuracy': 40.414497301943705, 'classifier_accuracy': 94.88187108624585, 'alone_classifier': 75.234375, 'validation_loss': 6.887611675262451, 'n_experts': 8, 'expert_0': 18.12497734377832, 'expert_1': 72.47182868333856, 'expert_2': 0.0, 'expert_3': 0.0, 'expert_4': 15.540519539838458, 'expert_5': 0.0, 'expert_6': 45.80416377331205, 'expert_7': 0.0}
n is 12
selected experts ['predict_prob', 'predict_random', 'MLPMixer', 'predict_random', 'predict', 'predict_random', 'MLPMixer', 'predict', 'predict_prob', 'predict_random', 'predict', 'MLPMixer']
shapes: true labels torch.Size([1280]), confidences torch.Size([1280, 19]), expert_predictions (12, 1280)
Evaluate...
{'coverage': '63 out of1280', 'system_accuracy': 66.015625, 'expert_accuracy': 65.6532348967568, 'classifier_accuracy': 73.01575711784584, 'alone_classifier': 76.015625, 'validation_loss': 8.23400068283081, 'n_experts': 12, 'expert_0': 0.0, 'expert_1': 12.53011444331834, 'expert_2': 0.0, 'expert_3': 28.570612268220906, 'expert_4': 95.46480931301164, 'expert_5': 0.0, 'expert_6': 0.0, 'expert_7': 95.48187019164446, 'expert_8': 0.0, 'expert_9': 0.0, 'expert_10': 0.0, 'expert_11': 33.333015876039276}
n is 16
selected experts ['MLPMixer', 'predict_prob', 'predict_random', 'predict_random', 'predict_random', 'MLPMixer', 'predict_prob', 'predict', 'MLPMixer', 'MLPMixer', 'predict', 'predict_prob', 'predict', 'predict_prob', 'predict_random', 'predict']
shapes: true labels torch.Size([1280]), confidences torch.Size([1280, 23]), expert_predictions (16, 1280)
Evaluate...
{'coverage': '53 out of1280', 'system_accuracy': 62.1875, 'expert_accuracy': 61.85818062621343, 'classifier_accuracy': 69.81118903549238, 'alone_classifier': 74.0625, 'validation_loss': 10.548949050903321, 'n_experts': 16, 'expert_0': 70.09339243608183, 'expert_1': 0.0, 'expert_2': 24.99937501562461, 'expert_3': 16.981119259532633, 'expert_4': 22.22172840603542, 'expert_5': 84.07306314722551, 'expert_6': 0.0, 'expert_7': 0.0, 'expert_8': 71.95117563952705, 'expert_9': 39.99840006399744, 'expert_10': 0.0, 'expert_11': 0.0, 'expert_12': 0.0, 'expert_13': 0.0, 'expert_14': 0.0, 'expert_15': 0.0}
===Mean and Standard Error===
Mean [83.46354167 87.265625   58.203125   69.89583333 52.1875     50.59895833
 67.29166667]
Standard Error [ 0.56396895  2.93393789 16.48548574 12.32208454  5.82332661 12.63673049
  4.49367804]
